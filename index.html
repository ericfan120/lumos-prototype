<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lumos - Media Planning Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .scrollbar-thin::-webkit-scrollbar { width: 6px; }
    .scrollbar-thin::-webkit-scrollbar-track { background: #f1f5f9; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    .chat-bubble { animation: fadeIn 0.3s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .typing-indicator span { animation: bounce 1.4s infinite ease-in-out both; }
    .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
    .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    .screen { display: none; }
    .screen.active { display: flex; flex-direction: column; }
    .plan-tab.active { color: #591C63; border-bottom-color: #591C63; }
    .lumos-gradient { background: linear-gradient(135deg, #591C63 0%, #7B2D8E 50%, #9333A3 100%); }
    .step-item.completed .step-circle { background: #22C55E; border-color: #22C55E; }
    .step-item.active .step-circle { background: #591C63; border-color: #591C63; }
    .step-item.pending .step-circle { background: white; border-color: #CBD5E1; }
    .step-line.completed { background: #22C55E; }
    .step-line.active { background: linear-gradient(to right, #22C55E, #591C63); }
    .step-line.pending { background: #CBD5E1; }
    .modal-overlay { opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; }
    .modal-overlay.active { opacity: 1; visibility: visible; }
    .modal-container { transform: translateY(20px) scale(0.95); transition: transform 0.3s ease; }
    .modal-overlay.active .modal-container { transform: translateY(0) scale(1); }
    .ai-button { animation: pulse-ring 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    @keyframes pulse-ring { 0%, 100% { box-shadow: 0 0 0 0 rgba(89, 28, 99, 0.4); } 50% { box-shadow: 0 0 0 12px rgba(89, 28, 99, 0); } }
    .upload-zone { border: 2px dashed #CBD5E1; transition: all 0.3s ease; }
    .upload-zone:hover { border-color: #591C63; background: rgba(89, 28, 99, 0.05); }
  </style>
</head>
<body class="bg-slate-50 text-slate-800">
  <div class="min-h-screen flex flex-col">
    <!-- Top Header Bar -->
    <header class="h-14 bg-white border-b border-slate-200 flex items-center justify-between px-6 shrink-0">
      <div class="flex items-center gap-4">
        <div class="flex items-center gap-2 cursor-pointer" onclick="showScreen('master-plans')">
          <div class="w-24 h-8 lumos-gradient rounded flex items-center justify-center">
            <span class="text-white font-bold text-sm tracking-widest">LUMOS</span>
          </div>
        </div>
        <div class="h-6 w-px bg-slate-200"></div>
        <span class="text-sm text-slate-500">Media Planning Platform</span>
      </div>
      <div class="flex items-center gap-3">
        <div class="flex items-center gap-2">
          <div class="w-8 h-8 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center text-xs font-medium text-white">EF</div>
          <span class="text-sm text-slate-700">Eric Fan</span>
        </div>
        <div class="h-6 w-px bg-slate-200"></div>
        <button class="p-2 hover:bg-slate-100 rounded-lg transition-colors">
          <svg class="w-5 h-5 text-slate-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <div class="flex-1 overflow-hidden">

      <!-- ==================== MASTER PLANS VIEW ==================== -->
      <div class="screen active h-full overflow-auto" data-screen="master-plans">
        <div class="p-8">
          <!-- Header with Create Button -->
          <div class="flex items-center justify-between mb-8">
            <div>
              <h1 class="text-2xl font-bold text-slate-800">Media Plans</h1>
              <p class="text-slate-500 mt-1">Manage and create your media planning campaigns</p>
            </div>
            <button onclick="startPlanCreation()" class="px-5 py-2.5 lumos-gradient text-white font-medium rounded-xl hover:opacity-90 transition-opacity flex items-center gap-2 shadow-lg">
              <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Create New Plan
            </button>
          </div>

          <!-- Filter/Search Bar -->
          <div class="flex items-center gap-4 mb-6">
            <div class="flex-1 relative">
              <svg class="w-5 h-5 text-slate-400 absolute left-4 top-1/2 -translate-y-1/2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
              <input type="text" placeholder="Search plans..." class="w-full pl-12 pr-4 py-2.5 bg-white border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"/>
            </div>
            <select class="px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-sm text-slate-700">
              <option>All Status</option>
              <option>Active</option>
              <option>Draft</option>
              <option>Completed</option>
            </select>
            <select class="px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-sm text-slate-700">
              <option>All Categories</option>
              <option>FMCG</option>
              <option>Retail</option>
              <option>Technology</option>
            </select>
          </div>

          <!-- Plans Grid -->
          <div class="grid grid-cols-3 gap-6">
            <!-- Active Plan Card -->
            <div onclick="openPlanDetail('hive')" class="bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-lg hover:border-purple-200 transition-all cursor-pointer overflow-hidden">
              <div class="h-2 lumos-gradient"></div>
              <div class="p-6">
                <div class="flex items-center justify-between mb-4">
                  <span class="px-2.5 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full">Active</span>
                  <span class="text-xs text-slate-400">Updated 2h ago</span>
                </div>
                <h3 class="text-lg font-semibold text-slate-800 mb-2">FMCG Brand 1</h3>
                <p class="text-sm text-slate-500 mb-4">Example Campaign - Brand Awareness</p>
                <div class="grid grid-cols-2 gap-4 mb-4">
                  <div><p class="text-xs text-slate-400">Budget</p><p class="text-sm font-semibold text-slate-800">$12,000,000</p></div>
                  <div><p class="text-xs text-slate-400">Allocated</p><p class="text-sm font-semibold text-green-600">$7,860,000</p></div>
                  <div><p class="text-xs text-slate-400">Target</p><p class="text-sm font-semibold text-slate-800">P18-54</p></div>
                  <div><p class="text-xs text-slate-400">Duration</p><p class="text-sm font-semibold text-slate-800">26 weeks</p></div>
                </div>
                <div class="flex items-center justify-between pt-4 border-t border-slate-100">
                  <div class="flex -space-x-2">
                    <div class="w-7 h-7 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center text-xs font-medium text-white border-2 border-white">EF</div>
                    <div class="w-7 h-7 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center text-xs font-medium text-white border-2 border-white">JD</div>
                  </div>
                  <span class="text-xs text-purple-600 font-medium">View Details →</span>
                </div>
              </div>
            </div>

            <!-- Draft Plan Card -->
            <div class="bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-lg hover:border-purple-200 transition-all cursor-pointer overflow-hidden opacity-75">
              <div class="h-2 bg-amber-400"></div>
              <div class="p-6">
                <div class="flex items-center justify-between mb-4">
                  <span class="px-2.5 py-1 bg-amber-100 text-amber-700 text-xs font-medium rounded-full">Draft</span>
                  <span class="text-xs text-slate-400">2 days ago</span>
                </div>
                <h3 class="text-lg font-semibold text-slate-800 mb-2">Brand Awareness Q1</h3>
                <p class="text-sm text-slate-500 mb-4">Client Alpha - Consideration</p>
                <div class="grid grid-cols-2 gap-4 mb-4">
                  <div><p class="text-xs text-slate-400">Budget</p><p class="text-sm font-semibold text-slate-800">$5,000,000</p></div>
                  <div><p class="text-xs text-slate-400">Allocated</p><p class="text-sm font-semibold text-amber-600">$0</p></div>
                  <div><p class="text-xs text-slate-400">Target</p><p class="text-sm font-semibold text-slate-800">P25-44</p></div>
                  <div><p class="text-xs text-slate-400">Duration</p><p class="text-sm font-semibold text-slate-800">12 weeks</p></div>
                </div>
                <div class="flex items-center justify-between pt-4 border-t border-slate-100">
                  <div class="flex -space-x-2">
                    <div class="w-7 h-7 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center text-xs font-medium text-white border-2 border-white">EF</div>
                  </div>
                  <span class="text-xs text-slate-500">Continue Setup →</span>
                </div>
              </div>
            </div>

            <!-- Completed Plan Card -->
            <div class="bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-lg transition-all cursor-pointer overflow-hidden opacity-60">
              <div class="h-2 bg-slate-400"></div>
              <div class="p-6">
                <div class="flex items-center justify-between mb-4">
                  <span class="px-2.5 py-1 bg-slate-100 text-slate-600 text-xs font-medium rounded-full">Completed</span>
                  <span class="text-xs text-slate-400">5 days ago</span>
                </div>
                <h3 class="text-lg font-semibold text-slate-800 mb-2">Summer Launch 2025</h3>
                <p class="text-sm text-slate-500 mb-4">Client Beta - Brand Launch</p>
                <div class="grid grid-cols-2 gap-4 mb-4">
                  <div><p class="text-xs text-slate-400">Budget</p><p class="text-sm font-semibold text-slate-800">$8,500,000</p></div>
                  <div><p class="text-xs text-slate-400">Spent</p><p class="text-sm font-semibold text-slate-600">$8,234,000</p></div>
                  <div><p class="text-xs text-slate-400">Target</p><p class="text-sm font-semibold text-slate-800">P18-34</p></div>
                  <div><p class="text-xs text-slate-400">Duration</p><p class="text-sm font-semibold text-slate-800">16 weeks</p></div>
                </div>
                <div class="flex items-center justify-between pt-4 border-t border-slate-100">
                  <div class="flex -space-x-2">
                    <div class="w-7 h-7 bg-gradient-to-br from-pink-400 to-rose-500 rounded-full flex items-center justify-center text-xs font-medium text-white border-2 border-white">SM</div>
                  </div>
                  <span class="text-xs text-slate-500">View Report →</span>
                </div>
              </div>
            </div>

            <!-- Create New Card -->
            <div onclick="startPlanCreation()" class="bg-white rounded-2xl border-2 border-dashed border-slate-200 hover:border-purple-300 hover:bg-purple-50 transition-all cursor-pointer flex flex-col items-center justify-center min-h-[280px]">
              <div class="w-16 h-16 rounded-full bg-purple-100 flex items-center justify-center mb-4">
                <svg class="w-8 h-8 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              </div>
              <p class="text-slate-600 font-medium">Create New Plan</p>
              <p class="text-sm text-slate-400 mt-1">Start a new media campaign</p>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== PLAN CREATION WORKFLOW ==================== -->
      <div class="screen h-full overflow-auto bg-slate-50" data-screen="plan-workflow">
        <!-- Workflow Header -->
        <div class="bg-white border-b border-slate-200 px-8 py-4">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-4">
              <button onclick="showScreen('master-plans')" class="p-2 hover:bg-slate-100 rounded-lg">
                <svg class="w-5 h-5 text-slate-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
              </button>
              <div>
                <h2 class="text-lg font-semibold text-slate-800">Create New Media Plan</h2>
                <p class="text-sm text-slate-500">Complete all steps to build your plan</p>
              </div>
            </div>
            <button onclick="showScreen('master-plans')" class="px-4 py-2 text-sm text-slate-600 border border-slate-200 rounded-xl hover:bg-slate-100">Save & Exit</button>
          </div>

          <!-- Step Progress -->
          <div class="flex items-center justify-between max-w-4xl mx-auto">
            <div class="step-item flex flex-col items-center" data-step="1">
              <div class="step-circle w-9 h-9 rounded-full border-2 flex items-center justify-center text-sm font-semibold text-white mb-2">1</div>
              <span class="text-xs font-medium text-slate-600">Campaign</span>
            </div>
            <div class="step-line flex-1 h-1 mx-2" data-line="1"></div>
            <div class="step-item flex flex-col items-center" data-step="2">
              <div class="step-circle w-9 h-9 rounded-full border-2 flex items-center justify-center text-sm font-semibold mb-2">2</div>
              <span class="text-xs font-medium text-slate-600">Audience</span>
            </div>
            <div class="step-line flex-1 h-1 mx-2" data-line="2"></div>
            <div class="step-item flex flex-col items-center" data-step="3">
              <div class="step-circle w-9 h-9 rounded-full border-2 flex items-center justify-center text-sm font-semibold mb-2">3</div>
              <span class="text-xs font-medium text-slate-600">Data</span>
            </div>
            <div class="step-line flex-1 h-1 mx-2" data-line="3"></div>
            <div class="step-item flex flex-col items-center" data-step="4">
              <div class="step-circle w-9 h-9 rounded-full border-2 flex items-center justify-center text-sm font-semibold mb-2">4</div>
              <span class="text-xs font-medium text-slate-600">Market</span>
            </div>
            <div class="step-line flex-1 h-1 mx-2" data-line="4"></div>
            <div class="step-item flex flex-col items-center" data-step="5">
              <div class="step-circle w-9 h-9 rounded-full border-2 flex items-center justify-center text-sm font-semibold mb-2">5</div>
              <span class="text-xs font-medium text-slate-600">Optimiser</span>
            </div>
          </div>
        </div>

        <!-- Step Content -->
        <div class="p-6 max-w-5xl mx-auto">
          
          <!-- STEP 1: Campaign Details with AI Brief Parser at Top -->
          <div class="workflow-step" data-workflow-step="1">
            <div class="space-y-4">
              <!-- AI Brief Parser - Full Width Top Section -->
              <div class="bg-gradient-to-r from-[#591C63] via-[#7B2D8E] to-[#9333A3] rounded-2xl p-5 text-white">
                <div class="flex items-start gap-6">
                  <!-- Left: Upload Zone -->
                  <div class="w-1/3">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a3 3 0 0 0-3 3v4a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="22"/></svg>
                      </div>
                      <div>
                        <h3 class="font-semibold text-lg">AI Brief Parser</h3>
                        <p class="text-purple-200 text-xs">Upload any brief document to auto-fill</p>
                      </div>
                    </div>

                    <!-- File Upload Zone -->
                    <div id="briefUploadZone" class="border-2 border-dashed border-white/30 rounded-xl p-4 text-center cursor-pointer hover:bg-white/10 transition-colors" onclick="document.getElementById('briefFileInput').click()">
                      <input type="file" id="briefFileInput" accept=".pdf,.docx,.doc,.txt,.rtf" class="hidden" onchange="handleBriefUpload(event)"/>
                      <svg class="w-8 h-8 mx-auto mb-2 text-white/70" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                      <p class="text-sm font-medium">Drop brief here or click to browse</p>
                      <p class="text-xs text-purple-200 mt-1">PDF, DOCX, TXT supported</p>
                    </div>

                    <!-- Uploaded File Display -->
                    <div id="uploadedBriefInfo" class="hidden mt-3 bg-white/10 rounded-lg p-3">
                      <div class="flex items-center gap-2">
                        <svg class="w-5 h-5 text-green-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                        <span id="uploadedFileName" class="text-sm truncate flex-1">filename.pdf</span>
                        <button onclick="clearBriefUpload()" class="p-1 hover:bg-white/20 rounded">
                          <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                        </button>
                      </div>
                    </div>

                    <!-- Parse Button -->
                    <button id="parseBriefBtn" onclick="parseBriefWithAI()" class="hidden w-full mt-3 px-4 py-2.5 bg-white text-purple-700 font-medium rounded-xl hover:bg-purple-50 flex items-center justify-center gap-2">
                      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                      Parse with AI
                    </button>

                    <!-- Processing State -->
                    <div id="briefParsingState" class="hidden mt-3">
                      <div class="flex items-center gap-2 text-sm">
                        <svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
                        <span id="parsingStatusText">Analyzing brief...</span>
                      </div>
                      <div class="mt-2 h-1.5 bg-white/20 rounded-full overflow-hidden">
                        <div id="parsingProgressBar" class="h-full bg-white transition-all duration-500" style="width: 0%"></div>
                      </div>
                    </div>
                  </div>

                  <!-- Right: AI Extraction Summary -->
                  <div class="flex-1">
                    <div class="flex items-center justify-between mb-3">
                      <h4 class="font-medium flex items-center gap-2">
                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                        Extraction Summary
                      </h4>
                      <button id="applyAllBtn" onclick="applyAIExtraction()" class="hidden text-xs px-3 py-1.5 bg-white text-purple-700 rounded-lg hover:bg-purple-50 font-medium">
                        Apply All to Form
                      </button>
                    </div>

                    <!-- Summary Cards Grid -->
                    <div id="aiExtractionSummary" class="grid grid-cols-4 gap-3">
                      <!-- Default empty state -->
                      <div class="col-span-4 text-center py-6 text-purple-200">
                        <svg class="w-10 h-10 mx-auto mb-2 opacity-50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
                        <p class="text-sm">Upload a brief to see AI-extracted data</p>
                      </div>
                    </div>

                    <!-- AI Suggested Segments (appears after parsing) -->
                    <div id="aiSuggestedSegmentsSection" class="hidden mt-3 pt-3 border-t border-white/20">
                      <p class="text-xs text-purple-200 mb-2">AI Suggested Audience Segments:</p>
                      <div id="aiSuggestedSegmentsTags" class="flex flex-wrap gap-1.5">
                        <!-- Populated by JS -->
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Campaign Form - Below AI Parser -->
              <div class="bg-white rounded-2xl border border-slate-200 shadow-sm">
                <div class="p-5 border-b border-slate-100">
                  <h3 class="text-xl font-semibold text-slate-800">Campaign Details</h3>
                  <p class="text-sm text-slate-500 mt-1">Enter campaign information or let AI extract from your brief above</p>
                </div>
                <div class="p-5 space-y-5">
                  <!-- Campaign Info -->
                  <div class="grid grid-cols-2 gap-4">
                    <div>
                      <label class="block text-sm font-medium text-slate-700 mb-1.5">Campaign Name <span class="text-red-500">*</span></label>
                      <input type="text" id="campaignName" placeholder="e.g., Summer Brand Launch 2026" class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updatePlanState('campaignName', this.value)"/>
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-slate-700 mb-1.5">Client / Brand <span class="text-red-500">*</span></label>
                      <input type="text" id="clientBrand" placeholder="e.g., ACME Corp" class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updatePlanState('clientBrand', this.value)"/>
                    </div>
                  </div>

                  <!-- Industry Selection (Compact) -->
                  <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1.5">Industry <span class="text-red-500">*</span></label>
                    <div class="grid grid-cols-8 gap-2" id="industrySelector">
                      <button onclick="selectIndustry('fmcg')" class="industry-btn p-2 border-2 border-slate-200 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-all" data-industry="fmcg">
                        <div class="w-7 h-7 mx-auto mb-1 bg-gradient-to-br from-green-400 to-green-600 rounded-lg flex items-center justify-center">
                          <svg class="w-3.5 h-3.5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
                        </div>
                        <p class="text-[10px] font-medium text-slate-700">FMCG</p>
                      </button>
                      <button onclick="selectIndustry('retail')" class="industry-btn p-2 border-2 border-slate-200 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-all" data-industry="retail">
                        <div class="w-7 h-7 mx-auto mb-1 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center">
                          <svg class="w-3.5 h-3.5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
                        </div>
                        <p class="text-[10px] font-medium text-slate-700">Retail</p>
                      </button>
                      <button onclick="selectIndustry('auto')" class="industry-btn p-2 border-2 border-slate-200 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-all" data-industry="auto">
                        <div class="w-7 h-7 mx-auto mb-1 bg-gradient-to-br from-slate-500 to-slate-700 rounded-lg flex items-center justify-center">
                          <svg class="w-3.5 h-3.5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 17H4a2 2 0 0 1-2-2V9.5A6.5 6.5 0 0 1 4.1 5L6 3h12l1.9 2a6.5 6.5 0 0 1 2.1 4.5V15a2 2 0 0 1-2 2h-1"/><circle cx="7.5" cy="17.5" r="2.5"/><circle cx="16.5" cy="17.5" r="2.5"/></svg>
                        </div>
                        <p class="text-[10px] font-medium text-slate-700">Auto</p>
                      </button>
                      <button onclick="selectIndustry('finance')" class="industry-btn p-2 border-2 border-slate-200 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-all" data-industry="finance">
                        <div class="w-7 h-7 mx-auto mb-1 bg-gradient-to-br from-amber-400 to-amber-600 rounded-lg flex items-center justify-center">
                          <svg class="w-3.5 h-3.5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                        </div>
                        <p class="text-[10px] font-medium text-slate-700">Finance</p>
                      </button>
                      <button onclick="selectIndustry('tech')" class="industry-btn p-2 border-2 border-slate-200 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-all" data-industry="tech">
                        <div class="w-7 h-7 mx-auto mb-1 bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg flex items-center justify-center">
                          <svg class="w-3.5 h-3.5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                        </div>
                        <p class="text-[10px] font-medium text-slate-700">Tech</p>
                      </button>
                      <button onclick="selectIndustry('health')" class="industry-btn p-2 border-2 border-slate-200 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-all" data-industry="health">
                        <div class="w-7 h-7 mx-auto mb-1 bg-gradient-to-br from-red-400 to-red-600 rounded-lg flex items-center justify-center">
                          <svg class="w-3.5 h-3.5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                        </div>
                        <p class="text-[10px] font-medium text-slate-700">Health</p>
                      </button>
                      <button onclick="selectIndustry('travel')" class="industry-btn p-2 border-2 border-slate-200 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-all" data-industry="travel">
                        <div class="w-7 h-7 mx-auto mb-1 bg-gradient-to-br from-cyan-400 to-cyan-600 rounded-lg flex items-center justify-center">
                          <svg class="w-3.5 h-3.5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>
                        </div>
                        <p class="text-[10px] font-medium text-slate-700">Travel</p>
                      </button>
                      <button onclick="selectIndustry('other')" class="industry-btn p-2 border-2 border-slate-200 rounded-xl text-center hover:border-purple-400 hover:bg-purple-50 transition-all" data-industry="other">
                        <div class="w-7 h-7 mx-auto mb-1 bg-gradient-to-br from-pink-400 to-pink-600 rounded-lg flex items-center justify-center">
                          <svg class="w-3.5 h-3.5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
                        </div>
                        <p class="text-[10px] font-medium text-slate-700">Other</p>
                      </button>
                    </div>
                  </div>

                  <!-- Campaign Meta Row 1 -->
                  <div class="grid grid-cols-4 gap-4">
                    <div>
                      <label class="block text-sm font-medium text-slate-700 mb-1.5">Campaign Objective</label>
                      <select id="campaignObjective" class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updatePlanState('objective', this.value)">
                        <option value="">Select objective</option>
                        <option value="awareness">Brand Awareness</option>
                        <option value="consideration">Consideration</option>
                        <option value="conversion">Conversion / Sales</option>
                        <option value="retention">Customer Retention</option>
                        <option value="launch">Product Launch</option>
                      </select>
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-slate-700 mb-1.5">Total Budget</label>
                      <div class="relative">
                        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm">$</span>
                        <input type="text" id="totalBudget" placeholder="12,000,000" class="w-full pl-7 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updatePlanState('budget', this.value)"/>
                      </div>
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-slate-700 mb-1.5">Duration</label>
                      <select id="campaignDuration" class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updatePlanState('duration', this.value); calculateEndDate()">
                        <option value="">Select duration</option>
                        <option value="4">4 weeks</option>
                        <option value="8">8 weeks</option>
                        <option value="12">12 weeks</option>
                        <option value="26">6 months (26 wks)</option>
                        <option value="52">12 months (52 wks)</option>
                      </select>
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-slate-700 mb-1.5">Start Date</label>
                      <input type="date" id="startDate" class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updatePlanState('startDate', this.value); calculateEndDate()"/>
                    </div>
                  </div>

                  <!-- Second Row -->
                  <div class="grid grid-cols-4 gap-4">
                    <div>
                      <label class="block text-sm font-medium text-slate-700 mb-1.5">End Date</label>
                      <input type="date" id="endDate" class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updatePlanState('endDate', this.value)"/>
                    </div>
                    <div class="col-span-3">
                      <label class="block text-sm font-medium text-slate-700 mb-1.5">Campaign Brief / Notes</label>
                      <input type="text" id="campaignNotes" placeholder="Key messages, constraints, additional details..." class="w-full px-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updatePlanState('notes', this.value)"/>
                    </div>
                  </div>
                </div>

                <div class="flex justify-end p-4 bg-slate-50 border-t border-slate-200 rounded-b-2xl">
                  <button onclick="goToStep(2)" class="px-6 py-2.5 lumos-gradient text-white text-sm font-medium rounded-xl flex items-center gap-2">
                    Continue to Audience
                    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- STEP 2: Advanced Audience Builder -->
          <div class="workflow-step hidden" data-workflow-step="2">
            <div class="grid grid-cols-3 gap-4">
              <!-- Left Panel: Audience Categories & Selection -->
              <div class="col-span-2 space-y-4">
                <div class="bg-white rounded-2xl border border-slate-200 shadow-sm">
                  <div class="p-4 border-b border-slate-100">
                    <h3 class="text-lg font-semibold text-slate-800">Define Target Audience (Optional)</h3>
                    <div class="flex items-center gap-2 mt-2">
                      <button onclick="setAudienceBaseline('region')" class="audience-baseline-btn px-3 py-1.5 text-xs border border-slate-300 rounded-lg hover:bg-slate-50 flex items-center gap-1">
                        <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                        Region
                      </button>
                      <button onclick="setAudienceBaseline('city')" class="audience-baseline-btn px-3 py-1.5 text-xs border border-slate-300 rounded-lg hover:bg-slate-50 flex items-center gap-1">
                        <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                        City
                      </button>
                      <button onclick="setAudienceBaseline('area')" class="audience-baseline-btn px-3 py-1.5 text-xs border border-slate-300 rounded-lg hover:bg-slate-50 flex items-center gap-1">
                        <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
                        Area
                      </button>
                      <button onclick="setAudienceBaseline('postcode')" class="audience-baseline-btn px-3 py-1.5 text-xs border border-slate-300 rounded-lg hover:bg-slate-50 flex items-center gap-1">
                        <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                        Postcode
                      </button>
                    </div>
                  </div>

                  <!-- Search Bar -->
                  <div class="p-4 border-b border-slate-100">
                    <h4 class="text-sm font-medium text-slate-700 mb-2">Search all audiences</h4>
                    <div class="relative">
                      <svg class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
                      <input type="text" id="audienceSearchInput" placeholder="Type to search, or select one of below categories" class="w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onkeyup="searchAudienceSegments(this.value)"/>
                    </div>
                  </div>

                  <!-- Category Tabs -->
                  <div class="border-b border-slate-200">
                    <div class="flex">
                      <button onclick="showAudienceTab('basic')" class="audience-cat-tab px-4 py-3 text-sm font-medium text-slate-400 border-b-2 border-transparent hover:text-slate-600" data-audience-cat="basic">Basic Demographics</button>
                      <button onclick="showAudienceTab('advanced')" class="audience-cat-tab px-4 py-3 text-sm font-medium text-purple-600 border-b-2 border-purple-600" data-audience-cat="advanced">Advanced Audiences</button>
                      <button onclick="showAudienceTab('saved')" class="audience-cat-tab px-4 py-3 text-sm font-medium text-slate-400 border-b-2 border-transparent hover:text-slate-600" data-audience-cat="saved">Saved Personas</button>
                    </div>
                  </div>

                  <!-- Basic Demographics Tab -->
                  <div class="audience-cat-content hidden p-4" data-audience-cat-content="basic">
                    <div class="grid grid-cols-2 gap-4">
                      <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Primary Demographic</label>
                        <select id="primaryDemo" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updateAudienceSize()">
                          <option value="P18-54">People 18-54</option>
                          <option value="P25-54">People 25-54</option>
                          <option value="P18-39">People 18-39</option>
                          <option value="P18+">People 18+</option>
                          <option value="W18-54">Women 18-54</option>
                          <option value="W25-54">Women 25-54</option>
                          <option value="M18-54">Men 18-54</option>
                          <option value="M25-54">Men 25-54</option>
                        </select>
                      </div>
                      <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Secondary Demographic</label>
                        <select id="secondaryDemo" class="w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-500" onchange="updateAudienceSize()">
                          <option value="">None</option>
                          <option value="P18-39">People 18-39</option>
                          <option value="P40+">People 40+</option>
                          <option value="ABC1">ABC1 Households</option>
                          <option value="families">Families with children</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <!-- Advanced Audiences Tab (Multi-Level Category Selection) -->
                  <div class="audience-cat-content p-4" data-audience-cat-content="advanced">
                    <div class="flex gap-4">
                      <!-- Level 1: Main Categories -->
                      <div class="w-1/3 border-r border-slate-200 pr-4">
                        <p class="text-xs font-medium text-slate-500 uppercase mb-2">All Categories</p>
                        <div class="space-y-1 max-h-80 overflow-y-auto" id="audienceMainCategories">
                          <button onclick="selectAudienceCategory('demographics')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="demographics">
                            <span class="flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>Advanced Demographics</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('apparel')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="apparel">
                            <span>Apparel and Accessories</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('appcategories')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="appcategories">
                            <span class="flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>App Categories</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('apps')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="apps">
                            <span>Apps</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('brandvisitor')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="brandvisitor">
                            <span class="flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>Brand Visitor</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('household')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="household">
                            <span class="flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>Household Consumption</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('lifestyle')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="lifestyle">
                            <span class="flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>Lifestyle</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('interests')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="interests">
                            <span class="flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/><line x1="10" y1="3" x2="8" y2="21"/><line x1="16" y1="3" x2="14" y2="21"/></svg>Online Interests</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('placevisitors')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="placevisitors">
                            <span class="flex items-center gap-2"><svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>Place Visitors</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('purchase')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg border border-purple-400 bg-purple-50 text-purple-700" data-cat="purchase">
                            <span class="flex items-center gap-2"><svg class="w-4 h-4 text-purple-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>Purchase Behaviour (Mastercard)</span>
                            <svg class="w-4 h-4 text-purple-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectAudienceCategory('retargeting')" class="audience-main-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-cat="retargeting">
                            <span>Retargeting</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                        </div>
                      </div>

                      <!-- Level 2: Sub-Categories -->
                      <div class="w-1/3 border-r border-slate-200 pr-4">
                        <p class="text-xs font-medium text-slate-500 uppercase mb-2" id="subCategoryTitle">Purchase Behaviour (Mastercard)</p>
                        <div class="space-y-1 max-h-80 overflow-y-auto" id="audienceSubCategories">
                          <button onclick="selectSubCategory('dining')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg border border-purple-400 bg-purple-50 text-purple-700" data-subcat="dining">
                            <span>Dining</span>
                            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectSubCategory('education')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-subcat="education">
                            <span>Education</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectSubCategory('grocery')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-subcat="grocery">
                            <span>Grocery</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectSubCategory('health')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-subcat="health">
                            <span>Health</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectSubCategory('household')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-subcat="household">
                            <span>Household, Leisure and Entertainment</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectSubCategory('luxury')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-subcat="luxury">
                            <span>Luxury Retail</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectSubCategory('online')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-subcat="online">
                            <span>Online Retail</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectSubCategory('retail')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-subcat="retail">
                            <span>Retail</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                          <button onclick="selectSubCategory('services')" class="audience-sub-cat w-full flex items-center justify-between px-3 py-2.5 text-sm text-left rounded-lg hover:bg-slate-50 border border-transparent" data-subcat="services">
                            <span>Services</span>
                            <svg class="w-4 h-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                          </button>
                        </div>
                      </div>

                      <!-- Level 3: Specific Segments -->
                      <div class="w-1/3">
                        <p class="text-xs font-medium text-slate-500 uppercase mb-2" id="segmentTitle">Dining</p>
                        <div class="space-y-1 max-h-80 overflow-y-auto" id="audienceSegments">
                          <label class="segment-item flex items-center gap-3 px-3 py-2.5 text-sm rounded-lg border border-slate-200 cursor-pointer hover:bg-slate-50">
                            <span class="flex-1">Frequent Buyers at Restaurants With No Wait Staff or Servers</span>
                            <button class="p-1 text-slate-400 hover:text-slate-600"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></button>
                            <input type="checkbox" class="segment-checkbox w-4 h-4 text-purple-600 rounded focus:ring-purple-500" value="dining_freq_nowait" onchange="toggleAudienceSegment(this)"/>
                          </label>
                          <label class="segment-item flex items-center gap-3 px-3 py-2.5 text-sm rounded-lg border border-slate-200 cursor-pointer hover:bg-slate-50">
                            <span class="flex-1">Frequent Buyers at Restaurants and Quick Service Restaurants</span>
                            <button class="p-1 text-slate-400 hover:text-slate-600"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></button>
                            <input type="checkbox" class="segment-checkbox w-4 h-4 text-purple-600 rounded focus:ring-purple-500" value="dining_freq_qsr" onchange="toggleAudienceSegment(this)"/>
                          </label>
                          <label class="segment-item flex items-center gap-3 px-3 py-2.5 text-sm rounded-lg border border-slate-200 cursor-pointer hover:bg-slate-50">
                            <span class="flex-1">High Spenders at Restaurants With No Wait Staff or Servers</span>
                            <button class="p-1 text-slate-400 hover:text-slate-600"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></button>
                            <input type="checkbox" class="segment-checkbox w-4 h-4 text-purple-600 rounded focus:ring-purple-500" value="dining_high_nowait" onchange="toggleAudienceSegment(this)"/>
                          </label>
                          <label class="segment-item flex items-center gap-3 px-3 py-2.5 text-sm rounded-lg border border-purple-400 bg-purple-50 cursor-pointer">
                            <span class="flex-1 text-purple-700">High Spenders at Restaurants and Quick Service Restaurants</span>
                            <button class="p-1 text-purple-400 hover:text-purple-600"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg></button>
                            <input type="checkbox" class="segment-checkbox w-4 h-4 text-purple-600 rounded focus:ring-purple-500" value="dining_high_qsr" checked onchange="toggleAudienceSegment(this)"/>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Saved Personas Tab -->
                  <div class="audience-cat-content hidden p-4" data-audience-cat-content="saved">
                    <div class="space-y-4">
                      <!-- Persona Card 1 -->
                      <div class="border border-slate-200 rounded-xl p-4 hover:bg-slate-50 cursor-pointer">
                        <div class="flex items-start justify-between">
                          <div>
                            <h5 class="font-semibold text-slate-800">High Value Audience</h5>
                            <div class="flex flex-wrap gap-1.5 mt-2">
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">Fast Food Consumers</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">Fast Food Chain visitors</span>
                              <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">In Market Automotive Buyers</span>
                              <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">Automobile Owners</span>
                              <span class="px-2 py-0.5 bg-amber-100 text-amber-700 rounded text-xs">Family Travellers</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">25 - 34 years old</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">35 - 44 years old</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">18 - 24 years old</span>
                              <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">Experiential Entertainment Seekers</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">Tech Enthusiasts</span>
                              <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">Weekend Family Activity Enthusiasts</span>
                            </div>
                            <div class="mt-3 p-3 bg-slate-50 rounded-lg">
                              <p class="text-xs font-medium text-slate-600 mb-1">Description</p>
                              <p class="text-xs text-slate-500">The suggested prospective competitor audience includes tech-savvy, family-oriented buyers aged 18-44 who have recently explored various retail environments. They are in-market consumers actively engaged in family activities, entertainment, and influencing purchasing decisions within their social circles.</p>
                            </div>
                          </div>
                          <input type="checkbox" class="w-4 h-4 text-purple-600 rounded focus:ring-purple-500"/>
                        </div>
                      </div>

                      <!-- Persona Card 2 -->
                      <div class="border border-slate-200 rounded-xl p-4 hover:bg-slate-50 cursor-pointer">
                        <div class="flex items-start justify-between">
                          <div>
                            <h5 class="font-semibold text-slate-800">Prospective Competitor Audience</h5>
                            <div class="flex flex-wrap gap-1.5 mt-2">
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">Fast Food Consumers</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">Fast Food Chain visitors</span>
                              <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">In Market Automotive Buyers</span>
                              <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">Automobile Owners</span>
                              <span class="px-2 py-0.5 bg-amber-100 text-amber-700 rounded text-xs">Family Travellers</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">25 - 34 years old</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">35 - 44 years old</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">18 - 24 years old</span>
                              <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">Experiential Entertainment Seekers</span>
                              <span class="px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-xs">Tech Enthusiasts</span>
                              <span class="px-2 py-0.5 bg-purple-100 text-purple-700 rounded text-xs">Weekend Family Activity Enthusiasts</span>
                            </div>
                            <div class="mt-3 p-3 bg-slate-50 rounded-lg">
                              <p class="text-xs font-medium text-slate-600 mb-1">Description</p>
                              <p class="text-xs text-slate-500">The suggested prospective competitor audience includes tech-savvy, family-oriented buyers aged 18-44 who have recently explored various retail environments.</p>
                            </div>
                          </div>
                          <input type="checkbox" class="w-4 h-4 text-purple-600 rounded focus:ring-purple-500"/>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Right Panel: Audience Focus Summary -->
              <div class="col-span-1 space-y-4">
                <div class="bg-white rounded-2xl border border-slate-200 shadow-sm p-4">
                  <div class="flex items-center justify-between mb-3">
                    <h4 class="font-semibold text-slate-800">Increase audience focus</h4>
                    <span class="text-xs text-slate-500" id="segmentsSelectedCount">8 / 10 segments selected</span>
                  </div>

                  <!-- Progress Bar -->
                  <div class="h-1.5 bg-slate-100 rounded-full mb-4 overflow-hidden">
                    <div class="h-full bg-gradient-to-r from-purple-500 to-purple-600 rounded-full transition-all" style="width: 80%" id="audienceFocusBar"></div>
                  </div>

                  <!-- Selected Segments Tags -->
                  <div class="flex flex-wrap gap-1.5 mb-4" id="selectedSegmentTags">
                    <span class="px-2 py-1 bg-slate-100 text-slate-700 rounded-full text-xs flex items-center gap-1">Male<button onclick="removeSegmentTag('male')" class="hover:text-red-500">×</button></span>
                    <span class="px-2 py-1 bg-slate-100 text-slate-700 rounded-full text-xs flex items-center gap-1">25 - 34 years old<button onclick="removeSegmentTag('age25-34')" class="hover:text-red-500">×</button></span>
                    <span class="px-2 py-1 bg-slate-100 text-slate-700 rounded-full text-xs flex items-center gap-1">Medium affluence<button onclick="removeSegmentTag('affluence')" class="hover:text-red-500">×</button></span>
                    <span class="px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs flex items-center gap-1">Business and Industry<button onclick="removeSegmentTag('business')" class="hover:text-red-500">×</button></span>
                    <span class="px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs flex items-center gap-1">Family Travellers<button onclick="removeSegmentTag('family')" class="hover:text-red-500">×</button></span>
                    <span class="px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs flex items-center gap-1">Tech Enthusiasts<button onclick="removeSegmentTag('tech')" class="hover:text-red-500">×</button></span>
                    <span class="px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs flex items-center gap-1">Weekend Family Activity Enthusiasts<button onclick="removeSegmentTag('weekend')" class="hover:text-red-500">×</button></span>
                    <span class="px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs flex items-center gap-1">Automobile Owners<button onclick="removeSegmentTag('auto')" class="hover:text-red-500">×</button></span>
                  </div>

                  <!-- Warning -->
                  <div class="flex items-center gap-2 text-amber-600 text-xs mb-3" id="audienceWarning">
                    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    <span>Your audience selection is too narrow</span>
                  </div>

                  <!-- Audience Reach -->
                  <div class="flex items-center justify-between">
                    <div>
                      <p class="text-sm text-slate-600">Potential Audience Reach:</p>
                      <p class="text-xl font-bold text-slate-800" id="estAudienceSize">50k-80k</p>
                    </div>
                    <button class="px-3 py-1.5 bg-purple-100 text-purple-700 rounded-lg text-sm flex items-center gap-1.5">
                      <span>Saved</span>
                      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                    </button>
                  </div>
                </div>

                <!-- Audience Summary Stats -->
                <div class="bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-4 border border-purple-100">
                  <h4 class="font-semibold text-slate-800 mb-3">Audience Summary</h4>
                  <div class="grid grid-cols-2 gap-3">
                    <div class="text-center p-3 bg-white rounded-lg">
                      <p class="text-xl font-bold text-purple-600" id="audienceUniverse">12.4M</p>
                      <p class="text-xs text-slate-500 mt-0.5">Universe Size</p>
                    </div>
                    <div class="text-center p-3 bg-white rounded-lg">
                      <p class="text-xl font-bold text-blue-600" id="audienceReachable">8.2M</p>
                      <p class="text-xs text-slate-500 mt-0.5">Reachable</p>
                    </div>
                    <div class="text-center p-3 bg-white rounded-lg">
                      <p class="text-xl font-bold text-green-600" id="audienceAffinity">1.4x</p>
                      <p class="text-xs text-slate-500 mt-0.5">Category Affinity</p>
                    </div>
                    <div class="text-center p-3 bg-white rounded-lg">
                      <p class="text-xl font-bold text-amber-600" id="audienceIndex">124</p>
                      <p class="text-xs text-slate-500 mt-0.5">Target Index</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Footer Navigation -->
            <div class="mt-4 flex justify-between items-center bg-white rounded-2xl border border-slate-200 shadow-sm p-4">
              <button onclick="goToStep(1)" class="flex items-center gap-2 px-4 py-2 text-sm text-slate-600 hover:text-slate-800">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                Back
              </button>
              <div class="flex items-center gap-2 text-sm text-slate-500">
                <span class="w-5 h-5 bg-purple-100 text-purple-700 rounded-full flex items-center justify-center text-xs font-medium">2</span>
                Things to complete
              </div>
              <div class="flex items-center gap-3">
                <button onclick="goToStep(3)" class="px-4 py-2 text-sm text-slate-600 hover:text-slate-800">Skip</button>
                <button onclick="saveAndContinueAudience()" class="px-6 py-2.5 lumos-gradient text-white text-sm font-medium rounded-xl flex items-center gap-2">
                  Save and review
                  <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                </button>
              </div>
            </div>
          </div>

          <!-- STEP 3: Data Benchmarks -->
          <div class="workflow-step hidden" data-workflow-step="3">
            <div class="bg-white rounded-2xl border border-slate-200 shadow-sm">
              <div class="p-6 border-b border-slate-100">
                <h3 class="text-xl font-semibold text-slate-800">Data & Benchmarks</h3>
                <p class="text-sm text-slate-500 mt-1">Select benchmark data for your campaign planning</p>
              </div>
              <div class="p-6 space-y-6">
                <!-- Data Source Selection -->
                <div>
                  <label class="block text-sm font-medium text-slate-700 mb-3">Select Data Source</label>
                  <div class="grid grid-cols-2 gap-4">
                    <div class="data-source-card border-2 border-purple-400 bg-purple-50 rounded-xl p-5 cursor-pointer" onclick="selectDataSource('uploaded')">
                      <div class="flex items-start gap-4">
                        <div class="w-12 h-12 bg-purple-600 rounded-xl flex items-center justify-center">
                          <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                        </div>
                        <div class="flex-1">
                          <h4 class="font-semibold text-slate-800">Pre-Uploaded Data</h4>
                          <p class="text-sm text-slate-500 mt-1">Use existing benchmark data from your account</p>
                          <div class="mt-3 flex items-center gap-2">
                            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                            <span class="text-xs text-green-600 font-medium">3 datasets available</span>
                          </div>
                        </div>
                        <div class="w-5 h-5 bg-purple-600 rounded-full flex items-center justify-center">
                          <svg class="w-3 h-3 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
                        </div>
                      </div>
                    </div>
                    <div class="data-source-card border-2 border-slate-200 rounded-xl p-5 cursor-pointer hover:border-purple-300 hover:bg-purple-50/30" onclick="selectDataSource('datalab')">
                      <div class="flex items-start gap-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center">
                          <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                        </div>
                        <div class="flex-1">
                          <h4 class="font-semibold text-slate-800">Lumos Data Lab</h4>
                          <p class="text-sm text-slate-500 mt-1">Request fresh benchmark data from our data team</p>
                          <div class="mt-3 flex items-center gap-2">
                            <span class="w-2 h-2 bg-amber-500 rounded-full animate-pulse"></span>
                            <span class="text-xs text-amber-600 font-medium">~24hr turnaround</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Available Datasets -->
                <div id="uploadedDatasets">
                  <label class="block text-sm font-medium text-slate-700 mb-3">Available Datasets</label>
                  <div class="space-y-3">
                    <label class="flex items-center gap-4 p-4 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50">
                      <input type="radio" name="dataset" value="q4-2025" class="w-4 h-4 text-purple-600" checked/>
                      <div class="flex-1">
                        <p class="font-medium text-slate-800">Q4 2025 Media Benchmarks</p>
                        <p class="text-xs text-slate-500">Uploaded Dec 15, 2025 • Industry: FMCG</p>
                      </div>
                      <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">Latest</span>
                    </label>
                    <label class="flex items-center gap-4 p-4 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50">
                      <input type="radio" name="dataset" value="q3-2025" class="w-4 h-4 text-purple-600"/>
                      <div class="flex-1">
                        <p class="font-medium text-slate-800">Q3 2025 Media Benchmarks</p>
                        <p class="text-xs text-slate-500">Uploaded Sep 10, 2025 • Industry: FMCG</p>
                      </div>
                    </label>
                    <label class="flex items-center gap-4 p-4 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50">
                      <input type="radio" name="dataset" value="custom-auto" class="w-4 h-4 text-purple-600"/>
                      <div class="flex-1">
                        <p class="font-medium text-slate-800">Automotive Category Study</p>
                        <p class="text-xs text-slate-500">Uploaded Nov 22, 2025 • Industry: Automotive</p>
                      </div>
                    </label>
                  </div>
                </div>
                
                <!-- Data Lab Request (hidden by default) -->
                <div id="datalabRequest" class="hidden">
                  <div class="bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl p-5 border border-cyan-200">
                    <h4 class="font-semibold text-slate-800 mb-3 flex items-center gap-2">
                      <svg class="w-5 h-5 text-cyan-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                      Request Data Lab Refresh
                    </h4>
                    <p class="text-sm text-slate-600 mb-4">Our data science team will prepare fresh benchmark data tailored to your campaign needs.</p>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                      <div>
                        <label class="block text-xs font-medium text-slate-600 mb-1">Category Focus</label>
                        <select class="w-full px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm">
                          <option>FMCG - Food & Beverages</option>
                          <option>FMCG - Personal Care</option>
                          <option>Retail - General</option>
                          <option>Automotive</option>
                          <option>Finance</option>
                        </select>
                      </div>
                      <div>
                        <label class="block text-xs font-medium text-slate-600 mb-1">Data Period</label>
                        <select class="w-full px-3 py-2 bg-white border border-slate-200 rounded-lg text-sm">
                          <option>Last 12 months</option>
                          <option>Last 6 months</option>
                          <option>Last 3 months</option>
                          <option>YTD</option>
                        </select>
                      </div>
                    </div>
                    <button class="w-full px-4 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-600 text-white text-sm font-medium rounded-xl hover:from-cyan-600 hover:to-blue-700 flex items-center justify-center gap-2">
                      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                      Submit Data Request
                    </button>
                  </div>
                </div>
              </div>
              
              <div class="flex justify-between p-4 bg-slate-50 border-t border-slate-200 rounded-b-2xl">
                <button onclick="goToStep(2)" class="flex items-center gap-2 px-4 py-2 text-sm text-slate-600">
                  <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                  Back
                </button>
                <button onclick="goToStep(4)" class="px-6 py-2.5 lumos-gradient text-white text-sm font-medium rounded-xl flex items-center gap-2">
                  Continue
                  <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                </button>
              </div>
            </div>
          </div>

          <!-- STEP 4: Market & Channels -->
          <div class="workflow-step hidden" data-workflow-step="4">
            <div class="space-y-4">
              <!-- Header Card -->
              <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between">
                  <div>
                    <h3 class="text-xl font-semibold text-slate-800">Market Selection & Channels</h3>
                    <p class="text-sm text-slate-500 mt-1">Select regions and available media channels</p>
                  </div>
                  <div class="flex items-center gap-3">
                    <div class="text-right">
                      <p class="text-xs text-slate-500">Selected Markets</p>
                      <p class="text-lg font-bold text-purple-600" id="selectedMarketsCount">0</p>
                    </div>
                    <div class="text-right">
                      <p class="text-xs text-slate-500">Est. Audience</p>
                      <p class="text-lg font-bold text-blue-600" id="marketAudienceSize">0</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Main Content -->
              <div class="grid grid-cols-5 gap-4">
                <!-- Map Panel -->
                <div class="col-span-3 bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                  <div class="p-3 border-b border-slate-100 flex items-center justify-between">
                    <h4 class="font-medium text-slate-700 text-sm">Market Map</h4>
                    <div class="flex items-center gap-2">
                      <input type="text" id="postcodeSearch" placeholder="Search postcode or suburb..." class="px-3 py-1.5 text-xs border border-slate-200 rounded-lg w-48 focus:outline-none focus:ring-2 focus:ring-purple-500" onkeyup="searchPostcode(this.value)"/>
                      <button onclick="clearMapSelection()" class="px-2 py-1 text-xs text-slate-500 hover:text-red-600">Clear</button>
                    </div>
                  </div>
                  <div id="marketMap" class="h-[420px] bg-slate-100 relative">
                    <!-- Google Map will be loaded here -->
                    <div class="absolute inset-0 flex items-center justify-center">
                      <div class="text-center">
                        <div class="w-12 h-12 mx-auto mb-3 bg-purple-100 rounded-full flex items-center justify-center">
                          <svg class="w-6 h-6 text-purple-600 animate-pulse" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/></svg>
                        </div>
                        <p class="text-sm text-slate-500">Loading map...</p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Region Selection Panel -->
                <div class="col-span-2 space-y-4">
                  <!-- State Selection -->
                  <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                    <h4 class="font-medium text-slate-700 text-sm mb-3">Select States/Regions</h4>
                    <div class="grid grid-cols-2 gap-2">
                      <label class="region-btn flex items-center gap-2 p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300" data-region="nsw">
                        <input type="checkbox" class="region-checkbox w-4 h-4 text-purple-600 rounded" value="nsw" onchange="updateMarketSelection()"/>
                        <div class="flex-1">
                          <p class="text-sm font-medium text-slate-700">NSW</p>
                          <p class="text-[10px] text-slate-400">8.2M pop</p>
                        </div>
                      </label>
                      <label class="region-btn flex items-center gap-2 p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300" data-region="vic">
                        <input type="checkbox" class="region-checkbox w-4 h-4 text-purple-600 rounded" value="vic" onchange="updateMarketSelection()"/>
                        <div class="flex-1">
                          <p class="text-sm font-medium text-slate-700">VIC</p>
                          <p class="text-[10px] text-slate-400">6.7M pop</p>
                        </div>
                      </label>
                      <label class="region-btn flex items-center gap-2 p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300" data-region="qld">
                        <input type="checkbox" class="region-checkbox w-4 h-4 text-purple-600 rounded" value="qld" onchange="updateMarketSelection()"/>
                        <div class="flex-1">
                          <p class="text-sm font-medium text-slate-700">QLD</p>
                          <p class="text-[10px] text-slate-400">5.3M pop</p>
                        </div>
                      </label>
                      <label class="region-btn flex items-center gap-2 p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300" data-region="wa">
                        <input type="checkbox" class="region-checkbox w-4 h-4 text-purple-600 rounded" value="wa" onchange="updateMarketSelection()"/>
                        <div class="flex-1">
                          <p class="text-sm font-medium text-slate-700">WA</p>
                          <p class="text-[10px] text-slate-400">2.8M pop</p>
                        </div>
                      </label>
                      <label class="region-btn flex items-center gap-2 p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300" data-region="sa">
                        <input type="checkbox" class="region-checkbox w-4 h-4 text-purple-600 rounded" value="sa" onchange="updateMarketSelection()"/>
                        <div class="flex-1">
                          <p class="text-sm font-medium text-slate-700">SA</p>
                          <p class="text-[10px] text-slate-400">1.8M pop</p>
                        </div>
                      </label>
                      <label class="region-btn flex items-center gap-2 p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300" data-region="tas">
                        <input type="checkbox" class="region-checkbox w-4 h-4 text-purple-600 rounded" value="tas" onchange="updateMarketSelection()"/>
                        <div class="flex-1">
                          <p class="text-sm font-medium text-slate-700">TAS</p>
                          <p class="text-[10px] text-slate-400">0.6M pop</p>
                        </div>
                      </label>
                      <label class="region-btn flex items-center gap-2 p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300" data-region="act">
                        <input type="checkbox" class="region-checkbox w-4 h-4 text-purple-600 rounded" value="act" onchange="updateMarketSelection()"/>
                        <div class="flex-1">
                          <p class="text-sm font-medium text-slate-700">ACT</p>
                          <p class="text-[10px] text-slate-400">0.5M pop</p>
                        </div>
                      </label>
                      <label class="region-btn flex items-center gap-2 p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50 hover:border-purple-300" data-region="nt">
                        <input type="checkbox" class="region-checkbox w-4 h-4 text-purple-600 rounded" value="nt" onchange="updateMarketSelection()"/>
                        <div class="flex-1">
                          <p class="text-sm font-medium text-slate-700">NT</p>
                          <p class="text-[10px] text-slate-400">0.25M pop</p>
                        </div>
                      </label>
                    </div>
                    <button onclick="selectAllRegions()" class="mt-3 w-full px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200">Select All (National)</button>
                  </div>

                  <!-- Channel Selection -->
                  <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                    <h4 class="font-medium text-slate-700 text-sm mb-3">Available Channels</h4>
                    <div class="space-y-2 max-h-48 overflow-y-auto">
                      <label class="channel-item flex items-center justify-between p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50">
                        <div class="flex items-center gap-2">
                          <input type="checkbox" class="channel-checkbox w-4 h-4 text-purple-600 rounded" value="tv" checked onchange="updateChannelSelection()"/>
                          <span class="text-sm text-slate-700">Free-to-Air TV</span>
                        </div>
                        <span class="text-xs text-slate-400" id="tvAudience">18.5M</span>
                      </label>
                      <label class="channel-item flex items-center justify-between p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50">
                        <div class="flex items-center gap-2">
                          <input type="checkbox" class="channel-checkbox w-4 h-4 text-purple-600 rounded" value="bvod" checked onchange="updateChannelSelection()"/>
                          <span class="text-sm text-slate-700">BVOD</span>
                        </div>
                        <span class="text-xs text-slate-400">12.2M</span>
                      </label>
                      <label class="channel-item flex items-center justify-between p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50">
                        <div class="flex items-center gap-2">
                          <input type="checkbox" class="channel-checkbox w-4 h-4 text-purple-600 rounded" value="ooh" checked onchange="updateChannelSelection()"/>
                          <span class="text-sm text-slate-700">Out of Home</span>
                        </div>
                        <span class="text-xs text-slate-400">15.8M</span>
                      </label>
                      <label class="channel-item flex items-center justify-between p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50">
                        <div class="flex items-center gap-2">
                          <input type="checkbox" class="channel-checkbox w-4 h-4 text-purple-600 rounded" value="radio" onchange="updateChannelSelection()"/>
                          <span class="text-sm text-slate-700">Radio</span>
                        </div>
                        <span class="text-xs text-slate-400">10.4M</span>
                      </label>
                      <label class="channel-item flex items-center justify-between p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50">
                        <div class="flex items-center gap-2">
                          <input type="checkbox" class="channel-checkbox w-4 h-4 text-purple-600 rounded" value="digital" checked onchange="updateChannelSelection()"/>
                          <span class="text-sm text-slate-700">Digital Display</span>
                        </div>
                        <span class="text-xs text-slate-400">16.1M</span>
                      </label>
                      <label class="channel-item flex items-center justify-between p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50">
                        <div class="flex items-center gap-2">
                          <input type="checkbox" class="channel-checkbox w-4 h-4 text-purple-600 rounded" value="social" checked onchange="updateChannelSelection()"/>
                          <span class="text-sm text-slate-700">Social Media</span>
                        </div>
                        <span class="text-xs text-slate-400">14.8M</span>
                      </label>
                      <label class="channel-item flex items-center justify-between p-2 border border-slate-200 rounded-lg cursor-pointer hover:bg-purple-50">
                        <div class="flex items-center gap-2">
                          <input type="checkbox" class="channel-checkbox w-4 h-4 text-purple-600 rounded" value="audio" onchange="updateChannelSelection()"/>
                          <span class="text-sm text-slate-700">Audio Streaming</span>
                        </div>
                        <span class="text-xs text-slate-400">8.6M</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Navigation -->
              <div class="flex justify-between p-4 bg-white border border-slate-200 rounded-xl shadow-sm">
                <button onclick="goToStep(3)" class="flex items-center gap-2 px-4 py-2 text-sm text-slate-600">
                  <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                  Back
                </button>
                <button onclick="goToStep(5)" class="px-6 py-2.5 lumos-gradient text-white text-sm font-medium rounded-xl flex items-center gap-2">
                  Continue to Optimiser
                  <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                </button>
              </div>
            </div>
          </div>

          <!-- STEP 5: Plan Optimiser -->
          <div class="workflow-step hidden" data-workflow-step="5">
            <div class="space-y-4">
              <!-- Header with Plan Summary -->
              <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between">
                  <div>
                    <h3 class="text-xl font-semibold text-slate-800">Plan Optimiser</h3>
                    <p class="text-sm text-slate-500 mt-1">Configure budget allocation and optimize your media plan</p>
                  </div>
                  <div class="flex items-center gap-3">
                    <div class="text-right px-4 py-2 bg-slate-50 rounded-lg">
                      <p class="text-[10px] text-slate-500">Campaign</p>
                      <p class="text-sm font-semibold text-slate-800" id="planSummaryCampaign">-</p>
                    </div>
                    <div class="text-right px-4 py-2 bg-slate-50 rounded-lg">
                      <p class="text-[10px] text-slate-500">Audience</p>
                      <p class="text-sm font-semibold text-slate-800" id="planSummaryAudience">-</p>
                    </div>
                    <div class="text-right px-4 py-2 bg-slate-50 rounded-lg">
                      <p class="text-[10px] text-slate-500">Markets</p>
                      <p class="text-sm font-semibold text-slate-800" id="planSummaryMarkets">-</p>
                    </div>
                    <button onclick="runOptimisation()" class="px-4 py-2 bg-purple-100 text-purple-700 text-sm font-medium rounded-xl hover:bg-purple-200 flex items-center gap-2">
                      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/></svg>
                      Auto-Optimise
                    </button>
                  </div>
                </div>
              </div>

              <!-- Tab Navigation -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                <div class="flex border-b border-slate-200">
                  <button onclick="showBudgetTab('allocation')" class="budget-tab flex-1 px-4 py-3 text-sm font-medium text-purple-700 bg-purple-50 border-b-2 border-purple-600" data-budget-tab="allocation">
                    <span class="flex items-center justify-center gap-2">
                      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
                      Budget Allocation
                    </span>
                  </button>
                  <button onclick="showBudgetTab('scenarios')" class="budget-tab flex-1 px-4 py-3 text-sm font-medium text-slate-500 hover:text-slate-700 border-b-2 border-transparent" data-budget-tab="scenarios">
                    <span class="flex items-center justify-center gap-2">
                      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                      Scenarios
                    </span>
                  </button>
                  <button onclick="showBudgetTab('flighting')" class="budget-tab flex-1 px-4 py-3 text-sm font-medium text-slate-500 hover:text-slate-700 border-b-2 border-transparent" data-budget-tab="flighting">
                    <span class="flex items-center justify-center gap-2">
                      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                      Flighting
                    </span>
                  </button>
                </div>

                <!-- Tab Content: Allocation -->
                <div class="budget-content p-4" data-budget-content="allocation">
                  <!-- Summary Metrics -->
                  <div class="grid grid-cols-6 gap-3 mb-4">
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-3 text-white">
                      <p class="text-purple-100 text-[10px] font-medium mb-0.5">Total Spend</p>
                      <p class="text-lg font-bold" id="calcTotalSpend">$0</p>
                      <p class="text-purple-200 text-[10px]" id="calcBudgetRemaining">$12M remaining</p>
                    </div>
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-3 text-white">
                      <p class="text-blue-100 text-[10px] font-medium mb-0.5">Combined Reach</p>
                      <p class="text-lg font-bold" id="calcTotalReach">0%</p>
                      <p class="text-blue-200 text-[10px]">1+ frequency</p>
                    </div>
                    <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-3 text-white">
                      <p class="text-green-100 text-[10px] font-medium mb-0.5">Effective Reach</p>
                      <p class="text-lg font-bold" id="calcEffectiveReach">0%</p>
                      <p class="text-green-200 text-[10px]">3+ frequency</p>
                    </div>
                    <div class="bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl p-3 text-white">
                      <p class="text-amber-100 text-[10px] font-medium mb-0.5">Avg Frequency</p>
                      <p class="text-lg font-bold" id="calcAvgFrequency">0x</p>
                      <p class="text-amber-200 text-[10px]">OTS</p>
                    </div>
                    <div class="bg-gradient-to-br from-pink-500 to-pink-600 rounded-xl p-3 text-white">
                      <p class="text-pink-100 text-[10px] font-medium mb-0.5">Total GRPs</p>
                      <p class="text-lg font-bold" id="calcTotalGRPs">0</p>
                      <p class="text-pink-200 text-[10px]">gross rating points</p>
                    </div>
                    <div class="bg-gradient-to-br from-cyan-500 to-cyan-600 rounded-xl p-3 text-white">
                      <p class="text-cyan-100 text-[10px] font-medium mb-0.5">Impressions</p>
                      <p class="text-lg font-bold" id="calcTotalImpressions">0M</p>
                      <p class="text-cyan-200 text-[10px]">estimated</p>
                    </div>
                  </div>

                  <!-- Config Bar -->
                  <div class="flex items-center justify-between mb-4 p-3 bg-slate-50 rounded-lg border border-slate-200">
                    <div class="flex items-center gap-3">
                      <div>
                        <label class="block text-[10px] font-medium text-slate-500 mb-0.5">Demographic</label>
                        <select id="calcDemographic" onchange="setCalcDemographic(this.value)" class="px-2 py-1 text-xs border border-slate-200 rounded-lg bg-white">
                          <option value="P18-54" selected>P18-54</option>
                          <option value="P25-54">P25-54</option>
                          <option value="P18+">P18+</option>
                          <option value="P18-39">P18-39</option>
                        </select>
                      </div>
                      <div>
                        <label class="block text-[10px] font-medium text-slate-500 mb-0.5">Campaign Month</label>
                        <select id="calcMonth" onchange="setCalcMonth(this.value)" class="px-2 py-1 text-xs border border-slate-200 rounded-lg bg-white">
                          <option value="Jan">January</option>
                          <option value="Feb">February</option>
                          <option value="Mar">March</option>
                          <option value="Apr" selected>April</option>
                          <option value="May">May</option>
                          <option value="Jun">June</option>
                          <option value="Jul">July</option>
                          <option value="Aug">August</option>
                          <option value="Sep">September</option>
                          <option value="Oct">October</option>
                          <option value="Nov">November</option>
                          <option value="Dec">December</option>
                        </select>
                      </div>
                      <div class="text-xs text-slate-500">Seasonality: <span id="calcSeasonality" class="font-medium text-purple-600">0.98x</span></div>
                    </div>
                    <div class="flex items-center gap-2">
                      <button onclick="applyCalcPreset('balanced')" class="px-2.5 py-1 text-[10px] bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200">Balanced</button>
                      <button onclick="applyCalcPreset('tv-heavy')" class="px-2.5 py-1 text-[10px] bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200">TV Heavy</button>
                      <button onclick="applyCalcPreset('digital-first')" class="px-2.5 py-1 text-[10px] bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200">Digital First</button>
                      <button onclick="clearCalcChannels()" class="px-2.5 py-1 text-[10px] bg-red-50 text-red-600 rounded-lg hover:bg-red-100">Clear</button>
                    </div>
                  </div>

                  <!-- Main Grid -->
                  <div class="grid grid-cols-3 gap-4">
                    <!-- Channel Selection -->
                    <div class="bg-white rounded-lg p-3 border border-slate-200">
                      <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium text-slate-700 text-sm">Add Channels</h4>
                        <div class="relative">
                          <button onclick="toggleCalcChannelDropdown()" class="px-2 py-1 text-[10px] bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 flex items-center gap-1">
                            <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                            Add
                          </button>
                          <div id="calcChannelDropdown" class="hidden absolute right-0 mt-1 w-52 bg-white rounded-lg shadow-lg border border-slate-200 z-20 max-h-56 overflow-y-auto">
                            <div class="p-1.5">
                              <p class="text-[10px] text-slate-400 font-medium px-2 py-1">TV & VIDEO</p>
                              <button onclick="addCalcChannel('TV 30s (Metro + Regional)')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">TV 30s (Metro + Regional)</button>
                              <button onclick="addCalcChannel('TV 30s (Metro Only)')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">TV 30s (Metro Only)</button>
                              <button onclick="addCalcChannel('BVOD')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">BVOD</button>
                              <button onclick="addCalcChannel('Premium Reservation VOD')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Premium Reservation VOD</button>
                              <button onclick="addCalcChannel('Programmatic Video')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Programmatic Video</button>
                              <p class="text-[10px] text-slate-400 font-medium px-2 py-1 mt-1">SOCIAL & DIGITAL</p>
                              <button onclick="addCalcChannel('Social Video')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Social Video</button>
                              <button onclick="addCalcChannel('Social')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Social</button>
                              <button onclick="addCalcChannel('Display (Programmatic)')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Display (Programmatic)</button>
                              <button onclick="addCalcChannel('Display (Premium)')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Display (Premium)</button>
                              <button onclick="addCalcChannel('Search')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Search</button>
                              <p class="text-[10px] text-slate-400 font-medium px-2 py-1 mt-1">OUT OF HOME</p>
                              <button onclick="addCalcChannel('Large Format OOH')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Large Format OOH</button>
                              <button onclick="addCalcChannel('Small OOH')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Small OOH</button>
                              <p class="text-[10px] text-slate-400 font-medium px-2 py-1 mt-1">AUDIO</p>
                              <button onclick="addCalcChannel('Audio Streaming')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Audio Streaming</button>
                              <button onclick="addCalcChannel('Radio')" class="w-full text-left px-2 py-1 text-[11px] text-slate-700 hover:bg-purple-50 rounded">Radio</button>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="space-y-1.5 max-h-64 overflow-y-auto" id="calcChannelInputs">
                        <div class="text-center py-4 text-slate-400">
                          <svg class="w-8 h-8 mx-auto mb-1 opacity-50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                          <p class="text-[10px]">No channels added</p>
                          <p class="text-[10px] mt-0.5">Click "Add" or use preset</p>
                        </div>
                      </div>
                    </div>

                    <!-- Performance Table -->
                    <div class="col-span-2 bg-white rounded-lg p-3 border border-slate-200">
                      <h4 class="font-medium text-slate-700 text-sm mb-2">Channel Performance</h4>
                      <div class="overflow-x-auto" id="calcOutputTable">
                        <table class="w-full text-[11px]">
                          <thead>
                            <tr class="bg-slate-50 text-slate-600 uppercase tracking-wider">
                              <th class="px-2 py-1.5 text-left font-medium">Channel</th>
                              <th class="px-2 py-1.5 text-right font-medium">%</th>
                              <th class="px-2 py-1.5 text-right font-medium">Spend</th>
                              <th class="px-2 py-1.5 text-right font-medium">CPM</th>
                              <th class="px-2 py-1.5 text-right font-medium">Impr</th>
                              <th class="px-2 py-1.5 text-right font-medium">Reach</th>
                              <th class="px-2 py-1.5 text-right font-medium">Freq</th>
                              <th class="px-2 py-1.5 text-right font-medium">GRPs</th>
                            </tr>
                          </thead>
                          <tbody id="calcTableBody">
                            <tr><td colspan="8" class="text-center py-6 text-slate-400 text-xs">Add channels to see metrics</td></tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>

                  <!-- Charts -->
                  <div class="grid grid-cols-2 gap-4 mt-4">
                    <div class="bg-white rounded-lg p-3 border border-slate-200">
                      <h4 class="font-medium text-slate-700 text-sm mb-2">Reach Curves</h4>
                      <div class="h-36 relative">
                        <svg class="w-full h-full" viewBox="0 0 400 130">
                          <line x1="35" y1="10" x2="35" y2="110" stroke="#e2e8f0" stroke-width="1"/>
                          <text x="30" y="15" text-anchor="end" class="text-[8px] fill-slate-400">100%</text>
                          <text x="30" y="62" text-anchor="end" class="text-[8px] fill-slate-400">50%</text>
                          <text x="30" y="110" text-anchor="end" class="text-[8px] fill-slate-400">0%</text>
                          <line x1="35" y1="110" x2="390" y2="110" stroke="#e2e8f0" stroke-width="1"/>
                          <text x="35" y="122" text-anchor="middle" class="text-[7px] fill-slate-400">$0</text>
                          <text x="212" y="122" text-anchor="middle" class="text-[7px] fill-slate-400">$2M</text>
                          <text x="390" y="122" text-anchor="middle" class="text-[7px] fill-slate-400">$4M</text>
                          <g id="calcReachCurves"></g>
                        </svg>
                      </div>
                      <div class="flex flex-wrap items-center justify-center gap-2 mt-1" id="calcReachLegend"></div>
                    </div>
                    <div class="bg-white rounded-lg p-3 border border-slate-200">
                      <h4 class="font-medium text-slate-700 text-sm mb-2">Frequency Distribution</h4>
                      <div class="h-36 flex items-end justify-between gap-1 px-2 pb-2" id="calcFrequencyChart">
                        <div class="flex-1 bg-purple-100 rounded-t transition-all duration-300" style="height: 0%"></div>
                        <div class="flex-1 bg-purple-200 rounded-t transition-all duration-300" style="height: 0%"></div>
                        <div class="flex-1 bg-purple-300 rounded-t transition-all duration-300" style="height: 0%"></div>
                        <div class="flex-1 bg-purple-400 rounded-t transition-all duration-300" style="height: 0%"></div>
                        <div class="flex-1 bg-purple-500 rounded-t transition-all duration-300" style="height: 0%"></div>
                        <div class="flex-1 bg-purple-600 rounded-t transition-all duration-300" style="height: 0%"></div>
                        <div class="flex-1 bg-purple-700 rounded-t transition-all duration-300" style="height: 0%"></div>
                        <div class="flex-1 bg-purple-800 rounded-t transition-all duration-300" style="height: 0%"></div>
                      </div>
                      <div class="flex justify-between text-[9px] text-slate-400 px-2">
                        <span>1+</span><span>2+</span><span>3+</span><span>4+</span><span>5+</span><span>6+</span><span>7+</span><span>8+</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Tab Content: Scenarios -->
                <div class="budget-content hidden p-4" data-budget-content="scenarios">
                  <div class="grid grid-cols-3 gap-4">
                    <div class="scenario-card bg-purple-50 border-2 border-purple-400 rounded-xl p-4 cursor-pointer relative" onclick="selectScenario('a')">
                      <div class="absolute top-3 right-3">
                        <div class="w-5 h-5 bg-purple-600 rounded-full flex items-center justify-center">
                          <svg class="w-3 h-3 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
                        </div>
                      </div>
                      <h4 class="font-semibold text-slate-800 mb-1">Scenario A</h4>
                      <p class="text-xs text-slate-500 mb-3">Balanced Mix - Recommended</p>
                      <div class="h-5 rounded overflow-hidden flex mb-3">
                        <div class="bg-purple-600" style="width: 30%"></div>
                        <div class="bg-green-500" style="width: 25%"></div>
                        <div class="bg-cyan-500" style="width: 20%"></div>
                        <div class="bg-pink-500" style="width: 25%"></div>
                      </div>
                      <div class="grid grid-cols-2 gap-2 text-xs">
                        <div><p class="text-slate-400">Reach</p><p class="font-semibold text-slate-700">78%</p></div>
                        <div><p class="text-slate-400">Frequency</p><p class="font-semibold text-slate-700">2.8x</p></div>
                        <div><p class="text-slate-400">GRPs</p><p class="font-semibold text-slate-700">1,245</p></div>
                        <div><p class="text-slate-400">eCPM</p><p class="font-semibold text-slate-700">$18.50</p></div>
                      </div>
                    </div>
                    <div class="scenario-card bg-white border border-slate-200 rounded-xl p-4 cursor-pointer hover:border-purple-300 hover:bg-purple-50/30" onclick="selectScenario('b')">
                      <h4 class="font-semibold text-slate-800 mb-1">Scenario B</h4>
                      <p class="text-xs text-slate-500 mb-3">TV Heavy</p>
                      <div class="h-5 rounded overflow-hidden flex mb-3">
                        <div class="bg-purple-600" style="width: 50%"></div>
                        <div class="bg-green-500" style="width: 15%"></div>
                        <div class="bg-cyan-500" style="width: 15%"></div>
                        <div class="bg-pink-500" style="width: 20%"></div>
                      </div>
                      <div class="grid grid-cols-2 gap-2 text-xs">
                        <div><p class="text-slate-400">Reach</p><p class="font-semibold text-slate-700">82%</p></div>
                        <div><p class="text-slate-400">Frequency</p><p class="font-semibold text-slate-700">3.2x</p></div>
                        <div><p class="text-slate-400">GRPs</p><p class="font-semibold text-slate-700">1,380</p></div>
                        <div><p class="text-slate-400">eCPM</p><p class="font-semibold text-slate-700">$22.40</p></div>
                      </div>
                    </div>
                    <div class="scenario-card bg-white border border-slate-200 rounded-xl p-4 cursor-pointer hover:border-purple-300 hover:bg-purple-50/30" onclick="selectScenario('c')">
                      <h4 class="font-semibold text-slate-800 mb-1">Scenario C</h4>
                      <p class="text-xs text-slate-500 mb-3">Digital First</p>
                      <div class="h-5 rounded overflow-hidden flex mb-3">
                        <div class="bg-purple-600" style="width: 15%"></div>
                        <div class="bg-green-500" style="width: 20%"></div>
                        <div class="bg-cyan-500" style="width: 40%"></div>
                        <div class="bg-pink-500" style="width: 25%"></div>
                      </div>
                      <div class="grid grid-cols-2 gap-2 text-xs">
                        <div><p class="text-slate-400">Reach</p><p class="font-semibold text-slate-700">72%</p></div>
                        <div><p class="text-slate-400">Frequency</p><p class="font-semibold text-slate-700">4.5x</p></div>
                        <div><p class="text-slate-400">GRPs</p><p class="font-semibold text-slate-700">1,520</p></div>
                        <div><p class="text-slate-400">eCPM</p><p class="font-semibold text-slate-700">$12.80</p></div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Tab Content: Flighting -->
                <div class="budget-content hidden p-4" data-budget-content="flighting">
                  <div class="flex items-center justify-between mb-3">
                    <h4 class="font-medium text-slate-700 text-sm">Monthly Budget Flighting</h4>
                    <div class="flex items-center gap-2">
                      <button onclick="calcEvenFlighting()" class="px-2.5 py-1 text-[10px] bg-slate-100 text-slate-600 rounded-lg hover:bg-purple-100 hover:text-purple-700">Even Split</button>
                      <button onclick="calcFrontLoad()" class="px-2.5 py-1 text-[10px] bg-slate-100 text-slate-600 rounded-lg hover:bg-purple-100 hover:text-purple-700">Front Load</button>
                      <button onclick="calcPulse()" class="px-2.5 py-1 text-[10px] bg-slate-100 text-slate-600 rounded-lg hover:bg-purple-100 hover:text-purple-700">Pulse</button>
                    </div>
                  </div>
                  <div class="overflow-x-auto bg-white rounded-lg border border-slate-200" id="calcFlightingTable">
                    <p class="text-center text-slate-400 text-xs py-6">Add channels to see flighting table</p>
                  </div>
                </div>
              </div>

              <!-- Navigation -->
              <div class="flex justify-between p-4 bg-white border border-slate-200 rounded-xl shadow-sm">
                <button onclick="goToStep(4)" class="flex items-center gap-2 px-4 py-2 text-sm text-slate-600">
                  <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                  Back
                </button>
                <div class="flex items-center gap-2 text-sm text-slate-500">
                  <span class="w-5 h-5 rounded-full bg-green-100 text-green-600 flex items-center justify-center text-xs">
                    <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                  </span>
                  Ready to create plan
                </div>
                <button onclick="completePlanCreation()" class="px-6 py-2.5 lumos-gradient text-white text-sm font-medium rounded-xl flex items-center gap-2">
                  <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                  Create Plan
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

<!-- ==================== PLAN DETAIL VIEW ==================== -->
      <div class="screen h-full" data-screen="plan-detail">
        <!-- Plan Header -->
        <div class="bg-white border-b border-slate-200 px-6 py-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-4">
              <button onclick="showScreen('master-plans')" class="p-2 hover:bg-slate-100 rounded-lg">
                <svg class="w-5 h-5 text-slate-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
              </button>
              <div>
                <div class="flex items-center gap-3">
                  <h2 class="text-lg font-semibold text-slate-800">FMCG Brand 1 - Brand Awareness</h2>
                  <span class="px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full">Active</span>
                </div>
                <p class="text-sm text-slate-500">P18-54 • $12M Budget • 26 weeks</p>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <div class="flex -space-x-2">
                <div class="w-7 h-7 bg-gradient-to-br from-green-400 to-emerald-500 rounded-full flex items-center justify-center text-xs font-medium text-white border-2 border-white">EF</div>
                <div class="w-7 h-7 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-full flex items-center justify-center text-xs font-medium text-white border-2 border-white">JD</div>
              </div>
              <button class="px-4 py-2 text-sm text-slate-600 border border-slate-200 rounded-xl hover:bg-slate-100 flex items-center gap-2">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>Edit
              </button>
              <button class="px-4 py-2 text-sm text-slate-600 border border-slate-200 rounded-xl hover:bg-slate-100 flex items-center gap-2">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>Export
              </button>
              <button onclick="showPlanTab('partners')" class="px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-sm font-medium rounded-xl flex items-center gap-2 shadow-lg hover:shadow-xl transition-shadow">
                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>Activation
              </button>
            </div>
          </div>

          <!-- Tab Navigation -->
          <div class="flex gap-1 mt-4 -mb-4">
            <button onclick="showPlanTab('brief')" class="plan-tab active px-4 py-3 text-sm font-medium border-b-2 border-purple-600 text-purple-600" data-plan-tab="brief">Brief & Strategy</button>
            <button onclick="showPlanTab('dashboard')" class="plan-tab px-4 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700" data-plan-tab="dashboard">Performance</button>
            <button onclick="showPlanTab('channels')" class="plan-tab px-4 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700" data-plan-tab="channels">Channel Mix</button>
            <button onclick="showPlanTab('flighting')" class="plan-tab px-4 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700" data-plan-tab="flighting">Flighting & Calendar</button>
            <button onclick="showPlanTab('mapping')" class="plan-tab px-4 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700" data-plan-tab="mapping">Mapping</button>
            <button onclick="showPlanTab('partners')" class="plan-tab px-4 py-3 text-sm font-medium border-b-2 border-transparent text-slate-500 hover:text-slate-700" data-plan-tab="partners">Partners</button>
          </div>
        </div>

        <!-- Tab Content -->
        <div class="flex-1 overflow-auto bg-slate-50 p-6">
          <!-- ==================== BRIEF & STRATEGY TAB ==================== -->
          <div class="plan-content" data-plan-content="brief">
            <div class="space-y-6">
              <!-- Campaign Brief Summary -->
              <div class="bg-gradient-to-r from-purple-700 via-purple-600 to-pink-600 rounded-2xl p-8 text-white shadow-lg">
                <div class="flex items-start justify-between">
                  <div class="flex-1">
                    <p class="text-purple-200 text-sm font-medium mb-2">CAMPAIGN BRIEF</p>
                    <h2 class="text-3xl font-bold mb-4">Fresh Foods Brand Relaunch</h2>
                    <p class="text-purple-100 text-lg leading-relaxed max-w-2xl">Drive brand awareness and consideration for our premium fresh foods range among health-conscious families, positioning as the trusted choice for quality and nutrition.</p>
                  </div>
                  <div class="bg-white/20 backdrop-blur rounded-xl p-4 text-center">
                    <p class="text-purple-200 text-xs mb-1">Campaign Duration</p>
                    <p class="text-2xl font-bold">26 Weeks</p>
                    <p class="text-purple-200 text-xs mt-1">Jan - June 2026</p>
                  </div>
                </div>
                <div class="grid grid-cols-4 gap-4 mt-8">
                  <div class="bg-white/10 backdrop-blur rounded-xl p-4">
                    <p class="text-purple-200 text-xs mb-1">Total Investment</p>
                    <p class="text-2xl font-bold">$7.86M</p>
                  </div>
                  <div class="bg-white/10 backdrop-blur rounded-xl p-4">
                    <p class="text-purple-200 text-xs mb-1">Target Reach</p>
                    <p class="text-2xl font-bold">78%</p>
                  </div>
                  <div class="bg-white/10 backdrop-blur rounded-xl p-4">
                    <p class="text-purple-200 text-xs mb-1">Primary Demo</p>
                    <p class="text-2xl font-bold">P25-54</p>
                  </div>
                  <div class="bg-white/10 backdrop-blur rounded-xl p-4">
                    <p class="text-purple-200 text-xs mb-1">Markets</p>
                    <p class="text-2xl font-bold">National</p>
                  </div>
                </div>
              </div>

              <!-- Communications Architecture -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h3 class="font-semibold text-slate-800">Communications Architecture</h3>
                    <p class="text-sm text-slate-500 mt-1">Strategic framework aligning messaging, channels, and budget across the consumer journey</p>
                  </div>
                  <div class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-xs font-medium">Source: Comms Strategy Doc</div>
                </div>

                <div class="overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b-2 border-purple-200 bg-purple-50">
                        <th class="text-left py-3 px-4 font-semibold text-purple-800">Funnel Stage</th>
                        <th class="text-left py-3 px-4 font-semibold text-purple-800">Objective</th>
                        <th class="text-left py-3 px-4 font-semibold text-purple-800">Primary Channels</th>
                        <th class="text-left py-3 px-4 font-semibold text-purple-800">Key Messaging</th>
                        <th class="text-center py-3 px-4 font-semibold text-purple-800">Budget %</th>
                        <th class="text-right py-3 px-4 font-semibold text-purple-800">Investment</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100">
                        <td class="py-4 px-4">
                          <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-lg bg-purple-600 flex items-center justify-center">
                              <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                            </div>
                            <span class="font-semibold text-slate-800">Awareness</span>
                          </div>
                        </td>
                        <td class="py-4 px-4 text-slate-600">Build brand salience & familiarity</td>
                        <td class="py-4 px-4">
                          <div class="flex flex-wrap gap-1">
                            <span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded">FTA TV</span>
                            <span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded">BVOD</span>
                            <span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded">OOH</span>
                          </div>
                        </td>
                        <td class="py-4 px-4 text-slate-600 text-xs">"Premium quality for your family"</td>
                        <td class="py-4 px-4 text-center"><span class="text-lg font-bold text-purple-700">45%</span></td>
                        <td class="py-4 px-4 text-right font-bold text-purple-700">$3.54M</td>
                      </tr>
                      <tr class="border-b border-slate-100 bg-blue-50/30">
                        <td class="py-4 px-4">
                          <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-lg bg-blue-600 flex items-center justify-center">
                              <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                            </div>
                            <span class="font-semibold text-slate-800">Consideration</span>
                          </div>
                        </td>
                        <td class="py-4 px-4 text-slate-600">Drive product understanding & interest</td>
                        <td class="py-4 px-4">
                          <div class="flex flex-wrap gap-1">
                            <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded">Social</span>
                            <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded">YouTube</span>
                            <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded">Digital</span>
                          </div>
                        </td>
                        <td class="py-4 px-4 text-slate-600 text-xs">"See the difference in every bite"</td>
                        <td class="py-4 px-4 text-center"><span class="text-lg font-bold text-blue-700">30%</span></td>
                        <td class="py-4 px-4 text-right font-bold text-blue-700">$2.36M</td>
                      </tr>
                      <tr class="border-b border-slate-100">
                        <td class="py-4 px-4">
                          <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-lg bg-green-600 flex items-center justify-center">
                              <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
                            </div>
                            <span class="font-semibold text-slate-800">Conversion</span>
                          </div>
                        </td>
                        <td class="py-4 px-4 text-slate-600">Drive purchase at point of decision</td>
                        <td class="py-4 px-4">
                          <div class="flex flex-wrap gap-1">
                            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded">Retail Media</span>
                            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded">Search</span>
                            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded">Programmatic</span>
                          </div>
                        </td>
                        <td class="py-4 px-4 text-slate-600 text-xs">"Available now at your local store"</td>
                        <td class="py-4 px-4 text-center"><span class="text-lg font-bold text-green-700">20%</span></td>
                        <td class="py-4 px-4 text-right font-bold text-green-700">$1.57M</td>
                      </tr>
                      <tr class="bg-amber-50/30">
                        <td class="py-4 px-4">
                          <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-lg bg-amber-600 flex items-center justify-center">
                              <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                            </div>
                            <span class="font-semibold text-slate-800">Loyalty</span>
                          </div>
                        </td>
                        <td class="py-4 px-4 text-slate-600">Reinforce choice & encourage repeat</td>
                        <td class="py-4 px-4">
                          <div class="flex flex-wrap gap-1">
                            <span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded">CRM</span>
                            <span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded">Email</span>
                            <span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded">Social</span>
                          </div>
                        </td>
                        <td class="py-4 px-4 text-slate-600 text-xs">"Thank you for choosing quality"</td>
                        <td class="py-4 px-4 text-center"><span class="text-lg font-bold text-amber-700">5%</span></td>
                        <td class="py-4 px-4 text-right font-bold text-amber-700">$393K</td>
                      </tr>
                    </tbody>
                    <tfoot>
                      <tr class="border-t-2 border-purple-200 bg-purple-100">
                        <td colspan="4" class="py-3 px-4 font-bold text-slate-800">Total Campaign Investment</td>
                        <td class="py-3 px-4 text-center font-bold text-purple-800">100%</td>
                        <td class="py-3 px-4 text-right font-bold text-purple-800">$7.86M</td>
                      </tr>
                    </tfoot>
                  </table>
                </div>
              </div>

              <!-- Goal Setting & Measurement Framework -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h3 class="font-semibold text-slate-800">Goal Setting & Measurement Framework</h3>
                    <p class="text-sm text-slate-500 mt-1">Quantified objectives and KPIs with measurement methodology</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <div class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1">
                      <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                      Goals Aligned
                    </div>
                    <div class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-medium">MMM Integrated</div>
                  </div>
                </div>

                <div class="grid grid-cols-2 gap-6">
                  <!-- Business Goals -->
                  <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 border border-purple-200">
                    <h4 class="font-semibold text-purple-800 mb-4 flex items-center gap-2">
                      <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                      Business Goals
                    </h4>
                    <div class="space-y-4">
                      <div class="bg-white rounded-lg p-4 border border-purple-200">
                        <div class="flex justify-between items-center mb-2">
                          <span class="text-sm font-medium text-slate-700">Revenue Growth</span>
                          <span class="text-lg font-bold text-purple-700">+12%</span>
                        </div>
                        <div class="w-full bg-purple-200 rounded-full h-2">
                          <div class="bg-purple-600 h-2 rounded-full" style="width: 65%"></div>
                        </div>
                        <p class="text-[10px] text-slate-500 mt-2">Target: $48M → $53.8M by Q4 2026</p>
                      </div>
                      <div class="bg-white rounded-lg p-4 border border-purple-200">
                        <div class="flex justify-between items-center mb-2">
                          <span class="text-sm font-medium text-slate-700">Market Share</span>
                          <span class="text-lg font-bold text-purple-700">+2.5pts</span>
                        </div>
                        <div class="w-full bg-purple-200 rounded-full h-2">
                          <div class="bg-purple-600 h-2 rounded-full" style="width: 45%"></div>
                        </div>
                        <p class="text-[10px] text-slate-500 mt-2">Target: 18% → 20.5% category share</p>
                      </div>
                    </div>
                  </div>

                  <!-- Brand Goals -->
                  <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5 border border-blue-200">
                    <h4 class="font-semibold text-blue-800 mb-4 flex items-center gap-2">
                      <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                      Brand Goals
                    </h4>
                    <div class="space-y-4">
                      <div class="bg-white rounded-lg p-4 border border-blue-200">
                        <div class="flex justify-between items-center mb-2">
                          <span class="text-sm font-medium text-slate-700">Brand Awareness</span>
                          <span class="text-lg font-bold text-blue-700">+5pts</span>
                        </div>
                        <div class="w-full bg-blue-200 rounded-full h-2">
                          <div class="bg-blue-600 h-2 rounded-full" style="width: 72%"></div>
                        </div>
                        <p class="text-[10px] text-slate-500 mt-2">Target: 72% → 77% aided awareness</p>
                      </div>
                      <div class="bg-white rounded-lg p-4 border border-blue-200">
                        <div class="flex justify-between items-center mb-2">
                          <span class="text-sm font-medium text-slate-700">Consideration</span>
                          <span class="text-lg font-bold text-blue-700">+8pts</span>
                        </div>
                        <div class="w-full bg-blue-200 rounded-full h-2">
                          <div class="bg-blue-600 h-2 rounded-full" style="width: 45%"></div>
                        </div>
                        <p class="text-[10px] text-slate-500 mt-2">Target: 45% → 53% consideration</p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Measurement Framework Table -->
                <div class="mt-6 overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b-2 border-slate-200 bg-slate-50">
                        <th class="text-left py-3 px-4 font-semibold text-slate-700">KPI</th>
                        <th class="text-left py-3 px-4 font-semibold text-slate-700">Data Source</th>
                        <th class="text-center py-3 px-4 font-semibold text-slate-700">Baseline</th>
                        <th class="text-center py-3 px-4 font-semibold text-slate-700">Target</th>
                        <th class="text-left py-3 px-4 font-semibold text-slate-700">Measurement Window</th>
                        <th class="text-center py-3 px-4 font-semibold text-slate-700">Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100">
                        <td class="py-3 px-4 font-medium text-slate-800">Brand Awareness</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded">YouGov BrandIndex</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">72%</td>
                        <td class="py-3 px-4 text-center font-bold text-green-600">77%</td>
                        <td class="py-3 px-4 text-slate-500 text-xs">Monthly tracking, 4-week rolling avg</td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded-full">Tracking</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 bg-slate-50/50">
                        <td class="py-3 px-4 font-medium text-slate-800">Consideration</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded">FiftyFive5</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">45%</td>
                        <td class="py-3 px-4 text-center font-bold text-green-600">53%</td>
                        <td class="py-3 px-4 text-slate-500 text-xs">Quarterly brand health study</td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded-full">Tracking</span></td>
                      </tr>
                      <tr class="border-b border-slate-100">
                        <td class="py-3 px-4 font-medium text-slate-800">1+ Reach</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded">VOZ/OzTAM</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">62%</td>
                        <td class="py-3 px-4 text-center font-bold text-green-600">78%</td>
                        <td class="py-3 px-4 text-slate-500 text-xs">Campaign flight period</td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">On Track</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 bg-slate-50/50">
                        <td class="py-3 px-4 font-medium text-slate-800">ROAS</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded">MMM Model</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">2.8x</td>
                        <td class="py-3 px-4 text-center font-bold text-green-600">3.2x</td>
                        <td class="py-3 px-4 text-slate-500 text-xs">Post-campaign analysis (8 weeks)</td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded-full">Pending</span></td>
                      </tr>
                      <tr class="border-b border-slate-100">
                        <td class="py-3 px-4 font-medium text-slate-800">Incremental Sales</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded">Nielsen Scan</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">-</td>
                        <td class="py-3 px-4 text-center font-bold text-green-600">+$4.2M</td>
                        <td class="py-3 px-4 text-slate-500 text-xs">Weekly sales lift analysis</td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded-full">Pending</span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Target Audience Visual Section -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Target Audience</h3>
                <div class="grid grid-cols-3 gap-6">
                  <!-- Audience Visual 1 -->
                  <div class="relative group">
                    <div class="aspect-video bg-gradient-to-br from-amber-100 to-orange-200 rounded-xl overflow-hidden">
                      <svg class="w-full h-full" viewBox="0 0 400 225">
                        <!-- Family grocery shopping scene -->
                        <rect fill="#fef3c7" width="400" height="225"/>
                        <rect fill="#f59e0b" x="0" y="180" width="400" height="45" opacity="0.3"/>
                        <!-- Shopping cart -->
                        <ellipse cx="200" cy="140" rx="50" ry="35" fill="#6b7280"/>
                        <rect x="160" y="110" width="80" height="50" rx="5" fill="#9ca3af"/>
                        <circle cx="170" cy="165" r="12" fill="#374151"/>
                        <circle cx="230" cy="165" r="12" fill="#374151"/>
                        <!-- Fresh produce in cart -->
                        <circle cx="180" cy="125" r="12" fill="#ef4444"/>
                        <circle cx="200" cy="120" r="10" fill="#22c55e"/>
                        <circle cx="220" cy="125" r="11" fill="#f97316"/>
                        <!-- Person silhouettes -->
                        <circle cx="120" cy="80" r="20" fill="#7c3aed"/>
                        <rect x="105" y="100" width="30" height="60" rx="5" fill="#7c3aed"/>
                        <circle cx="280" cy="85" r="15" fill="#ec4899"/>
                        <rect x="268" y="100" width="24" height="50" rx="4" fill="#ec4899"/>
                        <!-- Small child -->
                        <circle cx="150" cy="120" r="12" fill="#06b6d4"/>
                        <rect x="142" y="132" width="16" height="35" rx="3" fill="#06b6d4"/>
                      </svg>
                    </div>
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent rounded-xl flex items-end">
                      <div class="p-4 text-white">
                        <p class="font-semibold">Family Shoppers</p>
                        <p class="text-xs text-white/80">Weekly grocery decision makers</p>
                      </div>
                    </div>
                  </div>
                  <!-- Audience Visual 2 -->
                  <div class="relative group">
                    <div class="aspect-video bg-gradient-to-br from-blue-100 to-cyan-200 rounded-xl overflow-hidden">
                      <svg class="w-full h-full" viewBox="0 0 400 225">
                        <!-- Urban commuter scene -->
                        <rect fill="#e0f2fe" width="400" height="225"/>
                        <!-- Buildings -->
                        <rect fill="#64748b" x="20" y="60" width="60" height="165"/>
                        <rect fill="#475569" x="90" y="40" width="50" height="185"/>
                        <rect fill="#64748b" x="150" y="80" width="70" height="145"/>
                        <rect fill="#475569" x="260" y="50" width="55" height="175"/>
                        <rect fill="#64748b" x="325" y="70" width="75" height="155"/>
                        <!-- Windows -->
                        <rect fill="#fef08a" x="30" y="70" width="15" height="15" opacity="0.6"/>
                        <rect fill="#fef08a" x="55" y="90" width="15" height="15" opacity="0.6"/>
                        <rect fill="#fef08a" x="100" y="60" width="12" height="12" opacity="0.6"/>
                        <rect fill="#fef08a" x="120" y="80" width="12" height="12" opacity="0.6"/>
                        <!-- Person with phone -->
                        <circle cx="200" cy="130" r="22" fill="#7c3aed"/>
                        <rect x="185" y="152" width="30" height="55" rx="5" fill="#7c3aed"/>
                        <rect x="220" y="145" width="8" height="15" rx="2" fill="#1f2937"/>
                        <!-- Street -->
                        <rect fill="#374151" x="0" y="200" width="400" height="25"/>
                      </svg>
                    </div>
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent rounded-xl flex items-end">
                      <div class="p-4 text-white">
                        <p class="font-semibold">Urban Professionals</p>
                        <p class="text-xs text-white/80">Health-conscious, time-poor</p>
                      </div>
                    </div>
                  </div>
                  <!-- Audience Visual 3 -->
                  <div class="relative group">
                    <div class="aspect-video bg-gradient-to-br from-green-100 to-emerald-200 rounded-xl overflow-hidden">
                      <svg class="w-full h-full" viewBox="0 0 400 225">
                        <!-- Healthy lifestyle scene -->
                        <rect fill="#dcfce7" width="400" height="225"/>
                        <!-- Sun -->
                        <circle cx="350" cy="40" r="25" fill="#fbbf24"/>
                        <!-- Trees -->
                        <rect fill="#854d0e" x="50" y="140" width="15" height="60"/>
                        <circle cx="57" cy="120" r="35" fill="#22c55e"/>
                        <rect fill="#854d0e" x="320" y="150" width="12" height="50"/>
                        <circle cx="326" cy="130" r="30" fill="#16a34a"/>
                        <!-- Person jogging -->
                        <circle cx="180" cy="130" r="18" fill="#ec4899"/>
                        <rect x="168" y="148" width="24" height="45" rx="4" fill="#ec4899"/>
                        <rect x="150" y="160" width="20" height="8" rx="2" fill="#ec4899" transform="rotate(-20 150 160)"/>
                        <!-- Healthy food plate -->
                        <ellipse cx="280" cy="170" rx="40" ry="25" fill="#f1f5f9"/>
                        <circle cx="270" cy="165" r="10" fill="#ef4444"/>
                        <circle cx="290" cy="162" r="8" fill="#22c55e"/>
                        <circle cx="280" cy="175" r="7" fill="#f97316"/>
                        <!-- Ground -->
                        <rect fill="#86efac" x="0" y="195" width="400" height="30"/>
                      </svg>
                    </div>
                    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent rounded-xl flex items-end">
                      <div class="p-4 text-white">
                        <p class="font-semibold">Active Lifestylers</p>
                        <p class="text-xs text-white/80">Wellness-focused consumers</p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="grid grid-cols-3 gap-4 mt-4">
                  <div class="bg-purple-50 rounded-lg p-4 text-center">
                    <p class="text-2xl font-bold text-purple-700">4.2M</p>
                    <p class="text-xs text-slate-600">Primary Audience Size</p>
                  </div>
                  <div class="bg-purple-50 rounded-lg p-4 text-center">
                    <p class="text-2xl font-bold text-purple-700">$80K+</p>
                    <p class="text-xs text-slate-600">Household Income</p>
                  </div>
                  <div class="bg-purple-50 rounded-lg p-4 text-center">
                    <p class="text-2xl font-bold text-purple-700">25-54</p>
                    <p class="text-xs text-slate-600">Core Age Range</p>
                  </div>
                </div>
              </div>

              <!-- Execution Strategy -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Execution Strategy</h3>
                <div class="grid grid-cols-3 gap-6">
                  <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 border border-purple-200">
                    <div class="w-12 h-12 rounded-xl bg-purple-600 flex items-center justify-center mb-4">
                      <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg>
                    </div>
                    <h4 class="font-semibold text-purple-800 mb-2">Brand Building</h4>
                    <p class="text-sm text-slate-600 mb-4">Establish emotional connection through premium video content across TV and BVOD environments.</p>
                    <div class="space-y-2">
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-purple-500"></div>
                        <span>30s hero creative on FTA TV</span>
                      </div>
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-purple-500"></div>
                        <span>15s cutdowns for BVOD</span>
                      </div>
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-purple-500"></div>
                        <span>Large format OOH presence</span>
                      </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-purple-200">
                      <p class="text-xs text-purple-600 font-medium">45% of Budget</p>
                      <p class="text-lg font-bold text-purple-800">$3.54M</p>
                    </div>
                  </div>
                  <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5 border border-blue-200">
                    <div class="w-12 h-12 rounded-xl bg-blue-600 flex items-center justify-center mb-4">
                      <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    </div>
                    <h4 class="font-semibold text-blue-800 mb-2">Engagement</h4>
                    <p class="text-sm text-slate-600 mb-4">Drive consideration through targeted social and digital content that demonstrates product benefits.</p>
                    <div class="space-y-2">
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-blue-500"></div>
                        <span>Social video & stories</span>
                      </div>
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-blue-500"></div>
                        <span>Influencer partnerships</span>
                      </div>
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-blue-500"></div>
                        <span>Recipe content series</span>
                      </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-blue-200">
                      <p class="text-xs text-blue-600 font-medium">30% of Budget</p>
                      <p class="text-lg font-bold text-blue-800">$2.36M</p>
                    </div>
                  </div>
                  <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-5 border border-green-200">
                    <div class="w-12 h-12 rounded-xl bg-green-600 flex items-center justify-center mb-4">
                      <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
                    </div>
                    <h4 class="font-semibold text-green-800 mb-2">Conversion</h4>
                    <p class="text-sm text-slate-600 mb-4">Drive purchase through retail media and programmatic targeting at key shopping moments.</p>
                    <div class="space-y-2">
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        <span>Retail media placements</span>
                      </div>
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        <span>Programmatic retargeting</span>
                      </div>
                      <div class="flex items-center gap-2 text-xs text-slate-500">
                        <div class="w-2 h-2 rounded-full bg-green-500"></div>
                        <span>Search & shopping ads</span>
                      </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-green-200">
                      <p class="text-xs text-green-600 font-medium">25% of Budget</p>
                      <p class="text-lg font-bold text-green-800">$1.96M</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Media Environment & Publisher Partners -->
              <div class="grid grid-cols-2 gap-6">
                <!-- Media Environments with Budget -->
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <h3 class="font-semibold text-slate-800 mb-4">Media Environments</h3>
                  <div class="grid grid-cols-2 gap-3">
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 border border-purple-200">
                      <div class="flex items-center justify-between mb-2">
                        <div class="w-10 h-10 rounded-lg bg-purple-600 flex items-center justify-center">
                          <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2"/><polyline points="17 2 12 7 7 2"/></svg>
                        </div>
                        <span class="text-xs font-bold text-purple-700 bg-purple-200 px-2 py-1 rounded-full">35%</span>
                      </div>
                      <p class="font-semibold text-sm text-slate-800">Premium TV</p>
                      <p class="text-[10px] text-slate-500">Prime-time entertainment</p>
                      <p class="text-sm font-bold text-purple-700 mt-2">$2.75M</p>
                    </div>
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200">
                      <div class="flex items-center justify-between mb-2">
                        <div class="w-10 h-10 rounded-lg bg-blue-500 flex items-center justify-center">
                          <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg>
                        </div>
                        <span class="text-xs font-bold text-blue-700 bg-blue-200 px-2 py-1 rounded-full">22%</span>
                      </div>
                      <p class="font-semibold text-sm text-slate-800">Social & Mobile</p>
                      <p class="text-[10px] text-slate-500">Feed & stories placements</p>
                      <p class="text-sm font-bold text-blue-700 mt-2">$1.73M</p>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border border-green-200">
                      <div class="flex items-center justify-between mb-2">
                        <div class="w-10 h-10 rounded-lg bg-green-500 flex items-center justify-center">
                          <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
                        </div>
                        <span class="text-xs font-bold text-green-700 bg-green-200 px-2 py-1 rounded-full">25%</span>
                      </div>
                      <p class="font-semibold text-sm text-slate-800">Out of Home</p>
                      <p class="text-[10px] text-slate-500">High-traffic locations</p>
                      <p class="text-sm font-bold text-green-700 mt-2">$1.97M</p>
                    </div>
                    <div class="bg-gradient-to-br from-pink-50 to-pink-100 rounded-xl p-4 border border-pink-200">
                      <div class="flex items-center justify-between mb-2">
                        <div class="w-10 h-10 rounded-lg bg-pink-500 flex items-center justify-center">
                          <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg>
                        </div>
                        <span class="text-xs font-bold text-pink-700 bg-pink-200 px-2 py-1 rounded-full">18%</span>
                      </div>
                      <p class="font-semibold text-sm text-slate-800">Streaming VOD</p>
                      <p class="text-[10px] text-slate-500">BVOD & AVOD platforms</p>
                      <p class="text-sm font-bold text-pink-700 mt-2">$1.41M</p>
                    </div>
                  </div>
                </div>

                <!-- Publisher Partners -->
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <h3 class="font-semibold text-slate-800 mb-4">Publisher Partners</h3>
                  <div class="space-y-3">
                    <div class="bg-purple-50 rounded-xl p-3">
                      <p class="text-[10px] text-purple-600 font-medium mb-2">BROADCAST & STREAMING</p>
                      <div class="flex items-center gap-2 flex-wrap">
                        <div class="bg-white rounded px-2 py-1 border border-purple-200 text-xs font-bold text-slate-700">Nine</div>
                        <div class="bg-white rounded px-2 py-1 border border-purple-200 text-xs font-bold text-slate-700">Seven</div>
                        <div class="bg-white rounded px-2 py-1 border border-purple-200 text-xs font-bold text-slate-700">Ten</div>
                        <div class="bg-white rounded px-2 py-1 border border-purple-200 text-xs font-bold text-slate-700">Foxtel</div>
                        <div class="bg-white rounded px-2 py-1 border border-purple-200 text-xs font-bold text-slate-700">SBS</div>
                      </div>
                    </div>
                    <div class="bg-blue-50 rounded-xl p-3">
                      <p class="text-[10px] text-blue-600 font-medium mb-2">DIGITAL & SOCIAL</p>
                      <div class="flex items-center gap-2 flex-wrap">
                        <div class="bg-white rounded px-2 py-1 border border-blue-200 text-xs font-bold text-slate-700">Meta</div>
                        <div class="bg-white rounded px-2 py-1 border border-blue-200 text-xs font-bold text-slate-700">Google</div>
                        <div class="bg-white rounded px-2 py-1 border border-blue-200 text-xs font-bold text-slate-700">TikTok</div>
                        <div class="bg-white rounded px-2 py-1 border border-blue-200 text-xs font-bold text-slate-700">News Corp</div>
                      </div>
                    </div>
                    <div class="bg-green-50 rounded-xl p-3">
                      <p class="text-[10px] text-green-600 font-medium mb-2">OUT OF HOME</p>
                      <div class="flex items-center gap-2 flex-wrap">
                        <div class="bg-white rounded px-2 py-1 border border-green-200 text-xs font-bold text-slate-700">oOh!media</div>
                        <div class="bg-white rounded px-2 py-1 border border-green-200 text-xs font-bold text-slate-700">JCDecaux</div>
                        <div class="bg-white rounded px-2 py-1 border border-green-200 text-xs font-bold text-slate-700">QMS</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Activation Process & DeltaX Integration -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h3 class="font-semibold text-slate-800">Activation Process</h3>
                    <p class="text-sm text-slate-500">End-to-end media activation workflow with DeltaX integration</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <div class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1">
                      <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                      Connected
                    </div>
                    <div class="bg-gradient-to-r from-blue-600 to-cyan-500 text-white px-3 py-1.5 rounded-lg text-xs font-bold">DeltaX</div>
                  </div>
                </div>

                <!-- Process Flow -->
                <div class="relative">
                  <div class="absolute top-8 left-0 right-0 h-1 bg-gradient-to-r from-purple-200 via-blue-200 to-green-200 rounded-full"></div>
                  <div class="grid grid-cols-5 gap-4 relative">
                    <!-- Step 1 -->
                    <div class="flex flex-col items-center">
                      <div class="w-16 h-16 rounded-xl bg-purple-600 flex items-center justify-center mb-3 shadow-lg z-10">
                        <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                      </div>
                      <p class="text-xs font-semibold text-slate-800 text-center">Plan Approval</p>
                      <p class="text-[10px] text-slate-500 text-center mt-1">Media plan finalized</p>
                      <div class="mt-2 text-[10px] text-green-600 font-medium">✓ Complete</div>
                    </div>
                    <!-- Step 2 -->
                    <div class="flex flex-col items-center">
                      <div class="w-16 h-16 rounded-xl bg-blue-600 flex items-center justify-center mb-3 shadow-lg z-10">
                        <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
                      </div>
                      <p class="text-xs font-semibold text-slate-800 text-center">Publisher Briefs</p>
                      <p class="text-[10px] text-slate-500 text-center mt-1">Auto-generated specs</p>
                      <div class="mt-2 text-[10px] text-green-600 font-medium">✓ Complete</div>
                    </div>
                    <!-- Step 3 -->
                    <div class="flex flex-col items-center">
                      <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-blue-600 to-cyan-500 flex items-center justify-center mb-3 shadow-lg z-10 ring-4 ring-cyan-200">
                        <span class="text-white font-bold text-lg">Δ</span>
                      </div>
                      <p class="text-xs font-semibold text-slate-800 text-center">DeltaX Sync</p>
                      <p class="text-[10px] text-slate-500 text-center mt-1">Campaign setup</p>
                      <div class="mt-2 text-[10px] text-blue-600 font-medium animate-pulse">● In Progress</div>
                    </div>
                    <!-- Step 4 -->
                    <div class="flex flex-col items-center">
                      <div class="w-16 h-16 rounded-xl bg-slate-300 flex items-center justify-center mb-3 shadow-lg z-10">
                        <svg class="w-8 h-8 text-slate-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg>
                      </div>
                      <p class="text-xs font-semibold text-slate-800 text-center">Go Live</p>
                      <p class="text-[10px] text-slate-500 text-center mt-1">Campaign launch</p>
                      <div class="mt-2 text-[10px] text-slate-400 font-medium">Pending</div>
                    </div>
                    <!-- Step 5 -->
                    <div class="flex flex-col items-center">
                      <div class="w-16 h-16 rounded-xl bg-slate-300 flex items-center justify-center mb-3 shadow-lg z-10">
                        <svg class="w-8 h-8 text-slate-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>
                      </div>
                      <p class="text-xs font-semibold text-slate-800 text-center">Reporting</p>
                      <p class="text-[10px] text-slate-500 text-center mt-1">Performance tracking</p>
                      <div class="mt-2 text-[10px] text-slate-400 font-medium">Pending</div>
                    </div>
                  </div>
                </div>

                <!-- DeltaX Integration Details -->
                <div class="mt-6 grid grid-cols-3 gap-4">
                  <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
                    <div class="flex items-center gap-2 mb-2">
                      <div class="w-6 h-6 rounded bg-blue-100 flex items-center justify-center">
                        <svg class="w-3 h-3 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                      </div>
                      <p class="text-xs font-semibold text-slate-800">Export to DeltaX</p>
                    </div>
                    <p class="text-[10px] text-slate-500">Automated campaign setup with IO specs, targeting, and creative assignments</p>
                  </div>
                  <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
                    <div class="flex items-center gap-2 mb-2">
                      <div class="w-6 h-6 rounded bg-green-100 flex items-center justify-center">
                        <svg class="w-3 h-3 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                      </div>
                      <p class="text-xs font-semibold text-slate-800">Real-time Sync</p>
                    </div>
                    <p class="text-[10px] text-slate-500">Pacing, delivery, and spend data synced back to Lumos dashboard</p>
                  </div>
                  <div class="bg-slate-50 rounded-xl p-4 border border-slate-100">
                    <div class="flex items-center gap-2 mb-2">
                      <div class="w-6 h-6 rounded bg-purple-100 flex items-center justify-center">
                        <svg class="w-3 h-3 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                      </div>
                      <p class="text-xs font-semibold text-slate-800">Publisher Briefs</p>
                    </div>
                    <p class="text-[10px] text-slate-500">Auto-generated media specs and IO documents for each publisher</p>
                  </div>
                </div>
              </div>

              <!-- Key Messages & Creative Direction -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-4">Key Messages</h3>
                <div class="grid grid-cols-3 gap-4">
                  <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-5 border border-amber-200">
                    <div class="w-10 h-10 rounded-full bg-amber-500 flex items-center justify-center mb-3">
                      <span class="text-white font-bold">1</span>
                    </div>
                    <h4 class="font-semibold text-amber-800 mb-2">Quality Promise</h4>
                    <p class="text-sm text-slate-600">"Premium ingredients your family deserves - sourced fresh, delivered with care"</p>
                  </div>
                  <div class="bg-gradient-to-br from-emerald-50 to-green-50 rounded-xl p-5 border border-emerald-200">
                    <div class="w-10 h-10 rounded-full bg-emerald-500 flex items-center justify-center mb-3">
                      <span class="text-white font-bold">2</span>
                    </div>
                    <h4 class="font-semibold text-emerald-800 mb-2">Health Focus</h4>
                    <p class="text-sm text-slate-600">"Nourish your family with nature's best - no compromises, just goodness"</p>
                  </div>
                  <div class="bg-gradient-to-br from-sky-50 to-blue-50 rounded-xl p-5 border border-sky-200">
                    <div class="w-10 h-10 rounded-full bg-sky-500 flex items-center justify-center mb-3">
                      <span class="text-white font-bold">3</span>
                    </div>
                    <h4 class="font-semibold text-sky-800 mb-2">Trust & Heritage</h4>
                    <p class="text-sm text-slate-600">"Trusted by Australian families for generations - quality you can taste"</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== PERFORMANCE TAB (was Dashboard) ==================== -->
          <div class="plan-content hidden" data-plan-content="dashboard">
            <div class="space-y-6">
              <!-- KPI Summary Row -->
              <div class="grid grid-cols-6 gap-3">
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-slate-500 text-xs">Total Budget</span>
                    <div class="w-7 h-7 bg-blue-100 rounded-lg flex items-center justify-center"><svg class="w-3.5 h-3.5 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
                  </div>
                  <p class="text-xl font-bold text-slate-800">$12.0M</p>
                  <p class="text-[10px] text-slate-400 mt-0.5">FY 2026</p>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-slate-500 text-xs">Planned Spend</span>
                    <div class="w-7 h-7 bg-green-100 rounded-lg flex items-center justify-center"><svg class="w-3.5 h-3.5 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg></div>
                  </div>
                  <p class="text-xl font-bold text-slate-800">$7.86M</p>
                  <p class="text-[10px] text-green-600 mt-0.5">65.5% allocated</p>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-slate-500 text-xs">Total Reach</span>
                    <div class="w-7 h-7 bg-purple-100 rounded-lg flex items-center justify-center"><svg class="w-3.5 h-3.5 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg></div>
                  </div>
                  <p class="text-xl font-bold text-slate-800">78%</p>
                  <p class="text-[10px] text-slate-400 mt-0.5">P18-54 demo</p>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-slate-500 text-xs">Avg Frequency</span>
                    <div class="w-7 h-7 bg-pink-100 rounded-lg flex items-center justify-center"><svg class="w-3.5 h-3.5 text-pink-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg></div>
                  </div>
                  <p class="text-xl font-bold text-slate-800">2.8x</p>
                  <p class="text-[10px] text-slate-400 mt-0.5">OTS avg</p>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-slate-500 text-xs">Total GRPs</span>
                    <div class="w-7 h-7 bg-amber-100 rounded-lg flex items-center justify-center"><svg class="w-3.5 h-3.5 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg></div>
                  </div>
                  <p class="text-xl font-bold text-slate-800">1,245</p>
                  <p class="text-[10px] text-slate-400 mt-0.5">Gross rating pts</p>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-slate-500 text-xs">Est. Impressions</span>
                    <div class="w-7 h-7 bg-cyan-100 rounded-lg flex items-center justify-center"><svg class="w-3.5 h-3.5 text-cyan-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/></svg></div>
                  </div>
                  <p class="text-xl font-bold text-slate-800">676.7M</p>
                  <p class="text-[10px] text-slate-400 mt-0.5">Total impressions</p>
                </div>
              </div>

              <!-- Animated Channel Mix Performance Simulation - Lumos vs Traditional vs Competitor -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-5">
                  <div>
                    <h3 class="font-semibold text-slate-800">Omni-Channel Planning Performance Simulation</h3>
                    <p class="text-sm text-slate-500">Comparing Lumos optimised flighting vs traditional media buying and category benchmarks</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <button onclick="restartSimulation()" class="px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 flex items-center gap-1">
                      <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/></svg>
                      Replay Simulation
                    </button>
                  </div>
                </div>

                <div class="grid grid-cols-5 gap-6">
                  <!-- Animated Race Chart -->
                  <div class="col-span-3">
                    <h4 class="text-sm font-medium text-slate-700 mb-3">Time to Goal Achievement (Animated)</h4>
                    <div class="relative h-64 bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200 overflow-hidden">
                      <!-- Goal Line -->
                      <div class="absolute right-12 top-4 bottom-16 w-px bg-green-500 z-10"></div>
                      <div class="absolute right-4 top-4 text-[10px] text-green-600 font-medium">GOAL<br/>78% Reach</div>

                      <!-- Week labels -->
                      <div class="absolute bottom-2 left-16 right-16 flex justify-between text-[9px] text-slate-400">
                        <span>Wk0</span><span>Wk4</span><span>Wk8</span><span>Wk12</span><span>Wk16</span><span>Wk20</span><span>Wk24</span>
                      </div>

                      <!-- Racing Lines Container -->
                      <div class="absolute left-16 right-16 top-6 bottom-12 flex flex-col justify-around">
                        <!-- Lumos Optimised Line -->
                        <div class="relative h-12">
                          <div class="absolute left-0 top-1/2 -translate-y-1/2 w-8 text-[9px] text-purple-700 font-medium -ml-2">Lumos</div>
                          <div class="absolute left-8 right-0 top-1/2 -translate-y-1/2 h-2 bg-slate-200 rounded-full overflow-hidden">
                            <div class="lumos-race-bar h-full bg-gradient-to-r from-purple-600 to-purple-400 rounded-full transition-all duration-1000" style="width: 0%"></div>
                          </div>
                          <div class="lumos-marker absolute top-1/2 -translate-y-1/2 w-6 h-6 bg-purple-600 rounded-full shadow-lg flex items-center justify-center text-white text-[8px] font-bold transition-all duration-1000" style="left: 8%">
                            <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none"><ellipse cx="12" cy="12" rx="8" ry="5" stroke="currentColor" stroke-width="2" fill="none"/><circle cx="12" cy="12" r="2" fill="currentColor"/></svg>
                          </div>
                          <div class="lumos-reach-label absolute top-0 text-[10px] font-bold text-purple-700 transition-all duration-1000" style="left: 8%">0%</div>
                        </div>

                        <!-- Traditional Planning Line -->
                        <div class="relative h-12">
                          <div class="absolute left-0 top-1/2 -translate-y-1/2 w-8 text-[9px] text-slate-600 font-medium -ml-2">Trad.</div>
                          <div class="absolute left-8 right-0 top-1/2 -translate-y-1/2 h-2 bg-slate-200 rounded-full overflow-hidden">
                            <div class="trad-race-bar h-full bg-gradient-to-r from-slate-500 to-slate-400 rounded-full transition-all duration-1000" style="width: 0%"></div>
                          </div>
                          <div class="trad-marker absolute top-1/2 -translate-y-1/2 w-5 h-5 bg-slate-500 rounded-full shadow flex items-center justify-center text-white text-[8px] font-bold transition-all duration-1000" style="left: 8%">T</div>
                          <div class="trad-reach-label absolute top-0 text-[10px] font-bold text-slate-600 transition-all duration-1000" style="left: 8%">0%</div>
                        </div>

                        <!-- Competitor Benchmark Line -->
                        <div class="relative h-12">
                          <div class="absolute left-0 top-1/2 -translate-y-1/2 w-8 text-[9px] text-amber-600 font-medium -ml-2">Comp.</div>
                          <div class="absolute left-8 right-0 top-1/2 -translate-y-1/2 h-2 bg-slate-200 rounded-full overflow-hidden">
                            <div class="comp-race-bar h-full bg-gradient-to-r from-amber-500 to-amber-400 rounded-full transition-all duration-1000" style="width: 0%"></div>
                          </div>
                          <div class="comp-marker absolute top-1/2 -translate-y-1/2 w-5 h-5 bg-amber-500 rounded-full shadow flex items-center justify-center text-white text-[8px] font-bold transition-all duration-1000" style="left: 8%">C</div>
                          <div class="comp-reach-label absolute top-0 text-[10px] font-bold text-amber-600 transition-all duration-1000" style="left: 8%">0%</div>
                        </div>
                      </div>

                      <!-- Winner Badge (hidden initially) -->
                      <div id="winnerBadge" class="absolute top-4 left-1/2 -translate-x-1/2 px-4 py-2 bg-green-500 text-white text-sm font-bold rounded-full shadow-lg opacity-0 transition-opacity duration-500">
                        🏆 Lumos Reaches Goal 35% Faster!
                      </div>
                    </div>
                  </div>

                  <!-- Performance Comparison Cards -->
                  <div class="col-span-2">
                    <h4 class="text-sm font-medium text-slate-700 mb-3">Final Performance Comparison</h4>
                    <div class="space-y-3">
                      <!-- Lumos Card -->
                      <div class="bg-gradient-to-r from-purple-50 to-purple-100 rounded-xl p-4 border-2 border-purple-300 relative overflow-hidden">
                        <div class="absolute top-2 right-2 px-2 py-0.5 bg-purple-600 text-white text-[9px] font-bold rounded-full">WINNER</div>
                        <div class="flex items-center gap-3 mb-2">
                          <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center">
                            <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none"><ellipse cx="12" cy="12" rx="8" ry="5" stroke="currentColor" stroke-width="2" fill="none"/><circle cx="12" cy="12" r="2" fill="currentColor"/></svg>
                          </div>
                          <div>
                            <p class="text-sm font-bold text-purple-800">Lumos Optimised</p>
                            <p class="text-[10px] text-purple-600">Omni-channel planning</p>
                          </div>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center">
                          <div><p class="text-lg font-bold text-purple-700">78%</p><p class="text-[9px] text-slate-600">Reach</p></div>
                          <div><p class="text-lg font-bold text-purple-700">16 wk</p><p class="text-[9px] text-slate-600">Time to Goal</p></div>
                          <div><p class="text-lg font-bold text-green-600">3.2x</p><p class="text-[9px] text-slate-600">ROAS</p></div>
                        </div>
                      </div>

                      <!-- Traditional Card -->
                      <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                        <div class="flex items-center gap-3 mb-2">
                          <div class="w-8 h-8 bg-slate-500 rounded-lg flex items-center justify-center text-white text-xs font-bold">T</div>
                          <div>
                            <p class="text-sm font-semibold text-slate-700">Traditional Planning</p>
                            <p class="text-[10px] text-slate-500">Single channel focus</p>
                          </div>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center">
                          <div><p class="text-lg font-bold text-slate-600">65%</p><p class="text-[9px] text-slate-500">Reach</p></div>
                          <div><p class="text-lg font-bold text-slate-600">24 wk</p><p class="text-[9px] text-slate-500">Time to Goal</p></div>
                          <div><p class="text-lg font-bold text-slate-600">2.1x</p><p class="text-[9px] text-slate-500">ROAS</p></div>
                        </div>
                      </div>

                      <!-- Competitor Card -->
                      <div class="bg-amber-50 rounded-xl p-4 border border-amber-200">
                        <div class="flex items-center gap-3 mb-2">
                          <div class="w-8 h-8 bg-amber-500 rounded-lg flex items-center justify-center text-white text-xs font-bold">C</div>
                          <div>
                            <p class="text-sm font-semibold text-amber-800">Category Benchmark</p>
                            <p class="text-[10px] text-amber-600">Industry average</p>
                          </div>
                        </div>
                        <div class="grid grid-cols-3 gap-2 text-center">
                          <div><p class="text-lg font-bold text-amber-600">58%</p><p class="text-[9px] text-slate-500">Reach</p></div>
                          <div><p class="text-lg font-bold text-amber-600">26 wk</p><p class="text-[9px] text-slate-500">Time to Goal</p></div>
                          <div><p class="text-lg font-bold text-amber-600">1.8x</p><p class="text-[9px] text-slate-500">ROAS</p></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Key Advantages -->
                <div class="mt-5 pt-5 border-t border-slate-100">
                  <div class="grid grid-cols-4 gap-4">
                    <div class="flex items-center gap-3 p-3 bg-green-50 rounded-xl">
                      <div class="w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center text-white font-bold text-sm">35%</div>
                      <div><p class="text-xs font-medium text-green-800">Faster Goal</p><p class="text-[10px] text-green-600">vs Traditional</p></div>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-xl">
                      <div class="w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center text-white font-bold text-sm">+20%</div>
                      <div><p class="text-xs font-medium text-purple-800">Higher Reach</p><p class="text-[10px] text-purple-600">vs Competitor</p></div>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-blue-50 rounded-xl">
                      <div class="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center text-white font-bold text-sm">52%</div>
                      <div><p class="text-xs font-medium text-blue-800">Better ROAS</p><p class="text-[10px] text-blue-600">vs Traditional</p></div>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-cyan-50 rounded-xl">
                      <div class="w-10 h-10 bg-cyan-500 rounded-lg flex items-center justify-center text-white font-bold text-sm">6</div>
                      <div><p class="text-xs font-medium text-cyan-800">Channels</p><p class="text-[10px] text-cyan-600">Optimised mix</p></div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Individual Channel Performance -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-5">
                  <div>
                    <h3 class="font-semibold text-slate-800">Individual Channel Performance</h3>
                    <p class="text-sm text-slate-500">CPM/CPT data by channel and demographic from GroupM rates</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <select class="text-xs border border-slate-200 rounded-lg px-2 py-1.5 bg-white">
                      <option>P18-54</option>
                      <option>P18+</option>
                      <option>P25-54</option>
                      <option>W18+</option>
                      <option>M18+</option>
                    </select>
                    <button class="px-3 py-1.5 text-xs bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200">Export CSV</button>
                  </div>
                </div>
                <div class="overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b border-slate-200 text-left bg-slate-50">
                        <th class="px-3 py-3 font-medium text-slate-600 rounded-tl-lg">Channel</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-right">Budget</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-right">%</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-right">CPM/CPT</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-right">TARPs</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-right">Reach 1+</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-right">Reach 3+</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-right">Avg Freq</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-right">Impressions</th>
                        <th class="px-3 py-3 font-medium text-slate-600 text-center rounded-tr-lg">Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100 hover:bg-purple-50/50">
                        <td class="px-3 py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-purple-600"></div><span class="font-medium">FTA TV (Metro)</span></div></td>
                        <td class="px-3 py-3 text-right font-medium">$1,965,000</td>
                        <td class="px-3 py-3 text-right">25%</td>
                        <td class="px-3 py-3 text-right text-slate-600">$22.50</td>
                        <td class="px-3 py-3 text-right">286</td>
                        <td class="px-3 py-3 text-right"><span class="text-green-600 font-medium">68%</span></td>
                        <td class="px-3 py-3 text-right">48%</td>
                        <td class="px-3 py-3 text-right">4.2x</td>
                        <td class="px-3 py-3 text-right">87.3M</td>
                        <td class="px-3 py-3 text-center"><span class="px-2 py-0.5 rounded-full text-[10px] bg-green-100 text-green-700">Optimal</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-purple-50/50">
                        <td class="px-3 py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-purple-400"></div><span class="font-medium">FTA TV (Regional)</span></div></td>
                        <td class="px-3 py-3 text-right font-medium">$795,000</td>
                        <td class="px-3 py-3 text-right">10%</td>
                        <td class="px-3 py-3 text-right text-slate-600">$14.44</td>
                        <td class="px-3 py-3 text-right">160</td>
                        <td class="px-3 py-3 text-right"><span class="text-green-600 font-medium">52%</span></td>
                        <td class="px-3 py-3 text-right">35%</td>
                        <td class="px-3 py-3 text-right">3.5x</td>
                        <td class="px-3 py-3 text-right">55.2M</td>
                        <td class="px-3 py-3 text-center"><span class="px-2 py-0.5 rounded-full text-[10px] bg-green-100 text-green-700">Optimal</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-pink-50/50">
                        <td class="px-3 py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-pink-500"></div><span class="font-medium">BVOD/AVOD</span></div></td>
                        <td class="px-3 py-3 text-right font-medium">$1,414,800</td>
                        <td class="px-3 py-3 text-right">18%</td>
                        <td class="px-3 py-3 text-right text-slate-600">$27.00</td>
                        <td class="px-3 py-3 text-right">160</td>
                        <td class="px-3 py-3 text-right"><span class="text-green-600 font-medium">42%</span></td>
                        <td class="px-3 py-3 text-right">28%</td>
                        <td class="px-3 py-3 text-right">3.8x</td>
                        <td class="px-3 py-3 text-right">52.4M</td>
                        <td class="px-3 py-3 text-center"><span class="px-2 py-0.5 rounded-full text-[10px] bg-green-100 text-green-700">Optimal</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-green-50/50">
                        <td class="px-3 py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-green-500"></div><span class="font-medium">OOH (Large Format)</span></div></td>
                        <td class="px-3 py-3 text-right font-medium">$1,179,000</td>
                        <td class="px-3 py-3 text-right">15%</td>
                        <td class="px-3 py-3 text-right text-slate-600">$37.92</td>
                        <td class="px-3 py-3 text-right">245</td>
                        <td class="px-3 py-3 text-right"><span class="text-green-600 font-medium">55%</span></td>
                        <td class="px-3 py-3 text-right">48%</td>
                        <td class="px-3 py-3 text-right">8.5x</td>
                        <td class="px-3 py-3 text-right">117.9M</td>
                        <td class="px-3 py-3 text-center"><span class="px-2 py-0.5 rounded-full text-[10px] bg-amber-100 text-amber-700">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-green-50/50">
                        <td class="px-3 py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-green-400"></div><span class="font-medium">OOH (Small/Tactical)</span></div></td>
                        <td class="px-3 py-3 text-right font-medium">$786,000</td>
                        <td class="px-3 py-3 text-right">10%</td>
                        <td class="px-3 py-3 text-right text-slate-600">$19.86</td>
                        <td class="px-3 py-3 text-right">180</td>
                        <td class="px-3 py-3 text-right"><span class="text-green-600 font-medium">45%</span></td>
                        <td class="px-3 py-3 text-right">38%</td>
                        <td class="px-3 py-3 text-right">6.2x</td>
                        <td class="px-3 py-3 text-right">78.6M</td>
                        <td class="px-3 py-3 text-center"><span class="px-2 py-0.5 rounded-full text-[10px] bg-green-100 text-green-700">Optimal</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-blue-50/50">
                        <td class="px-3 py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-blue-500"></div><span class="font-medium">Social Media</span></div></td>
                        <td class="px-3 py-3 text-right font-medium">$707,400</td>
                        <td class="px-3 py-3 text-right">9%</td>
                        <td class="px-3 py-3 text-right text-slate-600">$6.00</td>
                        <td class="px-3 py-3 text-right">195</td>
                        <td class="px-3 py-3 text-right"><span class="text-green-600 font-medium">52%</span></td>
                        <td class="px-3 py-3 text-right">42%</td>
                        <td class="px-3 py-3 text-right">5.8x</td>
                        <td class="px-3 py-3 text-right">117.9M</td>
                        <td class="px-3 py-3 text-center"><span class="px-2 py-0.5 rounded-full text-[10px] bg-green-100 text-green-700">Optimal</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-orange-50/50">
                        <td class="px-3 py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-orange-500"></div><span class="font-medium">Digital Display</span></div></td>
                        <td class="px-3 py-3 text-right font-medium">$628,800</td>
                        <td class="px-3 py-3 text-right">8%</td>
                        <td class="px-3 py-3 text-right text-slate-600">$7.00</td>
                        <td class="px-3 py-3 text-right">155</td>
                        <td class="px-3 py-3 text-right"><span class="text-green-600 font-medium">38%</span></td>
                        <td class="px-3 py-3 text-right">28%</td>
                        <td class="px-3 py-3 text-right">6.2x</td>
                        <td class="px-3 py-3 text-right">89.8M</td>
                        <td class="px-3 py-3 text-center"><span class="px-2 py-0.5 rounded-full text-[10px] bg-green-100 text-green-700">Optimal</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-cyan-50/50">
                        <td class="px-3 py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-cyan-500"></div><span class="font-medium">Programmatic</span></div></td>
                        <td class="px-3 py-3 text-right font-medium">$383,000</td>
                        <td class="px-3 py-3 text-right">5%</td>
                        <td class="px-3 py-3 text-right text-slate-600">$5.00</td>
                        <td class="px-3 py-3 text-right">120</td>
                        <td class="px-3 py-3 text-right"><span class="text-green-600 font-medium">35%</span></td>
                        <td class="px-3 py-3 text-right">22%</td>
                        <td class="px-3 py-3 text-right">4.5x</td>
                        <td class="px-3 py-3 text-right">76.6M</td>
                        <td class="px-3 py-3 text-center"><span class="px-2 py-0.5 rounded-full text-[10px] bg-blue-100 text-blue-700">Low</span></td>
                      </tr>
                      <tr class="bg-purple-50 font-semibold">
                        <td class="px-3 py-3 text-purple-800 rounded-bl-lg">Total / De-duplicated</td>
                        <td class="px-3 py-3 text-right text-purple-800">$7,859,000</td>
                        <td class="px-3 py-3 text-right text-purple-800">100%</td>
                        <td class="px-3 py-3 text-right text-purple-800">$11.62</td>
                        <td class="px-3 py-3 text-right text-purple-800">1,245</td>
                        <td class="px-3 py-3 text-right text-purple-800">78%</td>
                        <td class="px-3 py-3 text-right text-purple-800">65%</td>
                        <td class="px-3 py-3 text-right text-purple-800">2.8x</td>
                        <td class="px-3 py-3 text-right text-purple-800">676.7M</td>
                        <td class="px-3 py-3 text-center rounded-br-lg"><span class="px-2 py-0.5 rounded-full text-[10px] bg-green-100 text-green-700">Optimal</span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Seasonality & Market Allocation -->
              <div class="grid grid-cols-2 gap-6">
                <!-- Seasonality Factors -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <h4 class="font-medium text-slate-800 mb-4">TV Seasonality Factors</h4>
                  <div class="grid grid-cols-6 gap-2">
                    <div class="text-center p-2 rounded-lg bg-green-100 border border-green-200">
                      <p class="text-[10px] text-slate-600">Jan</p>
                      <p class="text-sm font-bold text-green-700">1.50</p>
                      <p class="text-[9px] text-green-600">+50%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-slate-50 border border-slate-200">
                      <p class="text-[10px] text-slate-600">Feb</p>
                      <p class="text-sm font-bold text-slate-700">1.00</p>
                      <p class="text-[9px] text-slate-500">Base</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-slate-50 border border-slate-200">
                      <p class="text-[10px] text-slate-600">Mar</p>
                      <p class="text-sm font-bold text-slate-700">0.99</p>
                      <p class="text-[9px] text-slate-500">-1%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-green-50 border border-green-200">
                      <p class="text-[10px] text-slate-600">Apr</p>
                      <p class="text-sm font-bold text-green-700">1.07</p>
                      <p class="text-[9px] text-green-600">+7%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-amber-50 border border-amber-200">
                      <p class="text-[10px] text-slate-600">May</p>
                      <p class="text-sm font-bold text-amber-700">0.88</p>
                      <p class="text-[9px] text-amber-600">-12%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-amber-50 border border-amber-200">
                      <p class="text-[10px] text-slate-600">Jun</p>
                      <p class="text-sm font-bold text-amber-700">0.87</p>
                      <p class="text-[9px] text-amber-600">-13%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-slate-50 border border-slate-200">
                      <p class="text-[10px] text-slate-600">Jul</p>
                      <p class="text-sm font-bold text-slate-700">1.03</p>
                      <p class="text-[9px] text-slate-500">+3%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-slate-50 border border-slate-200">
                      <p class="text-[10px] text-slate-600">Aug</p>
                      <p class="text-sm font-bold text-slate-700">0.94</p>
                      <p class="text-[9px] text-slate-500">-6%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-slate-50 border border-slate-200">
                      <p class="text-[10px] text-slate-600">Sep</p>
                      <p class="text-sm font-bold text-slate-700">0.93</p>
                      <p class="text-[9px] text-slate-500">-7%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-red-50 border border-red-200">
                      <p class="text-[10px] text-slate-600">Oct</p>
                      <p class="text-sm font-bold text-red-700">0.70</p>
                      <p class="text-[9px] text-red-600">-30%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-red-50 border border-red-200">
                      <p class="text-[10px] text-slate-600">Nov</p>
                      <p class="text-sm font-bold text-red-700">0.69</p>
                      <p class="text-[9px] text-red-600">-31%</p>
                    </div>
                    <div class="text-center p-2 rounded-lg bg-green-100 border border-green-200">
                      <p class="text-[10px] text-slate-600">Dec</p>
                      <p class="text-sm font-bold text-green-700">1.40</p>
                      <p class="text-[9px] text-green-600">+40%</p>
                    </div>
                  </div>
                  <p class="text-[10px] text-slate-500 mt-3">TARP seasonality applied to TV cost calculations. Oct-Nov lowest due to ratings period competition.</p>
                </div>

                <!-- Market Allocation -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <h4 class="font-medium text-slate-800 mb-4">Regional Market Allocation</h4>
                  <div class="space-y-3">
                    <div class="flex items-center gap-3">
                      <div class="w-12 text-xs font-medium text-slate-700">NSW</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-600 rounded-full" style="width: 34%"></div>
                      </div>
                      <span class="text-xs font-bold text-purple-600 w-16 text-right">34% / $2.67M</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-12 text-xs font-medium text-slate-700">VIC</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-500 rounded-full" style="width: 27%"></div>
                      </div>
                      <span class="text-xs font-bold text-purple-500 w-16 text-right">27% / $2.12M</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-12 text-xs font-medium text-slate-700">QLD</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-400 rounded-full" style="width: 22%"></div>
                      </div>
                      <span class="text-xs font-bold text-purple-400 w-16 text-right">22% / $1.73M</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-12 text-xs font-medium text-slate-700">WA</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-300 rounded-full" style="width: 10%"></div>
                      </div>
                      <span class="text-xs font-bold text-purple-400 w-16 text-right">10% / $786K</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-12 text-xs font-medium text-slate-700">SA</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-200 rounded-full" style="width: 7%"></div>
                      </div>
                      <span class="text-xs font-bold text-purple-300 w-16 text-right">6.7% / $527K</span>
                    </div>
                  </div>
                  <div class="flex items-center justify-between mt-4 pt-3 border-t border-slate-100">
                    <div class="flex items-center gap-4">
                      <div class="flex items-center gap-1"><div class="w-3 h-3 rounded bg-indigo-500"></div><span class="text-[10px] text-slate-600">Metro 65%</span></div>
                      <div class="flex items-center gap-1"><div class="w-3 h-3 rounded bg-indigo-300"></div><span class="text-[10px] text-slate-600">Regional 35%</span></div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Challenge Diagnosis Section Header -->
              <div class="bg-gradient-to-r from-purple-600 to-indigo-600 rounded-2xl p-5 text-white">
                <div class="flex items-center gap-3">
                  <div class="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center">
                    <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
                  </div>
                  <div>
                    <h3 class="font-semibold text-lg">Challenge Diagnosis</h3>
                    <p class="text-sm text-white/80">Category, Brand, Cultural Analysis & Experience Audit</p>
                  </div>
                </div>
              </div>

              <!-- Category & Brand Analysis Grid -->
              <div class="grid grid-cols-2 gap-6">
                <!-- Category Analysis -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                      <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                        <svg class="w-4 h-4 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Category Analysis</h4>
                        <p class="text-[10px] text-slate-500">Source: Nielsen, Adgile, Brand Health</p>
                      </div>
                    </div>
                  </div>
                  <div class="space-y-4">
                    <!-- Market Size -->
                    <div class="flex items-center justify-between p-3 bg-blue-50 rounded-xl">
                      <div>
                        <p class="text-xs text-slate-600">Category Size (TTM)</p>
                        <p class="text-lg font-bold text-blue-700">$4.2B</p>
                      </div>
                      <div class="text-right">
                        <p class="text-xs text-slate-500">Growth YoY</p>
                        <p class="text-sm font-semibold text-green-600">+3.8%</p>
                      </div>
                    </div>
                    <!-- Competitive Investment -->
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                      <div>
                        <p class="text-xs text-slate-600">Category Ad Spend (TTM)</p>
                        <p class="text-lg font-bold text-slate-700">$892M</p>
                      </div>
                      <div class="text-right">
                        <p class="text-xs text-slate-500">Share of Voice</p>
                        <p class="text-sm font-semibold text-purple-600">18%</p>
                      </div>
                    </div>
                    <!-- Top 3 Competitors -->
                    <div>
                      <p class="text-xs font-medium text-slate-600 mb-2">Competitor SOV</p>
                      <div class="space-y-2">
                        <div class="flex items-center gap-2">
                          <span class="text-[10px] text-slate-500 w-20">Competitor A</span>
                          <div class="flex-1 h-3 bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full bg-red-500 rounded-full" style="width: 28%"></div>
                          </div>
                          <span class="text-[10px] font-medium text-slate-700">28%</span>
                        </div>
                        <div class="flex items-center gap-2">
                          <span class="text-[10px] text-slate-500 w-20">Competitor B</span>
                          <div class="flex-1 h-3 bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full bg-orange-500 rounded-full" style="width: 22%"></div>
                          </div>
                          <span class="text-[10px] font-medium text-slate-700">22%</span>
                        </div>
                        <div class="flex items-center gap-2">
                          <span class="text-[10px] text-purple-600 w-20 font-medium">Our Brand</span>
                          <div class="flex-1 h-3 bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full bg-purple-500 rounded-full" style="width: 18%"></div>
                          </div>
                          <span class="text-[10px] font-medium text-purple-600">18%</span>
                        </div>
                        <div class="flex items-center gap-2">
                          <span class="text-[10px] text-slate-500 w-20">Others</span>
                          <div class="flex-1 h-3 bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full bg-slate-400 rounded-full" style="width: 32%"></div>
                          </div>
                          <span class="text-[10px] font-medium text-slate-700">32%</span>
                        </div>
                      </div>
                    </div>
                    <!-- Key Insight -->
                    <div class="p-3 bg-blue-50 rounded-xl border border-blue-100">
                      <p class="text-[10px] text-blue-600 font-medium mb-1">KEY INSIGHT</p>
                      <p class="text-xs text-slate-700">Category leader outspends by 55%. Opportunity to close SOV gap during lower-cost Q2/Q3 periods.</p>
                    </div>
                  </div>
                </div>

                <!-- Brand Analysis -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                      <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                        <svg class="w-4 h-4 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Brand Analysis</h4>
                        <p class="text-[10px] text-slate-500">Source: YouGov, FiftyFive5, Meltwater</p>
                      </div>
                    </div>
                  </div>
                  <div class="space-y-4">
                    <!-- Brand Health Metrics -->
                    <div class="grid grid-cols-4 gap-2">
                      <div class="text-center p-2 bg-purple-50 rounded-lg">
                        <p class="text-lg font-bold text-purple-700">72%</p>
                        <p class="text-[9px] text-slate-600">Awareness</p>
                      </div>
                      <div class="text-center p-2 bg-blue-50 rounded-lg">
                        <p class="text-lg font-bold text-blue-700">45%</p>
                        <p class="text-[9px] text-slate-600">Consideration</p>
                      </div>
                      <div class="text-center p-2 bg-cyan-50 rounded-lg">
                        <p class="text-lg font-bold text-cyan-700">28%</p>
                        <p class="text-[9px] text-slate-600">Preference</p>
                      </div>
                      <div class="text-center p-2 bg-green-50 rounded-lg">
                        <p class="text-lg font-bold text-green-600">+42</p>
                        <p class="text-[9px] text-slate-600">NPS</p>
                      </div>
                    </div>
                    <!-- Brand Funnel -->
                    <div>
                      <p class="text-xs font-medium text-slate-600 mb-2">Brand Funnel vs Category</p>
                      <div class="relative">
                        <svg viewBox="0 0 300 80" class="w-full h-16">
                          <!-- Funnel background -->
                          <polygon points="10,10 290,10 250,70 50,70" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1"/>
                          <!-- Our brand funnel -->
                          <polygon points="10,10 217,10 195,70 50,70" fill="#a855f7" fill-opacity="0.3" stroke="#a855f7" stroke-width="1.5"/>
                          <!-- Labels -->
                          <text x="150" y="25" text-anchor="middle" class="text-[9px] fill-slate-600">Awareness 72%</text>
                          <text x="150" y="45" text-anchor="middle" class="text-[9px] fill-slate-600">Consideration 45%</text>
                          <text x="150" y="65" text-anchor="middle" class="text-[9px] fill-slate-600">Preference 28%</text>
                        </svg>
                      </div>
                    </div>
                    <!-- Brand Attributes -->
                    <div>
                      <p class="text-xs font-medium text-slate-600 mb-2">Brand Attribute Scores</p>
                      <div class="space-y-1.5">
                        <div class="flex items-center gap-2">
                          <span class="text-[10px] text-slate-500 w-20">Trust</span>
                          <div class="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 rounded-full" style="width: 78%"></div>
                          </div>
                          <span class="text-[10px] font-medium text-green-600">78%</span>
                        </div>
                        <div class="flex items-center gap-2">
                          <span class="text-[10px] text-slate-500 w-20">Quality</span>
                          <div class="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full bg-blue-500 rounded-full" style="width: 72%"></div>
                          </div>
                          <span class="text-[10px] font-medium text-blue-600">72%</span>
                        </div>
                        <div class="flex items-center gap-2">
                          <span class="text-[10px] text-slate-500 w-20">Value</span>
                          <div class="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full bg-amber-500 rounded-full" style="width: 58%"></div>
                          </div>
                          <span class="text-[10px] font-medium text-amber-600">58%</span>
                        </div>
                        <div class="flex items-center gap-2">
                          <span class="text-[10px] text-slate-500 w-20">Innovation</span>
                          <div class="flex-1 h-2 bg-slate-100 rounded-full overflow-hidden">
                            <div class="h-full bg-purple-500 rounded-full" style="width: 52%"></div>
                          </div>
                          <span class="text-[10px] font-medium text-purple-600">52%</span>
                        </div>
                      </div>
                    </div>
                    <!-- Key Insight -->
                    <div class="p-3 bg-purple-50 rounded-xl border border-purple-100">
                      <p class="text-[10px] text-purple-600 font-medium mb-1">KEY INSIGHT</p>
                      <p class="text-xs text-slate-700">Strong trust & quality scores. Consideration-to-preference gap of 17pts represents conversion opportunity.</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Cultural Analysis & Experience Audit Grid -->
              <div class="grid grid-cols-2 gap-6">
                <!-- Cultural Analysis -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                      <div class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center">
                        <svg class="w-4 h-4 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Cultural Analysis</h4>
                        <p class="text-[10px] text-slate-500">Source: Meltwater, Accenture, GWI</p>
                      </div>
                    </div>
                  </div>
                  <div class="space-y-4">
                    <!-- Trending Themes -->
                    <div>
                      <p class="text-xs font-medium text-slate-600 mb-2">Trending Cultural Themes</p>
                      <div class="flex flex-wrap gap-2">
                        <span class="px-2 py-1 bg-amber-100 text-amber-700 text-[10px] rounded-full">Sustainability +45%</span>
                        <span class="px-2 py-1 bg-green-100 text-green-700 text-[10px] rounded-full">Local/Australian +38%</span>
                        <span class="px-2 py-1 bg-blue-100 text-blue-700 text-[10px] rounded-full">Health-conscious +32%</span>
                        <span class="px-2 py-1 bg-purple-100 text-purple-700 text-[10px] rounded-full">Value-seeking +28%</span>
                        <span class="px-2 py-1 bg-pink-100 text-pink-700 text-[10px] rounded-full">Premium moments +22%</span>
                      </div>
                    </div>
                    <!-- Cultural Moments Calendar -->
                    <div>
                      <p class="text-xs font-medium text-slate-600 mb-2">Key Cultural Moments (H1 2026)</p>
                      <div class="space-y-2">
                        <div class="flex items-center gap-2 p-2 bg-blue-50 rounded-lg">
                          <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                          <span class="text-xs text-slate-700 flex-1">Australian Open</span>
                          <span class="text-[10px] text-slate-500">Jan 12-26</span>
                          <span class="text-[9px] bg-blue-100 text-blue-600 px-1.5 py-0.5 rounded">Sports</span>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-pink-50 rounded-lg">
                          <div class="w-2 h-2 bg-pink-500 rounded-full"></div>
                          <span class="text-xs text-slate-700 flex-1">Valentine's Day</span>
                          <span class="text-[10px] text-slate-500">Feb 14</span>
                          <span class="text-[9px] bg-pink-100 text-pink-600 px-1.5 py-0.5 rounded">Retail</span>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-green-50 rounded-lg">
                          <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                          <span class="text-xs text-slate-700 flex-1">Easter / EOFY</span>
                          <span class="text-[10px] text-slate-500">Apr-Jun</span>
                          <span class="text-[9px] bg-green-100 text-green-600 px-1.5 py-0.5 rounded">Retail</span>
                        </div>
                        <div class="flex items-center gap-2 p-2 bg-purple-50 rounded-lg">
                          <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                          <span class="text-xs text-slate-700 flex-1">State of Origin</span>
                          <span class="text-[10px] text-slate-500">May-Jul</span>
                          <span class="text-[9px] bg-purple-100 text-purple-600 px-1.5 py-0.5 rounded">Sports</span>
                        </div>
                      </div>
                    </div>
                    <!-- Social Conversation -->
                    <div class="p-3 bg-amber-50 rounded-xl border border-amber-100">
                      <p class="text-[10px] text-amber-600 font-medium mb-1">SOCIAL SENTIMENT</p>
                      <div class="flex items-center gap-4">
                        <div class="text-center">
                          <p class="text-lg font-bold text-green-600">68%</p>
                          <p class="text-[9px] text-slate-500">Positive</p>
                        </div>
                        <div class="text-center">
                          <p class="text-lg font-bold text-slate-500">24%</p>
                          <p class="text-[9px] text-slate-500">Neutral</p>
                        </div>
                        <div class="text-center">
                          <p class="text-lg font-bold text-red-500">8%</p>
                          <p class="text-[9px] text-slate-500">Negative</p>
                        </div>
                        <div class="flex-1 text-right">
                          <p class="text-[10px] text-slate-600">12.4K mentions</p>
                          <p class="text-[10px] text-green-600">+18% vs LY</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Experience Audit -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                      <div class="w-8 h-8 bg-cyan-100 rounded-lg flex items-center justify-center">
                        <svg class="w-4 h-4 text-cyan-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Experience Audit</h4>
                        <p class="text-[10px] text-slate-500">Source: OESP Audit, Google, TikTok</p>
                      </div>
                    </div>
                  </div>
                  <div class="space-y-4">
                    <!-- Spider/Radar Chart -->
                    <div class="relative">
                      <p class="text-xs font-medium text-slate-600 mb-2">Touchpoint Performance (vs Category Avg)</p>
                      <div class="h-40 flex items-center justify-center">
                        <svg viewBox="0 0 200 180" class="w-full h-full">
                          <!-- Background hexagon grid -->
                          <polygon points="100,15 170,50 170,120 100,155 30,120 30,50" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                          <polygon points="100,35 155,60 155,110 100,135 45,110 45,60" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                          <polygon points="100,55 140,72 140,98 100,115 60,98 60,72" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                          <polygon points="100,75 125,83 125,88 100,95 75,88 75,83" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                          <!-- Category average (grey dashed) -->
                          <polygon points="100,45 145,65 145,105 100,125 55,105 55,65" fill="none" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,2"/>
                          <!-- Our brand performance (purple solid) -->
                          <polygon points="100,25 160,55 155,115 100,140 50,108 48,52" fill="#a855f7" fill-opacity="0.2" stroke="#a855f7" stroke-width="2"/>
                          <!-- Data points -->
                          <circle cx="100" cy="25" r="4" fill="#a855f7"/>
                          <circle cx="160" cy="55" r="4" fill="#a855f7"/>
                          <circle cx="155" cy="115" r="4" fill="#a855f7"/>
                          <circle cx="100" cy="140" r="4" fill="#a855f7"/>
                          <circle cx="50" cy="108" r="4" fill="#a855f7"/>
                          <circle cx="48" cy="52" r="4" fill="#a855f7"/>
                          <!-- Labels -->
                          <text x="100" y="8" text-anchor="middle" class="text-[8px] fill-slate-600">TV Awareness</text>
                          <text x="180" y="55" text-anchor="start" class="text-[8px] fill-slate-600">Digital Eng.</text>
                          <text x="175" y="120" text-anchor="start" class="text-[8px] fill-slate-600">Social Sent.</text>
                          <text x="100" y="168" text-anchor="middle" class="text-[8px] fill-slate-600">In-Store</text>
                          <text x="20" y="120" text-anchor="end" class="text-[8px] fill-slate-600">OOH Recall</text>
                          <text x="20" y="55" text-anchor="end" class="text-[8px] fill-slate-600">Search Intent</text>
                        </svg>
                      </div>
                      <div class="flex items-center justify-center gap-4 mt-1">
                        <div class="flex items-center gap-1"><div class="w-3 h-0.5 bg-purple-500 rounded"></div><span class="text-[9px] text-slate-500">Our Brand</span></div>
                        <div class="flex items-center gap-1"><div class="w-3 h-0.5 bg-slate-400 rounded border-dashed"></div><span class="text-[9px] text-slate-500">Category Avg</span></div>
                      </div>
                    </div>
                    <!-- Touchpoint Scores Table -->
                    <div>
                      <p class="text-xs font-medium text-slate-600 mb-2">Touchpoint Index Scores</p>
                      <div class="grid grid-cols-3 gap-2">
                        <div class="p-2 bg-green-50 rounded-lg text-center">
                          <p class="text-sm font-bold text-green-600">125</p>
                          <p class="text-[9px] text-slate-600">TV Awareness</p>
                        </div>
                        <div class="p-2 bg-green-50 rounded-lg text-center">
                          <p class="text-sm font-bold text-green-600">118</p>
                          <p class="text-[9px] text-slate-600">Digital Eng.</p>
                        </div>
                        <div class="p-2 bg-amber-50 rounded-lg text-center">
                          <p class="text-sm font-bold text-amber-600">95</p>
                          <p class="text-[9px] text-slate-600">Social Sent.</p>
                        </div>
                        <div class="p-2 bg-green-50 rounded-lg text-center">
                          <p class="text-sm font-bold text-green-600">112</p>
                          <p class="text-[9px] text-slate-600">In-Store</p>
                        </div>
                        <div class="p-2 bg-amber-50 rounded-lg text-center">
                          <p class="text-sm font-bold text-amber-600">92</p>
                          <p class="text-[9px] text-slate-600">OOH Recall</p>
                        </div>
                        <div class="p-2 bg-red-50 rounded-lg text-center">
                          <p class="text-sm font-bold text-red-600">85</p>
                          <p class="text-[9px] text-slate-600">Search Intent</p>
                        </div>
                      </div>
                    </div>
                    <!-- Key Insight -->
                    <div class="p-3 bg-cyan-50 rounded-xl border border-cyan-100">
                      <p class="text-[10px] text-cyan-600 font-medium mb-1">KEY INSIGHT</p>
                      <p class="text-xs text-slate-700">Below-index on Search & OOH suggests need for improved lower-funnel activation and outdoor creative refresh.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Channels -->
          <div class="plan-content hidden" data-plan-content="channels">
            <div class="space-y-6">
              <!-- Channel Performance Comparison -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <h3 class="font-semibold text-slate-800">Channel Performance Mapping</h3>
                  <div class="flex items-center gap-2">
                    <span class="text-sm text-slate-500">Total Budget: $7,860,000</span>
                    <button class="px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200">Export</button>
                  </div>
                </div>

                <!-- Channel Comparison Table -->
                <div class="overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b border-slate-200 text-left">
                        <th class="pb-3 font-medium text-slate-600">Channel</th>
                        <th class="pb-3 font-medium text-slate-600">Role</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Spend</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">%</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Est. Reach</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Avg. Freq</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Est. Impressions</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">eCPM</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-purple-600"></div><span class="font-medium">FTA TV</span></div></td>
                        <td class="py-4"><span class="px-2 py-1 rounded text-xs bg-blue-100 text-blue-700">Brand</span></td>
                        <td class="py-4 text-right font-medium">$2,760,000</td>
                        <td class="py-4 text-right">35%</td>
                        <td class="py-4 text-right"><span class="text-green-600 font-medium">68%</span></td>
                        <td class="py-4 text-right">4.2x</td>
                        <td class="py-4 text-right">142.5M</td>
                        <td class="py-4 text-right text-slate-600">$19.37</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-pink-500"></div><span class="font-medium">Premium VOD</span></div></td>
                        <td class="py-4"><span class="px-2 py-1 rounded text-xs bg-blue-100 text-blue-700">Brand</span></td>
                        <td class="py-4 text-right font-medium">$1,440,000</td>
                        <td class="py-4 text-right">18%</td>
                        <td class="py-4 text-right"><span class="text-green-600 font-medium">42%</span></td>
                        <td class="py-4 text-right">3.8x</td>
                        <td class="py-4 text-right">58.2M</td>
                        <td class="py-4 text-right text-slate-600">$24.74</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-green-500"></div><span class="font-medium">Out of Home</span></div></td>
                        <td class="py-4"><span class="px-2 py-1 rounded text-xs bg-green-100 text-green-700">Activation</span></td>
                        <td class="py-4 text-right font-medium">$1,965,000</td>
                        <td class="py-4 text-right">25%</td>
                        <td class="py-4 text-right"><span class="text-green-600 font-medium">55%</span></td>
                        <td class="py-4 text-right">8.5x</td>
                        <td class="py-4 text-right">196.5M</td>
                        <td class="py-4 text-right text-slate-600">$10.00</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-orange-500"></div><span class="font-medium">Display</span></div></td>
                        <td class="py-4"><span class="px-2 py-1 rounded text-xs bg-green-100 text-green-700">Activation</span></td>
                        <td class="py-4 text-right font-medium">$628,800</td>
                        <td class="py-4 text-right">8%</td>
                        <td class="py-4 text-right"><span class="text-green-600 font-medium">38%</span></td>
                        <td class="py-4 text-right">6.2x</td>
                        <td class="py-4 text-right">89.8M</td>
                        <td class="py-4 text-right text-slate-600">$7.00</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-blue-500"></div><span class="font-medium">Social</span></div></td>
                        <td class="py-4"><span class="px-2 py-1 rounded text-xs bg-purple-100 text-purple-700">Engagement</span></td>
                        <td class="py-4 text-right font-medium">$707,400</td>
                        <td class="py-4 text-right">9%</td>
                        <td class="py-4 text-right"><span class="text-green-600 font-medium">52%</span></td>
                        <td class="py-4 text-right">5.8x</td>
                        <td class="py-4 text-right">117.9M</td>
                        <td class="py-4 text-right text-slate-600">$6.00</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full bg-cyan-500"></div><span class="font-medium">Programmatic</span></div></td>
                        <td class="py-4"><span class="px-2 py-1 rounded text-xs bg-green-100 text-green-700">Activation</span></td>
                        <td class="py-4 text-right font-medium">$358,800</td>
                        <td class="py-4 text-right">5%</td>
                        <td class="py-4 text-right"><span class="text-green-600 font-medium">35%</span></td>
                        <td class="py-4 text-right">4.5x</td>
                        <td class="py-4 text-right">71.8M</td>
                        <td class="py-4 text-right text-slate-600">$5.00</td>
                      </tr>
                      <tr class="bg-purple-50 font-semibold">
                        <td class="py-4 text-purple-800">Total / Aggregated</td>
                        <td class="py-4"></td>
                        <td class="py-4 text-right text-purple-800">$7,860,000</td>
                        <td class="py-4 text-right text-purple-800">100%</td>
                        <td class="py-4 text-right text-purple-800">78%</td>
                        <td class="py-4 text-right text-purple-800">2.8x</td>
                        <td class="py-4 text-right text-purple-800">676.7M</td>
                        <td class="py-4 text-right text-purple-800">$11.62</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Visual Comparison Charts -->
              <div class="grid grid-cols-3 gap-4">
                <!-- Reach Comparison -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <h4 class="font-medium text-slate-800 mb-4">Reach by Channel</h4>
                  <div class="space-y-3">
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">FTA TV</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-600 rounded-full" style="width: 68%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">68%</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">OOH</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-green-500 rounded-full" style="width: 55%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">55%</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Social</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-500 rounded-full" style="width: 52%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">52%</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">VOD</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-pink-500 rounded-full" style="width: 42%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">42%</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Display</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-orange-500 rounded-full" style="width: 38%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">38%</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Prog.</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-cyan-500 rounded-full" style="width: 35%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">35%</span>
                    </div>
                  </div>
                </div>

                <!-- Frequency Comparison -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <h4 class="font-medium text-slate-800 mb-4">Frequency by Channel</h4>
                  <div class="space-y-3">
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">OOH</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-green-500 rounded-full" style="width: 85%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">8.5x</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Display</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-orange-500 rounded-full" style="width: 62%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">6.2x</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Social</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-500 rounded-full" style="width: 58%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">5.8x</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Prog.</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-cyan-500 rounded-full" style="width: 45%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">4.5x</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">FTA TV</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-600 rounded-full" style="width: 42%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">4.2x</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">VOD</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-pink-500 rounded-full" style="width: 38%"></div>
                      </div>
                      <span class="text-xs font-medium w-10 text-right">3.8x</span>
                    </div>
                  </div>
                </div>

                <!-- Impressions Comparison -->
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <h4 class="font-medium text-slate-800 mb-4">Est. Impressions by Channel</h4>
                  <div class="space-y-3">
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">OOH</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-green-500 rounded-full" style="width: 100%"></div>
                      </div>
                      <span class="text-xs font-medium w-12 text-right">196.5M</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">FTA TV</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-600 rounded-full" style="width: 72%"></div>
                      </div>
                      <span class="text-xs font-medium w-12 text-right">142.5M</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Social</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-500 rounded-full" style="width: 60%"></div>
                      </div>
                      <span class="text-xs font-medium w-12 text-right">117.9M</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Display</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-orange-500 rounded-full" style="width: 46%"></div>
                      </div>
                      <span class="text-xs font-medium w-12 text-right">89.8M</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">Prog.</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-cyan-500 rounded-full" style="width: 37%"></div>
                      </div>
                      <span class="text-xs font-medium w-12 text-right">71.8M</span>
                    </div>
                    <div class="flex items-center gap-3">
                      <div class="w-16 text-xs text-slate-600">VOD</div>
                      <div class="flex-1 h-6 bg-slate-100 rounded-full overflow-hidden">
                        <div class="h-full bg-pink-500 rounded-full" style="width: 30%"></div>
                      </div>
                      <span class="text-xs font-medium w-12 text-right">58.2M</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Media Plan Summary -->
          <div class="plan-content hidden" data-plan-content="summary">
            <div class="space-y-6">
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Monthly Media Plan</h3>
                <table class="w-full text-sm"><thead><tr class="border-b border-slate-200 text-left text-slate-500"><th class="pb-3">Month</th><th class="pb-3 text-right">Spend</th><th class="pb-3 text-right">Reach</th><th class="pb-3 text-right">Freq</th><th class="pb-3 text-right">GRPs</th></tr></thead><tbody>
                  <tr class="border-b border-slate-100"><td class="py-3">January</td><td class="py-3 text-right">$1,310,000</td><td class="py-3 text-right text-blue-600">52%</td><td class="py-3 text-right">2.8</td><td class="py-3 text-right">145</td></tr>
                  <tr class="border-b border-slate-100"><td class="py-3">February</td><td class="py-3 text-right">$1,310,000</td><td class="py-3 text-right text-blue-600">58%</td><td class="py-3 text-right">2.6</td><td class="py-3 text-right">151</td></tr>
                  <tr class="border-b border-slate-100"><td class="py-3">March</td><td class="py-3 text-right">$1,310,000</td><td class="py-3 text-right text-blue-600">65%</td><td class="py-3 text-right">2.9</td><td class="py-3 text-right">188</td></tr>
                  <tr class="border-b border-slate-100"><td class="py-3">April</td><td class="py-3 text-right">$1,310,000</td><td class="py-3 text-right text-blue-600">71%</td><td class="py-3 text-right">2.7</td><td class="py-3 text-right">192</td></tr>
                  <tr class="border-b border-slate-100"><td class="py-3">May</td><td class="py-3 text-right">$1,310,000</td><td class="py-3 text-right text-blue-600">75%</td><td class="py-3 text-right">2.8</td><td class="py-3 text-right">210</td></tr>
                  <tr class="border-b border-slate-100"><td class="py-3">June</td><td class="py-3 text-right">$1,310,000</td><td class="py-3 text-right text-blue-600">78%</td><td class="py-3 text-right">2.8</td><td class="py-3 text-right">218</td></tr>
                </tbody></table>
              </div>
              <div class="grid grid-cols-3 gap-4">
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-5 border border-blue-200"><p class="text-blue-700 text-sm mb-1">Total Reach</p><p class="text-3xl font-bold text-slate-800">78%</p></div>
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl p-5 border border-purple-200"><p class="text-purple-700 text-sm mb-1">Avg Frequency</p><p class="text-3xl font-bold text-slate-800">2.8</p></div>
                <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-5 border border-green-200"><p class="text-green-700 text-sm mb-1">Total GRPs</p><p class="text-3xl font-bold text-slate-800">1,104</p></div>
              </div>
            </div>
          </div>

          <!-- Reach & Frequency -->
          <div class="plan-content hidden" data-plan-content="reach">
            <div class="space-y-6">
              <!-- Aggregated Total Summary -->
              <div class="bg-gradient-to-r from-purple-600 to-purple-700 rounded-2xl p-6 text-white">
                <h3 class="font-semibold mb-4">Aggregated Reach & Frequency - All Channels</h3>
                <div class="grid grid-cols-5 gap-6">
                  <div class="text-center">
                    <p class="text-purple-200 text-sm mb-1">Total Reach</p>
                    <p class="text-4xl font-bold">78%</p>
                    <p class="text-purple-200 text-xs mt-1">of target audience</p>
                  </div>
                  <div class="text-center">
                    <p class="text-purple-200 text-sm mb-1">Avg. Frequency</p>
                    <p class="text-4xl font-bold">2.8x</p>
                    <p class="text-purple-200 text-xs mt-1">opportunities to see</p>
                  </div>
                  <div class="text-center">
                    <p class="text-purple-200 text-sm mb-1">Effective Reach</p>
                    <p class="text-4xl font-bold">65%</p>
                    <p class="text-purple-200 text-xs mt-1">at 3+ frequency</p>
                  </div>
                  <div class="text-center">
                    <p class="text-purple-200 text-sm mb-1">Total GRPs</p>
                    <p class="text-4xl font-bold">1,245</p>
                    <p class="text-purple-200 text-xs mt-1">gross rating points</p>
                  </div>
                  <div class="text-center">
                    <p class="text-purple-200 text-sm mb-1">Est. Impressions</p>
                    <p class="text-4xl font-bold">676.7M</p>
                    <p class="text-purple-200 text-xs mt-1">total impressions</p>
                  </div>
                </div>
              </div>

              <!-- Per-Channel Breakdown Table -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <h3 class="font-semibold text-slate-800">Reach & Frequency by Channel</h3>
                  <button class="px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200">Export Data</button>
                </div>
                <div class="overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b border-slate-200 text-left">
                        <th class="pb-3 font-medium text-slate-600">Channel</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Reach 1+</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Reach 2+</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Reach 3+</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Reach 4+</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Reach 5+</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">Avg Freq</th>
                        <th class="pb-3 font-medium text-slate-600 text-right">GRPs</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-purple-600"></div><span class="font-medium">FTA TV</span></div></td>
                        <td class="py-3 text-right font-medium text-green-600">68%</td>
                        <td class="py-3 text-right">58%</td>
                        <td class="py-3 text-right">48%</td>
                        <td class="py-3 text-right">38%</td>
                        <td class="py-3 text-right">28%</td>
                        <td class="py-3 text-right font-medium">4.2x</td>
                        <td class="py-3 text-right">286</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-pink-500"></div><span class="font-medium">Premium VOD</span></div></td>
                        <td class="py-3 text-right font-medium text-green-600">42%</td>
                        <td class="py-3 text-right">35%</td>
                        <td class="py-3 text-right">28%</td>
                        <td class="py-3 text-right">22%</td>
                        <td class="py-3 text-right">16%</td>
                        <td class="py-3 text-right font-medium">3.8x</td>
                        <td class="py-3 text-right">160</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-green-500"></div><span class="font-medium">Out of Home</span></div></td>
                        <td class="py-3 text-right font-medium text-green-600">55%</td>
                        <td class="py-3 text-right">52%</td>
                        <td class="py-3 text-right">48%</td>
                        <td class="py-3 text-right">44%</td>
                        <td class="py-3 text-right">40%</td>
                        <td class="py-3 text-right font-medium">8.5x</td>
                        <td class="py-3 text-right">468</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-orange-500"></div><span class="font-medium">Display</span></div></td>
                        <td class="py-3 text-right font-medium text-green-600">38%</td>
                        <td class="py-3 text-right">32%</td>
                        <td class="py-3 text-right">26%</td>
                        <td class="py-3 text-right">20%</td>
                        <td class="py-3 text-right">15%</td>
                        <td class="py-3 text-right font-medium">6.2x</td>
                        <td class="py-3 text-right">118</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-blue-500"></div><span class="font-medium">Social</span></div></td>
                        <td class="py-3 text-right font-medium text-green-600">52%</td>
                        <td class="py-3 text-right">44%</td>
                        <td class="py-3 text-right">36%</td>
                        <td class="py-3 text-right">28%</td>
                        <td class="py-3 text-right">21%</td>
                        <td class="py-3 text-right font-medium">5.8x</td>
                        <td class="py-3 text-right">152</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3"><div class="flex items-center gap-2"><div class="w-3 h-3 rounded-full bg-cyan-500"></div><span class="font-medium">Programmatic</span></div></td>
                        <td class="py-3 text-right font-medium text-green-600">35%</td>
                        <td class="py-3 text-right">28%</td>
                        <td class="py-3 text-right">22%</td>
                        <td class="py-3 text-right">16%</td>
                        <td class="py-3 text-right">11%</td>
                        <td class="py-3 text-right font-medium">4.5x</td>
                        <td class="py-3 text-right">61</td>
                      </tr>
                      <tr class="bg-purple-50 font-semibold">
                        <td class="py-3 text-purple-800">Combined Total</td>
                        <td class="py-3 text-right text-purple-800">78%</td>
                        <td class="py-3 text-right text-purple-800">72%</td>
                        <td class="py-3 text-right text-purple-800">65%</td>
                        <td class="py-3 text-right text-purple-800">56%</td>
                        <td class="py-3 text-right text-purple-800">45%</td>
                        <td class="py-3 text-right text-purple-800">2.8x</td>
                        <td class="py-3 text-right text-purple-800">1,245</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Visual Charts -->
              <div class="grid grid-cols-2 gap-6">
                <!-- Combined Reach Curve -->
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <h3 class="font-semibold text-slate-800 mb-4">Combined Reach Curve</h3>
                  <div class="h-52 relative">
                    <!-- Y-axis labels -->
                    <div class="absolute left-0 top-0 bottom-6 w-10 flex flex-col justify-between text-xs text-slate-400">
                      <span>100%</span>
                      <span>75%</span>
                      <span>50%</span>
                      <span>25%</span>
                      <span>0%</span>
                    </div>
                    <!-- Chart Area -->
                    <div class="ml-12 h-44 relative border-l border-b border-slate-200">
                      <!-- Grid lines -->
                      <div class="absolute inset-0 flex flex-col justify-between">
                        <div class="border-b border-slate-100"></div>
                        <div class="border-b border-slate-100"></div>
                        <div class="border-b border-slate-100"></div>
                        <div class="border-b border-slate-100"></div>
                      </div>
                      <!-- Stacked area chart -->
                      <svg class="absolute inset-0 w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                        <!-- FTA TV layer -->
                        <polygon points="0,100 0,32 16,35 33,38 50,40 66,42 83,44 100,45 100,100" fill="#9333ea" fill-opacity="0.8"/>
                        <!-- VOD layer -->
                        <polygon points="0,32 16,35 33,38 50,40 66,42 83,44 100,45 100,55 83,54 66,52 50,50 33,48 16,45 0,42" fill="#ec4899" fill-opacity="0.8"/>
                        <!-- OOH layer -->
                        <polygon points="0,42 16,45 33,48 50,50 66,52 83,54 100,55 100,70 83,68 66,66 50,64 33,62 16,60 0,57" fill="#22c55e" fill-opacity="0.8"/>
                        <!-- Digital layer -->
                        <polygon points="0,57 16,60 33,62 50,64 66,66 83,68 100,70 100,78 83,77 66,75 50,73 33,71 16,69 0,67" fill="#f97316" fill-opacity="0.8"/>
                        <!-- Combined reach line -->
                        <polyline points="0,22 16,24 33,25 50,26 66,26 83,27 100,22" fill="none" stroke="#1e293b" stroke-width="0.8" stroke-dasharray="2,1"/>
                      </svg>
                    </div>
                    <!-- X-axis labels -->
                    <div class="ml-12 flex justify-between text-xs text-slate-400 mt-1">
                      <span>Wk1</span>
                      <span>Wk4</span>
                      <span>Wk8</span>
                      <span>Wk12</span>
                      <span>Wk16</span>
                      <span>Wk20</span>
                      <span>Wk26</span>
                    </div>
                  </div>
                  <div class="flex items-center justify-center gap-4 mt-4 text-xs">
                    <div class="flex items-center gap-1"><div class="w-3 h-3 rounded-sm bg-purple-600"></div><span>TV</span></div>
                    <div class="flex items-center gap-1"><div class="w-3 h-3 rounded-sm bg-pink-500"></div><span>VOD</span></div>
                    <div class="flex items-center gap-1"><div class="w-3 h-3 rounded-sm bg-green-500"></div><span>OOH</span></div>
                    <div class="flex items-center gap-1"><div class="w-3 h-3 rounded-sm bg-orange-500"></div><span>Digital</span></div>
                    <div class="flex items-center gap-1"><div class="w-3 h-1 bg-slate-800" style="border-style: dashed"></div><span>Combined</span></div>
                  </div>
                </div>

                <!-- Frequency Distribution -->
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <h3 class="font-semibold text-slate-800 mb-4">Frequency Distribution (Combined)</h3>
                  <div class="h-52 flex items-end justify-between gap-3 px-4 pb-6">
                    <div class="flex-1 flex flex-col items-center">
                      <div class="w-full bg-gradient-to-t from-purple-600 to-purple-400 rounded-t relative" style="height: 176px">
                        <span class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-medium">78%</span>
                      </div>
                      <span class="text-xs text-slate-500 mt-2 font-medium">1+</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                      <div class="w-full bg-gradient-to-t from-purple-600 to-purple-400 rounded-t relative" style="height: 162px">
                        <span class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-medium">72%</span>
                      </div>
                      <span class="text-xs text-slate-500 mt-2 font-medium">2+</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                      <div class="w-full bg-gradient-to-t from-purple-600 to-purple-400 rounded-t relative" style="height: 146px">
                        <span class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-medium">65%</span>
                      </div>
                      <span class="text-xs text-slate-500 mt-2 font-medium">3+</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                      <div class="w-full bg-gradient-to-t from-purple-600 to-purple-400 rounded-t relative" style="height: 126px">
                        <span class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-medium">56%</span>
                      </div>
                      <span class="text-xs text-slate-500 mt-2 font-medium">4+</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                      <div class="w-full bg-gradient-to-t from-purple-600 to-purple-400 rounded-t relative" style="height: 101px">
                        <span class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-medium">45%</span>
                      </div>
                      <span class="text-xs text-slate-500 mt-2 font-medium">5+</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                      <div class="w-full bg-gradient-to-t from-purple-600 to-purple-400 rounded-t relative" style="height: 74px">
                        <span class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-medium">33%</span>
                      </div>
                      <span class="text-xs text-slate-500 mt-2 font-medium">6+</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                      <div class="w-full bg-gradient-to-t from-purple-600 to-purple-400 rounded-t relative" style="height: 52px">
                        <span class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-medium">23%</span>
                      </div>
                      <span class="text-xs text-slate-500 mt-2 font-medium">7+</span>
                    </div>
                    <div class="flex-1 flex flex-col items-center">
                      <div class="w-full bg-gradient-to-t from-purple-600 to-purple-400 rounded-t relative" style="height: 34px">
                        <span class="absolute -top-5 left-1/2 -translate-x-1/2 text-xs font-medium">15%</span>
                      </div>
                      <span class="text-xs text-slate-500 mt-2 font-medium">8+</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Flighting -->
          <div class="plan-content hidden" data-plan-content="flighting">
            <div class="space-y-6">
              <!-- Key Metrics Row -->
              <div class="grid grid-cols-5 gap-4">
                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200 text-center">
                  <p class="text-xs text-slate-500 mb-1">Budget</p>
                  <p class="text-xl font-bold text-slate-800">$7.86M</p>
                  <p class="text-xs text-green-600 mt-1">On Track</p>
                </div>
                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200 text-center">
                  <p class="text-xs text-slate-500 mb-1">Reach @4+</p>
                  <p class="text-xl font-bold text-slate-800">56%</p>
                  <p class="text-xs text-green-600 mt-1">+2.1% vs target</p>
                </div>
                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200 text-center">
                  <p class="text-xs text-slate-500 mb-1">Frequency @1+</p>
                  <p class="text-xl font-bold text-slate-800">78%</p>
                  <p class="text-xs text-green-600 mt-1">+1.5% vs target</p>
                </div>
                <div class="bg-purple-50 rounded-xl p-4 border border-purple-200 text-center">
                  <p class="text-xs text-purple-600 mb-1">Avg Awareness</p>
                  <p class="text-xl font-bold text-purple-700">76.5%</p>
                  <p class="text-xs text-green-600 mt-1">+4.2% vs baseline</p>
                </div>
                <div class="bg-green-50 rounded-xl p-4 border border-green-200 text-center">
                  <p class="text-xs text-green-600 mb-1">Sales/Conv Uplift</p>
                  <p class="text-xl font-bold text-green-700">↑2.3%</p>
                  <p class="text-xs text-green-600 mt-1">Predicted</p>
                </div>
              </div>

              <!-- Multi-Media Flighting Optimisation Chart -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-4">
                  <h3 class="font-semibold text-slate-800">Multi-Media Flighting Optimisation</h3>
                  <div class="flex items-center gap-2">
                    <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full">Scenario A - Balanced Mix</span>
                    <button class="px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200">Edit Scenario</button>
                  </div>
                </div>

                <!-- Stacked Bar Chart with Awareness Line -->
                <div class="relative h-72 bg-slate-50 rounded-xl p-4 border border-slate-100">
                  <!-- Y-axis labels (left - spend) -->
                  <div class="absolute left-2 top-4 bottom-12 w-12 flex flex-col justify-between text-xs text-slate-400">
                    <span>$2.5M</span>
                    <span>$2M</span>
                    <span>$1.5M</span>
                    <span>$1M</span>
                    <span>$500K</span>
                    <span>$0</span>
                  </div>
                  <!-- Y-axis labels (right - awareness) -->
                  <div class="absolute right-2 top-4 bottom-12 w-10 flex flex-col justify-between text-xs text-slate-400 text-right">
                    <span>100%</span>
                    <span>80%</span>
                    <span>60%</span>
                    <span>40%</span>
                    <span>20%</span>
                    <span>0%</span>
                  </div>

                  <!-- Chart Area -->
                  <div class="ml-16 mr-14 h-52 relative">
                    <!-- Grid lines -->
                    <div class="absolute inset-0 flex flex-col justify-between">
                      <div class="border-b border-slate-200"></div>
                      <div class="border-b border-slate-100"></div>
                      <div class="border-b border-slate-100"></div>
                      <div class="border-b border-slate-100"></div>
                      <div class="border-b border-slate-100"></div>
                      <div class="border-b border-slate-200"></div>
                    </div>

                    <!-- Stacked Bars -->
                    <div class="absolute inset-0 flex items-end justify-between gap-1 pb-1">
                      <!-- Week 1-8 (Burst phase) -->
                      <div class="flex-1 flex flex-col-reverse" style="height: 92%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 35%"></div>
                        <div class="bg-green-500" style="height: 22%"></div>
                        <div class="bg-cyan-500" style="height: 23%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 88%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 35%"></div>
                        <div class="bg-green-500" style="height: 22%"></div>
                        <div class="bg-cyan-500" style="height: 23%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 90%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 35%"></div>
                        <div class="bg-green-500" style="height: 22%"></div>
                        <div class="bg-cyan-500" style="height: 23%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 85%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 33%"></div>
                        <div class="bg-green-500" style="height: 22%"></div>
                        <div class="bg-cyan-500" style="height: 25%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <!-- Week 5-8 (transition) -->
                      <div class="flex-1 flex flex-col-reverse" style="height: 72%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 30%"></div>
                        <div class="bg-green-500" style="height: 25%"></div>
                        <div class="bg-cyan-500" style="height: 25%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 68%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 28%"></div>
                        <div class="bg-green-500" style="height: 25%"></div>
                        <div class="bg-cyan-500" style="height: 27%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 65%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 28%"></div>
                        <div class="bg-green-500" style="height: 24%"></div>
                        <div class="bg-cyan-500" style="height: 28%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 60%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 26%"></div>
                        <div class="bg-green-500" style="height: 26%"></div>
                        <div class="bg-cyan-500" style="height: 28%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <!-- Week 9-12 (sustain) -->
                      <div class="flex-1 flex flex-col-reverse" style="height: 55%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 25%"></div>
                        <div class="bg-green-500" style="height: 27%"></div>
                        <div class="bg-cyan-500" style="height: 28%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 52%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 24%"></div>
                        <div class="bg-green-500" style="height: 28%"></div>
                        <div class="bg-cyan-500" style="height: 28%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 50%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 24%"></div>
                        <div class="bg-green-500" style="height: 28%"></div>
                        <div class="bg-cyan-500" style="height: 28%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                      <div class="flex-1 flex flex-col-reverse" style="height: 48%">
                        <div class="bg-purple-600 rounded-t-sm" style="height: 24%"></div>
                        <div class="bg-green-500" style="height: 28%"></div>
                        <div class="bg-cyan-500" style="height: 28%"></div>
                        <div class="bg-pink-500" style="height: 20%"></div>
                      </div>
                    </div>

                    <!-- Awareness Line Overlay - smooth line only, no dots -->
                    <svg class="absolute inset-0 w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none" style="pointer-events: none;">
                      <!-- Smooth awareness curve using bezier path - no data points -->
                      <path
                        d="M4,75 C8,70 10,65 12,62 S17,55 21,52 S25,47 29,44 S33,40 37,38 S42,36 46,34 S50,32 54,31 S58,29 62,28 S67,27 71,26 S75,25 79,25 S83,24 87,24 S92,23 96,23"
                        fill="none"
                        stroke="#f59e0b"
                        stroke-width="2.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        vector-effect="non-scaling-stroke"/>
                    </svg>
                  </div>

                  <!-- X-axis labels -->
                  <div class="ml-16 mr-14 flex justify-between text-xs text-slate-400 mt-2">
                    <span>Wk1</span>
                    <span>Wk2</span>
                    <span>Wk3</span>
                    <span>Wk4</span>
                    <span>Wk5</span>
                    <span>Wk6</span>
                    <span>Wk7</span>
                    <span>Wk8</span>
                    <span>Wk9</span>
                    <span>Wk10</span>
                    <span>Wk11</span>
                    <span>Wk12</span>
                  </div>
                </div>

                <!-- Legend -->
                <div class="flex items-center justify-center gap-6 mt-4">
                  <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-sm bg-purple-600"></div><span class="text-xs text-slate-600">FTA TV</span></div>
                  <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-sm bg-green-500"></div><span class="text-xs text-slate-600">OOH</span></div>
                  <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-sm bg-cyan-500"></div><span class="text-xs text-slate-600">Social/Digital</span></div>
                  <div class="flex items-center gap-2"><div class="w-3 h-3 rounded-sm bg-pink-500"></div><span class="text-xs text-slate-600">VOD</span></div>
                  <div class="flex items-center gap-2"><div class="w-4 h-0.5 rounded-full bg-amber-500"></div><span class="text-xs text-slate-600">Awareness</span></div>
                </div>
              </div>

              <!-- Flighting Strategy & Constraints -->
              <div class="grid grid-cols-2 gap-6">
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <h4 class="font-medium text-slate-800 mb-4">Flighting Strategy</h4>
                  <div class="space-y-4">
                    <div class="flex items-start gap-3">
                      <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center shrink-0">
                        <span class="text-purple-600 font-bold text-sm">1</span>
                      </div>
                      <div>
                        <p class="font-medium text-slate-800">Launch Phase (Wk 1-4)</p>
                        <p class="text-sm text-slate-500">Heavy TV + OOH burst for maximum awareness</p>
                      </div>
                    </div>
                    <div class="flex items-start gap-3">
                      <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center shrink-0">
                        <span class="text-purple-600 font-bold text-sm">2</span>
                      </div>
                      <div>
                        <p class="font-medium text-slate-800">Transition Phase (Wk 5-8)</p>
                        <p class="text-sm text-slate-500">Gradual shift to digital & social channels</p>
                      </div>
                    </div>
                    <div class="flex items-start gap-3">
                      <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center shrink-0">
                        <span class="text-purple-600 font-bold text-sm">3</span>
                      </div>
                      <div>
                        <p class="font-medium text-slate-800">Sustain Phase (Wk 9-12)</p>
                        <p class="text-sm text-slate-500">Balanced mix for maintaining awareness</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="bg-amber-50 rounded-2xl p-6 border border-amber-100">
                  <h4 class="font-medium text-amber-800 mb-4">Active Constraints</h4>
                  <div class="space-y-2">
                    <div class="flex items-center gap-2 bg-white rounded-lg px-3 py-2 border border-amber-200">
                      <svg class="w-4 h-4 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                      <span class="text-sm text-amber-800">TV: Min 25% allocation</span>
                    </div>
                    <div class="flex items-center gap-2 bg-white rounded-lg px-3 py-2 border border-amber-200">
                      <svg class="w-4 h-4 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                      <span class="text-sm text-amber-800">OOH: Max 30% allocation</span>
                    </div>
                    <div class="flex items-center gap-2 bg-white rounded-lg px-3 py-2 border border-amber-200">
                      <svg class="w-4 h-4 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                      <span class="text-sm text-amber-800">Burst: Weeks 1-4 @ 150% base</span>
                    </div>
                    <div class="flex items-center gap-2 bg-white rounded-lg px-3 py-2 border border-amber-200">
                      <svg class="w-4 h-4 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                      <span class="text-sm text-amber-800">Target Awareness: 75%+</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Integrated Cultural Calendar - Scrollable Weekly View -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-4">
                  <div>
                    <h3 class="font-semibold text-slate-800">Cultural Calendar & Media Flighting</h3>
                    <p class="text-sm text-slate-500">26-week campaign timeline with key cultural moments</p>
                  </div>
                  <div class="flex items-center gap-4">
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                      <span class="text-xs text-slate-600">Sports</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-green-500"></div>
                      <span class="text-xs text-slate-600">Retail</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-amber-500"></div>
                      <span class="text-xs text-slate-600">Cultural</span>
                    </div>
                  </div>
                </div>

                <!-- Scrollable Calendar Container -->
                <div class="relative">
                  <div class="absolute right-0 top-0 bottom-0 w-16 bg-gradient-to-l from-white via-white/80 to-transparent z-10 pointer-events-none flex items-center justify-end pr-2">
                    <svg class="w-5 h-5 text-slate-400 animate-pulse" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                  </div>
                  <div class="overflow-x-auto pb-4" style="scrollbar-width: thin; scrollbar-color: #a855f7 #f1f5f9;">
                    <table class="border-collapse" style="min-width: 1500px;">
                      <!-- Month Headers -->
                      <thead>
                        <tr>
                          <th class="w-24 p-0"></th>
                          <th colspan="4" class="text-center text-xs font-semibold text-purple-700 py-2 bg-purple-50 border-b-2 border-purple-400">January</th>
                          <th colspan="4" class="text-center text-xs font-semibold text-purple-700 py-2 bg-purple-50 border-b-2 border-purple-400">February</th>
                          <th colspan="5" class="text-center text-xs font-semibold text-purple-700 py-2 bg-purple-50 border-b-2 border-purple-400">March</th>
                          <th colspan="4" class="text-center text-xs font-semibold text-purple-700 py-2 bg-purple-50 border-b-2 border-purple-400">April</th>
                          <th colspan="4" class="text-center text-xs font-semibold text-purple-700 py-2 bg-purple-50 border-b-2 border-purple-400">May</th>
                          <th colspan="5" class="text-center text-xs font-semibold text-purple-700 py-2 bg-purple-50 border-b-2 border-purple-400">June</th>
                        </tr>
                        <!-- Week Numbers Row -->
                        <tr class="bg-slate-50">
                          <th class="text-right pr-3 py-2 text-xs font-medium text-slate-500">Week</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-200">1</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">2</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">3</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">4</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-200">5</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">6</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">7</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">8</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-200">9</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">10</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">11</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">12</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">13</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-200">14</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">15</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">16</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">17</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-200">18</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">19</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">20</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">21</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-200">22</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">23</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">24</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">25</th>
                          <th class="w-12 text-center text-xs text-slate-500 py-2 border-l border-slate-100">26</th>
                        </tr>
                      </thead>
                      <tbody>
                        <!-- Cultural Events Row -->
                        <tr class="bg-amber-50/50">
                          <td class="text-right pr-3 py-1 text-xs font-semibold text-amber-700">Events</td>
                          <td class="border-l border-slate-200 p-0.5"></td>
                          <td colspan="2" class="p-0.5"><div class="bg-blue-100 border border-blue-300 rounded text-[10px] text-blue-700 px-1 py-0.5 text-center truncate" title="Australian Open">🎾 Aus Open</div></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td class="border-l border-slate-200 p-0.5"></td>
                          <td class="p-0.5"><div class="bg-blue-100 border border-blue-300 rounded text-[10px] text-blue-700 px-1 py-0.5 text-center" title="Super Bowl">🏈</div></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="bg-amber-100 border border-amber-300 rounded text-[10px] text-amber-700 px-1 py-0.5 text-center" title="Mardi Gras">🌈</div></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td colspan="2" class="p-0.5"><div class="bg-amber-100 border border-amber-300 rounded text-[10px] text-amber-700 px-1 py-0.5 text-center" title="Easter">🐣 Easter</div></td>
                          <td class="border-l border-slate-200 p-0.5"></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td class="p-0.5"><div class="bg-amber-100 border border-amber-300 rounded text-[10px] text-amber-700 px-1 py-0.5 text-center" title="ANZAC Day">🎖️</div></td>
                          <td class="border-l border-slate-200 p-0.5"></td>
                          <td class="p-0.5"><div class="bg-green-100 border border-green-300 rounded text-[10px] text-green-700 px-1 py-0.5 text-center" title="Mother's Day">💐</div></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td colspan="2" class="border-l border-slate-200 p-0.5"><div class="bg-blue-100 border border-blue-300 rounded text-[10px] text-blue-700 px-1 py-0.5 text-center" title="State of Origin">🏉 Origin</div></td>
                          <td class="border-l border-slate-100 p-0.5"></td>
                          <td colspan="2" class="p-0.5"><div class="bg-green-100 border border-green-300 rounded text-[10px] text-green-700 px-1 py-0.5 text-center" title="EOFY">💰 EOFY</div></td>
                        </tr>
                        <!-- FTA TV Row -->
                        <tr>
                          <td class="text-right pr-3 py-1 text-xs font-medium text-purple-700 bg-purple-50/50">FTA TV</td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-purple-600 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-600 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-600 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-600 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-purple-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-purple-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-purple-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-purple-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-purple-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-600 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-purple-600 rounded-sm"></div></td>
                        </tr>
                        <!-- BVOD Row -->
                        <tr class="bg-slate-50/50">
                          <td class="text-right pr-3 py-1 text-xs font-medium text-pink-700 bg-pink-50/50">BVOD</td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-pink-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-pink-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-300 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-pink-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-pink-500 rounded-sm"></div></td>
                        </tr>
                        <!-- OOH Row -->
                        <tr>
                          <td class="text-right pr-3 py-1 text-xs font-medium text-green-700 bg-green-50/50">OOH</td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-600 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-green-600 rounded-sm"></div></td>
                        </tr>
                        <!-- Social Row -->
                        <tr class="bg-slate-50/50">
                          <td class="text-right pr-3 py-1 text-xs font-medium text-blue-700 bg-blue-50/50">Social</td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-600 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-blue-600 rounded-sm"></div></td>
                        </tr>
                        <!-- Programmatic Row -->
                        <tr>
                          <td class="text-right pr-3 py-1 text-xs font-medium text-cyan-700 bg-cyan-50/50">Prog.</td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-400 rounded-sm"></div></td>
                          <td class="border-l border-slate-200 p-0.5"><div class="h-5 bg-cyan-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-500 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-600 rounded-sm"></div></td>
                          <td class="border-l border-slate-100 p-0.5"><div class="h-5 bg-cyan-600 rounded-sm"></div></td>
                        </tr>
                        <!-- Spend Intensity Row -->
                        <tr class="border-t-2 border-slate-300">
                          <td class="text-right pr-3 py-1 text-xs font-semibold text-slate-600">Weekly $</td>
                          <td class="border-l border-slate-200 p-0.5 text-center text-[9px] text-slate-500">$380K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$375K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$365K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$350K</td>
                          <td class="border-l border-slate-200 p-0.5 text-center text-[9px] text-slate-500">$320K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$310K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$290K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$280K</td>
                          <td class="border-l border-slate-200 p-0.5 text-center text-[9px] text-slate-500">$260K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$255K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$270K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$295K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$275K</td>
                          <td class="border-l border-slate-200 p-0.5 text-center text-[9px] text-slate-500">$250K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$245K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$240K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$260K</td>
                          <td class="border-l border-slate-200 p-0.5 text-center text-[9px] text-slate-500">$235K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$270K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$240K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$235K</td>
                          <td class="border-l border-slate-200 p-0.5 text-center text-[9px] text-slate-500">$310K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$305K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$290K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$360K</td>
                          <td class="border-l border-slate-100 p-0.5 text-center text-[9px] text-slate-500">$355K</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                <!-- Calendar Legend -->
                <div class="flex items-center justify-between mt-4 pt-4 border-t border-slate-100">
                  <div class="flex items-center gap-4">
                    <div class="flex items-center gap-2"><div class="w-4 h-3 rounded-sm bg-purple-600"></div><span class="text-xs text-slate-600">FTA TV</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-3 rounded-sm bg-pink-500"></div><span class="text-xs text-slate-600">BVOD</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-3 rounded-sm bg-green-500"></div><span class="text-xs text-slate-600">OOH</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-3 rounded-sm bg-blue-500"></div><span class="text-xs text-slate-600">Social</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-3 rounded-sm bg-cyan-500"></div><span class="text-xs text-slate-600">Programmatic</span></div>
                  </div>
                  <div class="flex items-center gap-3">
                    <span class="text-xs text-slate-400">Intensity:</span>
                    <div class="flex items-center gap-1">
                      <div class="w-3 h-3 rounded-sm bg-purple-300"></div>
                      <div class="w-3 h-3 rounded-sm bg-purple-400"></div>
                      <div class="w-3 h-3 rounded-sm bg-purple-500"></div>
                      <div class="w-3 h-3 rounded-sm bg-purple-600"></div>
                    </div>
                    <span class="text-xs text-slate-400">Low → High</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Mapping -->
          <div class="plan-content hidden" data-plan-content="mapping">
            <!-- Summary Header -->
            <div class="bg-gradient-to-r from-purple-600 to-indigo-600 rounded-2xl p-4 mb-6 text-white">
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="text-lg font-semibold mb-1">Geographic Investment Mapping</h3>
                  <p class="text-purple-100 text-sm">Spend allocation and population coverage across Australian markets</p>
                </div>
                <div class="flex gap-6">
                  <div class="text-center">
                    <p class="text-2xl font-bold">$7.86M</p>
                    <p class="text-xs text-purple-200">Total Regional Spend</p>
                  </div>
                  <div class="text-center">
                    <p class="text-2xl font-bold">8</p>
                    <p class="text-xs text-purple-200">Regions Active</p>
                  </div>
                  <div class="text-center">
                    <p class="text-2xl font-bold">94%</p>
                    <p class="text-xs text-purple-200">Population Coverage</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="grid grid-cols-3 gap-6">
              <!-- Interactive Map -->
              <div class="col-span-2 bg-white rounded-2xl border border-slate-200 shadow-sm p-5">
                <div class="flex items-center justify-between mb-4">
                  <h4 class="font-semibold text-slate-800">Investment Density Heatmap</h4>
                  <div class="flex items-center gap-2">
                    <span class="text-xs text-slate-500">Investment Intensity:</span>
                    <div class="flex items-center gap-1">
                      <div class="w-4 h-3 rounded-sm bg-purple-100"></div>
                      <div class="w-4 h-3 rounded-sm bg-purple-300"></div>
                      <div class="w-4 h-3 rounded-sm bg-purple-500"></div>
                      <div class="w-4 h-3 rounded-sm bg-purple-700"></div>
                      <div class="w-4 h-3 rounded-sm bg-purple-900"></div>
                    </div>
                    <span class="text-xs text-slate-400">Low → High</span>
                  </div>
                </div>

                <!-- Australia Map SVG with Heatmap -->
                <div class="relative">
                  <svg viewBox="0 0 600 500" class="w-full h-auto">
                    <!-- Western Australia - Medium intensity -->
                    <path id="region-wa" class="region-path cursor-pointer transition-all duration-200 hover:brightness-110"
                          fill="#a855f7" stroke="#7c3aed" stroke-width="1.5"
                          d="M50,120 L180,100 L200,140 L210,280 L190,380 L100,400 L60,350 L40,250 L50,120 Z"
                          onmouseover="showRegionTooltip(event, 'WA', '$786,000', '10%', '2.4M')"
                          onmouseout="hideRegionTooltip()"/>
                    <text x="110" y="250" class="text-xs font-bold fill-white pointer-events-none">WA</text>

                    <!-- Northern Territory - Low intensity -->
                    <path id="region-nt" class="region-path cursor-pointer transition-all duration-200 hover:brightness-110"
                          fill="#c4b5fd" stroke="#7c3aed" stroke-width="1.5"
                          d="M200,100 L300,90 L310,120 L300,250 L210,280 L200,140 Z"
                          onmouseover="showRegionTooltip(event, 'NT', '$157,000', '2%', '250K')"
                          onmouseout="hideRegionTooltip()"/>
                    <text x="240" y="180" class="text-xs font-bold fill-purple-800 pointer-events-none">NT</text>

                    <!-- South Australia - Medium intensity -->
                    <path id="region-sa" class="region-path cursor-pointer transition-all duration-200 hover:brightness-110"
                          fill="#a855f7" stroke="#7c3aed" stroke-width="1.5"
                          d="M210,280 L300,250 L340,280 L360,380 L280,420 L190,380 Z"
                          onmouseover="showRegionTooltip(event, 'SA', '$628,000', '8%', '1.8M')"
                          onmouseout="hideRegionTooltip()"/>
                    <text x="270" y="340" class="text-xs font-bold fill-white pointer-events-none">SA</text>

                    <!-- Queensland - High intensity -->
                    <path id="region-qld" class="region-path cursor-pointer transition-all duration-200 hover:brightness-110"
                          fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"
                          d="M310,90 L480,70 L500,120 L490,200 L430,280 L340,280 L300,250 L310,120 Z"
                          onmouseover="showRegionTooltip(event, 'QLD', '$1,728,000', '22%', '5.2M')"
                          onmouseout="hideRegionTooltip()"/>
                    <text x="390" y="170" class="text-xs font-bold fill-white pointer-events-none">QLD</text>

                    <!-- New South Wales - Highest intensity -->
                    <path id="region-nsw" class="region-path cursor-pointer transition-all duration-200 hover:brightness-110"
                          fill="#581c87" stroke="#3b0764" stroke-width="1.5"
                          d="M340,280 L430,280 L480,320 L470,400 L400,420 L360,380 Z"
                          onmouseover="showRegionTooltip(event, 'NSW', '$2,513,000', '32%', '8.2M')"
                          onmouseout="hideRegionTooltip()"/>
                    <text x="400" y="350" class="text-xs font-bold fill-white pointer-events-none">NSW</text>

                    <!-- ACT - Medium-High intensity (small circle) -->
                    <circle id="region-act" class="region-path cursor-pointer transition-all duration-200 hover:brightness-110"
                            cx="445" cy="380" r="12"
                            fill="#7c3aed" stroke="#5b21b6" stroke-width="1.5"
                            onmouseover="showRegionTooltip(event, 'ACT', '$314,000', '4%', '460K')"
                            onmouseout="hideRegionTooltip()"/>
                    <text x="445" y="384" class="text-[8px] font-bold fill-white pointer-events-none text-anchor-middle" text-anchor="middle">ACT</text>

                    <!-- Victoria - Very High intensity -->
                    <path id="region-vic" class="region-path cursor-pointer transition-all duration-200 hover:brightness-110"
                          fill="#6b21a8" stroke="#4c1d95" stroke-width="1.5"
                          d="M280,420 L360,380 L400,420 L440,430 L420,470 L320,480 L280,450 Z"
                          onmouseover="showRegionTooltip(event, 'VIC', '$2,200,000', '28%', '6.7M')"
                          onmouseout="hideRegionTooltip()"/>
                    <text x="350" y="440" class="text-xs font-bold fill-white pointer-events-none">VIC</text>

                    <!-- Tasmania - Low intensity -->
                    <path id="region-tas" class="region-path cursor-pointer transition-all duration-200 hover:brightness-110"
                          fill="#c4b5fd" stroke="#7c3aed" stroke-width="1.5"
                          d="M380,490 L420,485 L435,510 L420,540 L380,545 L365,520 Z"
                          onmouseover="showRegionTooltip(event, 'TAS', '$235,000', '3%', '550K')"
                          onmouseout="hideRegionTooltip()"/>
                    <text x="400" y="518" class="text-[10px] font-bold fill-purple-800 pointer-events-none">TAS</text>

                    <!-- City markers -->
                    <circle cx="430" cy="345" r="5" fill="#f59e0b" stroke="white" stroke-width="2"/>
                    <text x="442" y="348" class="text-[9px] fill-slate-600">Sydney</text>

                    <circle cx="370" cy="450" r="5" fill="#f59e0b" stroke="white" stroke-width="2"/>
                    <text x="382" y="453" class="text-[9px] fill-slate-600">Melbourne</text>

                    <circle cx="470" cy="180" r="4" fill="#f59e0b" stroke="white" stroke-width="1.5"/>
                    <text x="480" y="183" class="text-[9px] fill-slate-600">Brisbane</text>

                    <circle cx="100" cy="320" r="4" fill="#f59e0b" stroke="white" stroke-width="1.5"/>
                    <text x="75" y="335" class="text-[9px] fill-slate-600">Perth</text>

                    <circle cx="295" cy="395" r="4" fill="#f59e0b" stroke="white" stroke-width="1.5"/>
                    <text x="275" y="410" class="text-[9px] fill-slate-600">Adelaide</text>
                  </svg>

                  <!-- Tooltip -->
                  <div id="regionTooltip" class="absolute hidden bg-slate-800 text-white rounded-lg px-4 py-3 text-sm shadow-xl z-10 pointer-events-none" style="min-width: 180px;">
                    <div class="font-semibold text-base mb-2" id="tooltipRegion">NSW</div>
                    <div class="space-y-1">
                      <div class="flex justify-between"><span class="text-slate-300">Investment:</span><span class="font-medium text-green-400" id="tooltipSpend">$2,513,000</span></div>
                      <div class="flex justify-between"><span class="text-slate-300">Share:</span><span class="font-medium" id="tooltipShare">32%</span></div>
                      <div class="flex justify-between"><span class="text-slate-300">Population:</span><span class="font-medium" id="tooltipPop">8.2M</span></div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Regional Breakdown Table -->
              <div class="bg-white rounded-2xl border border-slate-200 shadow-sm p-5">
                <h4 class="font-semibold text-slate-800 mb-4">Spend Breakdown by Region</h4>
                <div class="space-y-3">
                  <!-- NSW -->
                  <div class="flex items-center gap-3 p-3 bg-purple-50 rounded-xl border border-purple-100">
                    <div class="w-10 h-10 rounded-lg bg-purple-900 flex items-center justify-center">
                      <span class="text-xs font-bold text-white">NSW</span>
                    </div>
                    <div class="flex-1">
                      <div class="flex justify-between items-center mb-1">
                        <span class="font-medium text-slate-800">New South Wales</span>
                        <span class="font-bold text-purple-700">$2.51M</span>
                      </div>
                      <div class="w-full bg-purple-200 rounded-full h-2">
                        <div class="bg-purple-700 h-2 rounded-full" style="width: 32%"></div>
                      </div>
                      <div class="flex justify-between mt-1">
                        <span class="text-xs text-slate-500">32% of total</span>
                        <span class="text-xs text-slate-500">8.2M pop</span>
                      </div>
                    </div>
                  </div>

                  <!-- VIC -->
                  <div class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100">
                    <div class="w-10 h-10 rounded-lg bg-purple-700 flex items-center justify-center">
                      <span class="text-xs font-bold text-white">VIC</span>
                    </div>
                    <div class="flex-1">
                      <div class="flex justify-between items-center mb-1">
                        <span class="font-medium text-slate-800">Victoria</span>
                        <span class="font-bold text-purple-600">$2.20M</span>
                      </div>
                      <div class="w-full bg-purple-200 rounded-full h-2">
                        <div class="bg-purple-600 h-2 rounded-full" style="width: 28%"></div>
                      </div>
                      <div class="flex justify-between mt-1">
                        <span class="text-xs text-slate-500">28% of total</span>
                        <span class="text-xs text-slate-500">6.7M pop</span>
                      </div>
                    </div>
                  </div>

                  <!-- QLD -->
                  <div class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100">
                    <div class="w-10 h-10 rounded-lg bg-purple-600 flex items-center justify-center">
                      <span class="text-xs font-bold text-white">QLD</span>
                    </div>
                    <div class="flex-1">
                      <div class="flex justify-between items-center mb-1">
                        <span class="font-medium text-slate-800">Queensland</span>
                        <span class="font-bold text-purple-500">$1.73M</span>
                      </div>
                      <div class="w-full bg-purple-200 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full" style="width: 22%"></div>
                      </div>
                      <div class="flex justify-between mt-1">
                        <span class="text-xs text-slate-500">22% of total</span>
                        <span class="text-xs text-slate-500">5.2M pop</span>
                      </div>
                    </div>
                  </div>

                  <!-- WA -->
                  <div class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100">
                    <div class="w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center">
                      <span class="text-xs font-bold text-white">WA</span>
                    </div>
                    <div class="flex-1">
                      <div class="flex justify-between items-center mb-1">
                        <span class="font-medium text-slate-800">Western Australia</span>
                        <span class="font-bold text-purple-500">$786K</span>
                      </div>
                      <div class="w-full bg-purple-200 rounded-full h-2">
                        <div class="bg-purple-400 h-2 rounded-full" style="width: 10%"></div>
                      </div>
                      <div class="flex justify-between mt-1">
                        <span class="text-xs text-slate-500">10% of total</span>
                        <span class="text-xs text-slate-500">2.4M pop</span>
                      </div>
                    </div>
                  </div>

                  <!-- SA -->
                  <div class="flex items-center gap-3 p-3 bg-slate-50 rounded-xl border border-slate-100">
                    <div class="w-10 h-10 rounded-lg bg-purple-400 flex items-center justify-center">
                      <span class="text-xs font-bold text-white">SA</span>
                    </div>
                    <div class="flex-1">
                      <div class="flex justify-between items-center mb-1">
                        <span class="font-medium text-slate-800">South Australia</span>
                        <span class="font-bold text-purple-400">$628K</span>
                      </div>
                      <div class="w-full bg-purple-200 rounded-full h-2">
                        <div class="bg-purple-300 h-2 rounded-full" style="width: 8%"></div>
                      </div>
                      <div class="flex justify-between mt-1">
                        <span class="text-xs text-slate-500">8% of total</span>
                        <span class="text-xs text-slate-500">1.8M pop</span>
                      </div>
                    </div>
                  </div>

                  <!-- Other Regions -->
                  <div class="pt-2 border-t border-slate-200">
                    <div class="text-xs text-slate-500 mb-2">Other Regions</div>
                    <div class="grid grid-cols-3 gap-2">
                      <div class="bg-slate-50 rounded-lg p-2 text-center">
                        <span class="text-xs font-medium text-slate-700">ACT</span>
                        <p class="text-sm font-bold text-slate-800">$314K</p>
                      </div>
                      <div class="bg-slate-50 rounded-lg p-2 text-center">
                        <span class="text-xs font-medium text-slate-700">TAS</span>
                        <p class="text-sm font-bold text-slate-800">$235K</p>
                      </div>
                      <div class="bg-slate-50 rounded-lg p-2 text-center">
                        <span class="text-xs font-medium text-slate-700">NT</span>
                        <p class="text-sm font-bold text-slate-800">$157K</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Channel Distribution by Region -->
            <div class="mt-6 bg-white rounded-2xl border border-slate-200 shadow-sm p-5">
              <h4 class="font-semibold text-slate-800 mb-4">Channel Distribution by Region</h4>
              <div class="overflow-x-auto">
                <table class="w-full text-sm">
                  <thead>
                    <tr class="border-b border-slate-200">
                      <th class="text-left py-3 px-3 font-semibold text-slate-700">Region</th>
                      <th class="text-center py-3 px-2 font-medium text-slate-600">
                        <div class="flex flex-col items-center gap-1">
                          <div class="w-6 h-6 rounded bg-purple-100 flex items-center justify-center"><svg class="w-3 h-3 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2"/><polyline points="17 2 12 7 7 2"/></svg></div>
                          <span class="text-[10px]">TV</span>
                        </div>
                      </th>
                      <th class="text-center py-3 px-2 font-medium text-slate-600">
                        <div class="flex flex-col items-center gap-1">
                          <div class="w-6 h-6 rounded bg-blue-100 flex items-center justify-center"><svg class="w-3 h-3 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg></div>
                          <span class="text-[10px]">Digital</span>
                        </div>
                      </th>
                      <th class="text-center py-3 px-2 font-medium text-slate-600">
                        <div class="flex flex-col items-center gap-1">
                          <div class="w-6 h-6 rounded bg-pink-100 flex items-center justify-center"><svg class="w-3 h-3 text-pink-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg></div>
                          <span class="text-[10px]">Social</span>
                        </div>
                      </th>
                      <th class="text-center py-3 px-2 font-medium text-slate-600">
                        <div class="flex flex-col items-center gap-1">
                          <div class="w-6 h-6 rounded bg-green-100 flex items-center justify-center"><svg class="w-3 h-3 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg></div>
                          <span class="text-[10px]">OOH</span>
                        </div>
                      </th>
                      <th class="text-center py-3 px-2 font-medium text-slate-600">
                        <div class="flex flex-col items-center gap-1">
                          <div class="w-6 h-6 rounded bg-amber-100 flex items-center justify-center"><svg class="w-3 h-3 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg></div>
                          <span class="text-[10px]">BVOD</span>
                        </div>
                      </th>
                      <th class="text-center py-3 px-2 font-medium text-slate-600">
                        <div class="flex flex-col items-center gap-1">
                          <div class="w-6 h-6 rounded bg-cyan-100 flex items-center justify-center"><svg class="w-3 h-3 text-cyan-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="2"/><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"/></svg></div>
                          <span class="text-[10px]">Radio</span>
                        </div>
                      </th>
                      <th class="text-right py-3 px-3 font-semibold text-slate-700">Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="border-b border-slate-100 bg-purple-50">
                      <td class="py-3 px-3"><span class="font-semibold text-slate-800">NSW</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-purple-700">$850K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-blue-700">$520K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-pink-700">$380K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-green-700">$420K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-amber-700">$220K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-cyan-700">$123K</span></td>
                      <td class="py-3 px-3 text-right"><span class="font-bold text-purple-800">$2.51M</span></td>
                    </tr>
                    <tr class="border-b border-slate-100">
                      <td class="py-3 px-3"><span class="font-semibold text-slate-800">VIC</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-purple-700">$720K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-blue-700">$480K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-pink-700">$340K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-green-700">$380K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-amber-700">$180K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-cyan-700">$100K</span></td>
                      <td class="py-3 px-3 text-right"><span class="font-bold text-purple-700">$2.20M</span></td>
                    </tr>
                    <tr class="border-b border-slate-100">
                      <td class="py-3 px-3"><span class="font-semibold text-slate-800">QLD</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-purple-700">$560K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-blue-700">$380K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-pink-700">$280K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-green-700">$290K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-amber-700">$140K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-cyan-700">$80K</span></td>
                      <td class="py-3 px-3 text-right"><span class="font-bold text-purple-600">$1.73M</span></td>
                    </tr>
                    <tr class="border-b border-slate-100">
                      <td class="py-3 px-3"><span class="font-semibold text-slate-800">WA</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-purple-700">$250K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-blue-700">$180K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-pink-700">$130K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-green-700">$120K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-amber-700">$66K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-cyan-700">$40K</span></td>
                      <td class="py-3 px-3 text-right"><span class="font-bold text-purple-500">$786K</span></td>
                    </tr>
                    <tr class="border-b border-slate-100">
                      <td class="py-3 px-3"><span class="font-semibold text-slate-800">SA</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-purple-700">$200K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-blue-700">$140K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-pink-700">$100K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-green-700">$100K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-amber-700">$55K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-cyan-700">$33K</span></td>
                      <td class="py-3 px-3 text-right"><span class="font-bold text-purple-400">$628K</span></td>
                    </tr>
                    <tr class="border-b border-slate-100 bg-slate-50">
                      <td class="py-3 px-3"><span class="font-medium text-slate-600">ACT/TAS/NT</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-purple-600">$220K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-blue-600">$160K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-pink-600">$120K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-green-600">$90K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-amber-600">$69K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-medium text-cyan-600">$47K</span></td>
                      <td class="py-3 px-3 text-right"><span class="font-bold text-slate-600">$706K</span></td>
                    </tr>
                  </tbody>
                  <tfoot>
                    <tr class="border-t-2 border-purple-200 bg-purple-100">
                      <td class="py-3 px-3"><span class="font-bold text-slate-800">TOTAL</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-bold text-purple-800">$2.80M</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-bold text-blue-800">$1.86M</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-bold text-pink-800">$1.35M</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-bold text-green-800">$1.40M</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-bold text-amber-800">$730K</span></td>
                      <td class="py-3 px-2 text-center"><span class="text-xs font-bold text-cyan-800">$423K</span></td>
                      <td class="py-3 px-3 text-right"><span class="font-bold text-purple-900">$8.56M</span></td>
                    </tr>
                  </tfoot>
                </table>
              </div>

              <!-- Channel Mix by Region Visualization -->
              <div class="mt-6 grid grid-cols-3 gap-4">
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 border border-purple-200">
                  <h5 class="text-xs font-semibold text-purple-800 mb-3">Metro Markets Channel Mix</h5>
                  <div class="space-y-2">
                    <div class="flex items-center gap-2">
                      <div class="flex-1 h-3 bg-purple-200 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-600 rounded-full" style="width: 38%"></div>
                      </div>
                      <span class="text-[10px] font-medium text-purple-700 w-8">TV 38%</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="flex-1 h-3 bg-blue-200 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-500 rounded-full" style="width: 24%"></div>
                      </div>
                      <span class="text-[10px] font-medium text-blue-700 w-8">Dig 24%</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="flex-1 h-3 bg-green-200 rounded-full overflow-hidden">
                        <div class="h-full bg-green-500 rounded-full" style="width: 22%"></div>
                      </div>
                      <span class="text-[10px] font-medium text-green-700 w-8">OOH 22%</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="flex-1 h-3 bg-pink-200 rounded-full overflow-hidden">
                        <div class="h-full bg-pink-500 rounded-full" style="width: 16%"></div>
                      </div>
                      <span class="text-[10px] font-medium text-pink-700 w-8">Soc 16%</span>
                    </div>
                  </div>
                </div>

                <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-xl p-4 border border-indigo-200">
                  <h5 class="text-xs font-semibold text-indigo-800 mb-3">Regional Markets Channel Mix</h5>
                  <div class="space-y-2">
                    <div class="flex items-center gap-2">
                      <div class="flex-1 h-3 bg-purple-200 rounded-full overflow-hidden">
                        <div class="h-full bg-purple-600 rounded-full" style="width: 45%"></div>
                      </div>
                      <span class="text-[10px] font-medium text-purple-700 w-8">TV 45%</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="flex-1 h-3 bg-cyan-200 rounded-full overflow-hidden">
                        <div class="h-full bg-cyan-500 rounded-full" style="width: 18%"></div>
                      </div>
                      <span class="text-[10px] font-medium text-cyan-700 w-8">Rad 18%</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="flex-1 h-3 bg-blue-200 rounded-full overflow-hidden">
                        <div class="h-full bg-blue-500 rounded-full" style="width: 20%"></div>
                      </div>
                      <span class="text-[10px] font-medium text-blue-700 w-8">Dig 20%</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="flex-1 h-3 bg-green-200 rounded-full overflow-hidden">
                        <div class="h-full bg-green-500 rounded-full" style="width: 17%"></div>
                      </div>
                      <span class="text-[10px] font-medium text-green-700 w-8">OOH 17%</span>
                    </div>
                  </div>
                </div>

                <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200">
                  <h5 class="text-xs font-semibold text-slate-800 mb-3">Key Regional Insights</h5>
                  <div class="space-y-2">
                    <div class="flex items-start gap-2">
                      <div class="w-4 h-4 rounded bg-green-100 flex items-center justify-center shrink-0 mt-0.5">
                        <svg class="w-2.5 h-2.5 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
                      </div>
                      <p class="text-[10px] text-slate-600">Higher TV weight in regional markets for broader reach</p>
                    </div>
                    <div class="flex items-start gap-2">
                      <div class="w-4 h-4 rounded bg-green-100 flex items-center justify-center shrink-0 mt-0.5">
                        <svg class="w-2.5 h-2.5 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
                      </div>
                      <p class="text-[10px] text-slate-600">Radio leveraged more in regional for local relevance</p>
                    </div>
                    <div class="flex items-start gap-2">
                      <div class="w-4 h-4 rounded bg-green-100 flex items-center justify-center shrink-0 mt-0.5">
                        <svg class="w-2.5 h-2.5 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
                      </div>
                      <p class="text-[10px] text-slate-600">OOH concentrated in metro high-traffic areas</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Investment per Capita Analysis -->
            <div class="mt-6 bg-white rounded-2xl border border-slate-200 shadow-sm p-5">
              <h4 class="font-semibold text-slate-800 mb-4">Investment Efficiency Analysis</h4>
              <div class="grid grid-cols-8 gap-4">
                <div class="text-center">
                  <div class="h-32 bg-gradient-to-t from-purple-600 to-purple-400 rounded-lg mb-2 flex items-end justify-center relative" style="height: 100%;">
                    <div class="absolute inset-x-0 bottom-0 bg-purple-700 rounded-b-lg" style="height: 85%;"></div>
                  </div>
                  <p class="text-xs font-medium text-slate-700">ACT</p>
                  <p class="text-sm font-bold text-purple-700">$0.68</p>
                  <p class="text-[10px] text-slate-400">per capita</p>
                </div>
                <div class="text-center">
                  <div class="h-32 bg-slate-100 rounded-lg mb-2 flex items-end justify-center relative">
                    <div class="absolute inset-x-0 bottom-0 bg-purple-600 rounded-b-lg" style="height: 75%;"></div>
                  </div>
                  <p class="text-xs font-medium text-slate-700">TAS</p>
                  <p class="text-sm font-bold text-purple-600">$0.43</p>
                  <p class="text-[10px] text-slate-400">per capita</p>
                </div>
                <div class="text-center">
                  <div class="h-32 bg-slate-100 rounded-lg mb-2 flex items-end justify-center relative">
                    <div class="absolute inset-x-0 bottom-0 bg-purple-500 rounded-b-lg" style="height: 68%;"></div>
                  </div>
                  <p class="text-xs font-medium text-slate-700">SA</p>
                  <p class="text-sm font-bold text-purple-500">$0.35</p>
                  <p class="text-[10px] text-slate-400">per capita</p>
                </div>
                <div class="text-center">
                  <div class="h-32 bg-slate-100 rounded-lg mb-2 flex items-end justify-center relative">
                    <div class="absolute inset-x-0 bottom-0 bg-purple-500 rounded-b-lg" style="height: 65%;"></div>
                  </div>
                  <p class="text-xs font-medium text-slate-700">QLD</p>
                  <p class="text-sm font-bold text-purple-500">$0.33</p>
                  <p class="text-[10px] text-slate-400">per capita</p>
                </div>
                <div class="text-center">
                  <div class="h-32 bg-slate-100 rounded-lg mb-2 flex items-end justify-center relative">
                    <div class="absolute inset-x-0 bottom-0 bg-purple-400 rounded-b-lg" style="height: 62%;"></div>
                  </div>
                  <p class="text-xs font-medium text-slate-700">WA</p>
                  <p class="text-sm font-bold text-purple-400">$0.33</p>
                  <p class="text-[10px] text-slate-400">per capita</p>
                </div>
                <div class="text-center">
                  <div class="h-32 bg-slate-100 rounded-lg mb-2 flex items-end justify-center relative">
                    <div class="absolute inset-x-0 bottom-0 bg-purple-400 rounded-b-lg" style="height: 60%;"></div>
                  </div>
                  <p class="text-xs font-medium text-slate-700">VIC</p>
                  <p class="text-sm font-bold text-purple-400">$0.33</p>
                  <p class="text-[10px] text-slate-400">per capita</p>
                </div>
                <div class="text-center">
                  <div class="h-32 bg-slate-100 rounded-lg mb-2 flex items-end justify-center relative">
                    <div class="absolute inset-x-0 bottom-0 bg-purple-300 rounded-b-lg" style="height: 58%;"></div>
                  </div>
                  <p class="text-xs font-medium text-slate-700">NSW</p>
                  <p class="text-sm font-bold text-purple-300">$0.31</p>
                  <p class="text-[10px] text-slate-400">per capita</p>
                </div>
                <div class="text-center">
                  <div class="h-32 bg-slate-100 rounded-lg mb-2 flex items-end justify-center relative">
                    <div class="absolute inset-x-0 bottom-0 bg-purple-200 rounded-b-lg" style="height: 40%;"></div>
                  </div>
                  <p class="text-xs font-medium text-slate-700">NT</p>
                  <p class="text-sm font-bold text-purple-300">$0.28</p>
                  <p class="text-[10px] text-slate-400">per capita</p>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== PARTNERS TAB ==================== -->
          <div class="plan-content hidden" data-plan-content="partners">
            <div class="space-y-6">
              <!-- Partners Header -->
              <div class="bg-gradient-to-r from-green-600 to-emerald-600 rounded-2xl p-6 text-white">
                <div class="flex items-center justify-between">
                  <div>
                    <h3 class="text-xl font-bold mb-2">Partner Recommendations & Activation</h3>
                    <p class="text-green-100">Recommended publishers and format prioritisation for campaign execution</p>
                  </div>
                  <div class="flex items-center gap-4">
                    <div class="text-center">
                      <p class="text-2xl font-bold">12</p>
                      <p class="text-xs text-green-200">Publishers</p>
                    </div>
                    <div class="text-center">
                      <p class="text-2xl font-bold">18</p>
                      <p class="text-xs text-green-200">Formats</p>
                    </div>
                    <div class="text-center">
                      <p class="text-2xl font-bold">94%</p>
                      <p class="text-xs text-green-200">Audience Match</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Publisher Recommendations -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h4 class="font-semibold text-slate-800">Recommended Publishers</h4>
                    <p class="text-sm text-slate-500">AI-optimised selection based on audience match, brand safety, and performance data</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="px-3 py-1 bg-purple-100 text-purple-700 text-xs font-medium rounded-full">Roy Morgan Data</span>
                    <span class="px-3 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full">GWI Insights</span>
                  </div>
                </div>

                <div class="grid grid-cols-3 gap-4">
                  <!-- Nine Entertainment -->
                  <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 border border-purple-200">
                    <div class="flex items-center justify-between mb-4">
                      <div class="w-12 h-12 rounded-xl bg-purple-600 flex items-center justify-center">
                        <span class="text-white font-bold text-lg">9</span>
                      </div>
                      <div class="flex flex-col items-end">
                        <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded">Tier 1</span>
                        <span class="text-lg font-bold text-purple-700 mt-1">$1.2M</span>
                      </div>
                    </div>
                    <h5 class="font-semibold text-slate-800 mb-2">Nine Entertainment</h5>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                      <div class="text-center">
                        <p class="text-sm font-bold text-purple-700">142</p>
                        <p class="text-[10px] text-slate-500">Reach Index</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-green-600">98%</p>
                        <p class="text-[10px] text-slate-500">Brand Safe</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-blue-600">94%</p>
                        <p class="text-[10px] text-slate-500">Aud Match</p>
                      </div>
                    </div>
                    <div class="flex flex-wrap gap-1">
                      <span class="px-2 py-1 bg-white text-purple-700 text-[10px] rounded border border-purple-200">FTA TV</span>
                      <span class="px-2 py-1 bg-white text-purple-700 text-[10px] rounded border border-purple-200">9Now</span>
                      <span class="px-2 py-1 bg-white text-purple-700 text-[10px] rounded border border-purple-200">News</span>
                    </div>
                  </div>

                  <!-- Seven West -->
                  <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-xl p-5 border border-red-200">
                    <div class="flex items-center justify-between mb-4">
                      <div class="w-12 h-12 rounded-xl bg-red-600 flex items-center justify-center">
                        <span class="text-white font-bold text-lg">7</span>
                      </div>
                      <div class="flex flex-col items-end">
                        <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded">Tier 1</span>
                        <span class="text-lg font-bold text-red-700 mt-1">$980K</span>
                      </div>
                    </div>
                    <h5 class="font-semibold text-slate-800 mb-2">Seven West Media</h5>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                      <div class="text-center">
                        <p class="text-sm font-bold text-red-700">138</p>
                        <p class="text-[10px] text-slate-500">Reach Index</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-green-600">97%</p>
                        <p class="text-[10px] text-slate-500">Brand Safe</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-blue-600">92%</p>
                        <p class="text-[10px] text-slate-500">Aud Match</p>
                      </div>
                    </div>
                    <div class="flex flex-wrap gap-1">
                      <span class="px-2 py-1 bg-white text-red-700 text-[10px] rounded border border-red-200">FTA TV</span>
                      <span class="px-2 py-1 bg-white text-red-700 text-[10px] rounded border border-red-200">7plus</span>
                      <span class="px-2 py-1 bg-white text-red-700 text-[10px] rounded border border-red-200">WAN</span>
                    </div>
                  </div>

                  <!-- Paramount+ -->
                  <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5 border border-blue-200">
                    <div class="flex items-center justify-between mb-4">
                      <div class="w-12 h-12 rounded-xl bg-blue-600 flex items-center justify-center">
                        <span class="text-white font-bold text-lg">10</span>
                      </div>
                      <div class="flex flex-col items-end">
                        <span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs font-medium rounded">Tier 2</span>
                        <span class="text-lg font-bold text-blue-700 mt-1">$650K</span>
                      </div>
                    </div>
                    <h5 class="font-semibold text-slate-800 mb-2">Paramount ANZ</h5>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                      <div class="text-center">
                        <p class="text-sm font-bold text-blue-700">125</p>
                        <p class="text-[10px] text-slate-500">Reach Index</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-green-600">99%</p>
                        <p class="text-[10px] text-slate-500">Brand Safe</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-blue-600">88%</p>
                        <p class="text-[10px] text-slate-500">Aud Match</p>
                      </div>
                    </div>
                    <div class="flex flex-wrap gap-1">
                      <span class="px-2 py-1 bg-white text-blue-700 text-[10px] rounded border border-blue-200">FTA TV</span>
                      <span class="px-2 py-1 bg-white text-blue-700 text-[10px] rounded border border-blue-200">10 Play</span>
                      <span class="px-2 py-1 bg-white text-blue-700 text-[10px] rounded border border-blue-200">Paramount+</span>
                    </div>
                  </div>

                  <!-- Meta -->
                  <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-xl p-5 border border-indigo-200">
                    <div class="flex items-center justify-between mb-4">
                      <div class="w-12 h-12 rounded-xl bg-indigo-600 flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.879V14.89h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.989C18.343 21.129 22 16.99 22 12c0-5.523-4.477-10-10-10z"/></svg>
                      </div>
                      <div class="flex flex-col items-end">
                        <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded">Tier 1</span>
                        <span class="text-lg font-bold text-indigo-700 mt-1">$890K</span>
                      </div>
                    </div>
                    <h5 class="font-semibold text-slate-800 mb-2">Meta Platforms</h5>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                      <div class="text-center">
                        <p class="text-sm font-bold text-indigo-700">156</p>
                        <p class="text-[10px] text-slate-500">Reach Index</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-green-600">95%</p>
                        <p class="text-[10px] text-slate-500">Brand Safe</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-blue-600">96%</p>
                        <p class="text-[10px] text-slate-500">Aud Match</p>
                      </div>
                    </div>
                    <div class="flex flex-wrap gap-1">
                      <span class="px-2 py-1 bg-white text-indigo-700 text-[10px] rounded border border-indigo-200">Facebook</span>
                      <span class="px-2 py-1 bg-white text-indigo-700 text-[10px] rounded border border-indigo-200">Instagram</span>
                      <span class="px-2 py-1 bg-white text-indigo-700 text-[10px] rounded border border-indigo-200">Reels</span>
                    </div>
                  </div>

                  <!-- YouTube -->
                  <div class="bg-gradient-to-br from-rose-50 to-rose-100 rounded-xl p-5 border border-rose-200">
                    <div class="flex items-center justify-between mb-4">
                      <div class="w-12 h-12 rounded-xl bg-rose-600 flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
                      </div>
                      <div class="flex flex-col items-end">
                        <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded">Tier 1</span>
                        <span class="text-lg font-bold text-rose-700 mt-1">$720K</span>
                      </div>
                    </div>
                    <h5 class="font-semibold text-slate-800 mb-2">YouTube (Google)</h5>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                      <div class="text-center">
                        <p class="text-sm font-bold text-rose-700">148</p>
                        <p class="text-[10px] text-slate-500">Reach Index</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-green-600">94%</p>
                        <p class="text-[10px] text-slate-500">Brand Safe</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-blue-600">91%</p>
                        <p class="text-[10px] text-slate-500">Aud Match</p>
                      </div>
                    </div>
                    <div class="flex flex-wrap gap-1">
                      <span class="px-2 py-1 bg-white text-rose-700 text-[10px] rounded border border-rose-200">Pre-roll</span>
                      <span class="px-2 py-1 bg-white text-rose-700 text-[10px] rounded border border-rose-200">Shorts</span>
                      <span class="px-2 py-1 bg-white text-rose-700 text-[10px] rounded border border-rose-200">Display</span>
                    </div>
                  </div>

                  <!-- JCDecaux -->
                  <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-5 border border-green-200">
                    <div class="flex items-center justify-between mb-4">
                      <div class="w-12 h-12 rounded-xl bg-green-600 flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/></svg>
                      </div>
                      <div class="flex flex-col items-end">
                        <span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs font-medium rounded">Tier 2</span>
                        <span class="text-lg font-bold text-green-700 mt-1">$580K</span>
                      </div>
                    </div>
                    <h5 class="font-semibold text-slate-800 mb-2">JCDecaux</h5>
                    <div class="grid grid-cols-3 gap-2 mb-3">
                      <div class="text-center">
                        <p class="text-sm font-bold text-green-700">132</p>
                        <p class="text-[10px] text-slate-500">Reach Index</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-green-600">100%</p>
                        <p class="text-[10px] text-slate-500">Brand Safe</p>
                      </div>
                      <div class="text-center">
                        <p class="text-sm font-bold text-blue-600">85%</p>
                        <p class="text-[10px] text-slate-500">Aud Match</p>
                      </div>
                    </div>
                    <div class="flex flex-wrap gap-1">
                      <span class="px-2 py-1 bg-white text-green-700 text-[10px] rounded border border-green-200">Street</span>
                      <span class="px-2 py-1 bg-white text-green-700 text-[10px] rounded border border-green-200">Rail</span>
                      <span class="px-2 py-1 bg-white text-green-700 text-[10px] rounded border border-green-200">Airport</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Format Prioritisation -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h4 class="font-semibold text-slate-800">Format Prioritisation</h4>
                    <p class="text-sm text-slate-500">Key formats by publisher with performance benchmarks and brand fit</p>
                  </div>
                </div>

                <div class="overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b-2 border-slate-200 bg-slate-50">
                        <th class="text-left py-3 px-4 font-semibold text-slate-700">Format</th>
                        <th class="text-left py-3 px-4 font-semibold text-slate-700">Publisher</th>
                        <th class="text-center py-3 px-4 font-semibold text-slate-700">CPM</th>
                        <th class="text-center py-3 px-4 font-semibold text-slate-700">Reach Est.</th>
                        <th class="text-center py-3 px-4 font-semibold text-slate-700">Brand Fit</th>
                        <th class="text-center py-3 px-4 font-semibold text-slate-700">Priority</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100">
                        <td class="py-3 px-4 font-medium text-slate-800">30s TVC - Peak</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded">Nine / Seven</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">$45.00</td>
                        <td class="py-3 px-4 text-center text-slate-600">2.4M</td>
                        <td class="py-3 px-4 text-center"><span class="text-green-600 font-bold">★★★★★</span></td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full font-medium">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 bg-slate-50/50">
                        <td class="py-3 px-4 font-medium text-slate-800">15s BVOD Pre-roll</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded">9Now / 7plus</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">$32.00</td>
                        <td class="py-3 px-4 text-center text-slate-600">1.8M</td>
                        <td class="py-3 px-4 text-center"><span class="text-green-600 font-bold">★★★★★</span></td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full font-medium">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100">
                        <td class="py-3 px-4 font-medium text-slate-800">Instagram Reels</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-indigo-100 text-indigo-700 text-xs rounded">Meta</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">$18.50</td>
                        <td class="py-3 px-4 text-center text-slate-600">3.2M</td>
                        <td class="py-3 px-4 text-center"><span class="text-green-600 font-bold">★★★★☆</span></td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full font-medium">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 bg-slate-50/50">
                        <td class="py-3 px-4 font-medium text-slate-800">YouTube Pre-roll 15s</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-rose-100 text-rose-700 text-xs rounded">Google</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">$22.00</td>
                        <td class="py-3 px-4 text-center text-slate-600">2.8M</td>
                        <td class="py-3 px-4 text-center"><span class="text-green-600 font-bold">★★★★☆</span></td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full font-medium">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100">
                        <td class="py-3 px-4 font-medium text-slate-800">Large Format Digital</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded">JCDecaux / oOh!</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">$8.50</td>
                        <td class="py-3 px-4 text-center text-slate-600">4.5M</td>
                        <td class="py-3 px-4 text-center"><span class="text-green-600 font-bold">★★★★★</span></td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded-full font-medium">Medium</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 bg-slate-50/50">
                        <td class="py-3 px-4 font-medium text-slate-800">Facebook Feed Video</td>
                        <td class="py-3 px-4"><span class="px-2 py-1 bg-indigo-100 text-indigo-700 text-xs rounded">Meta</span></td>
                        <td class="py-3 px-4 text-center text-slate-600">$14.00</td>
                        <td class="py-3 px-4 text-center text-slate-600">2.1M</td>
                        <td class="py-3 px-4 text-center"><span class="text-green-600 font-bold">★★★★☆</span></td>
                        <td class="py-3 px-4 text-center"><span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded-full font-medium">Medium</span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Activation Status -->
              <div class="bg-gradient-to-br from-green-50 to-emerald-100 rounded-2xl p-6 border border-green-200">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h4 class="font-semibold text-green-800 flex items-center gap-2">
                      <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                      Activation Status
                    </h4>
                    <p class="text-sm text-green-700 mt-1">Publisher briefs and booking status</p>
                  </div>
                  <button class="px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white text-sm font-medium rounded-xl flex items-center gap-2 shadow-lg">
                    <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                    Export All Briefs
                  </button>
                </div>

                <div class="grid grid-cols-4 gap-4">
                  <div class="bg-white rounded-xl p-4 border border-green-200">
                    <div class="flex items-center justify-between mb-3">
                      <span class="font-medium text-slate-800">Nine</span>
                      <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">Confirmed</span>
                    </div>
                    <div class="space-y-2">
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Brief Sent</span>
                        <span class="text-green-600">✓ Jan 8</span>
                      </div>
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">IO Signed</span>
                        <span class="text-green-600">✓ Jan 12</span>
                      </div>
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Go Live</span>
                        <span class="text-slate-600">Jan 20</span>
                      </div>
                    </div>
                  </div>

                  <div class="bg-white rounded-xl p-4 border border-green-200">
                    <div class="flex items-center justify-between mb-3">
                      <span class="font-medium text-slate-800">Seven</span>
                      <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">Confirmed</span>
                    </div>
                    <div class="space-y-2">
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Brief Sent</span>
                        <span class="text-green-600">✓ Jan 8</span>
                      </div>
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">IO Signed</span>
                        <span class="text-green-600">✓ Jan 13</span>
                      </div>
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Go Live</span>
                        <span class="text-slate-600">Jan 20</span>
                      </div>
                    </div>
                  </div>

                  <div class="bg-white rounded-xl p-4 border border-amber-200">
                    <div class="flex items-center justify-between mb-3">
                      <span class="font-medium text-slate-800">Meta</span>
                      <span class="px-2 py-1 bg-amber-100 text-amber-700 text-xs rounded-full">Pending</span>
                    </div>
                    <div class="space-y-2">
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Brief Sent</span>
                        <span class="text-green-600">✓ Jan 10</span>
                      </div>
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">IO Signed</span>
                        <span class="text-amber-600">Pending</span>
                      </div>
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Go Live</span>
                        <span class="text-slate-600">Jan 22</span>
                      </div>
                    </div>
                  </div>

                  <div class="bg-white rounded-xl p-4 border border-slate-200">
                    <div class="flex items-center justify-between mb-3">
                      <span class="font-medium text-slate-800">JCDecaux</span>
                      <span class="px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded-full">Draft</span>
                    </div>
                    <div class="space-y-2">
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Brief Sent</span>
                        <span class="text-slate-400">Not sent</span>
                      </div>
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">IO Signed</span>
                        <span class="text-slate-400">-</span>
                      </div>
                      <div class="flex justify-between text-xs">
                        <span class="text-slate-500">Go Live</span>
                        <span class="text-slate-600">Jan 27</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== INSIGHTS TAB ==================== -->
          <div class="plan-content hidden" data-plan-content="insights">
            <div class="space-y-6">
              <!-- Challenge Diagnosis Header -->
              <div class="bg-gradient-to-r from-purple-600 to-purple-800 rounded-2xl p-6 text-white">
                <h3 class="text-xl font-bold mb-2">Challenge Diagnosis</h3>
                <p class="text-purple-200">Strategic analysis of market position, brand health, and cultural context</p>
              </div>

              <!-- Analysis Cards Grid -->
              <div class="grid grid-cols-3 gap-6">
                <!-- Category Analysis -->
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center">
                      <svg class="w-5 h-5 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"/></svg>
                    </div>
                    <h4 class="font-semibold text-slate-800">Category Analysis</h4>
                  </div>
                  <div class="space-y-4">
                    <div class="bg-slate-50 rounded-xl p-4">
                      <p class="text-xs text-slate-500 mb-2">Category Media Investment (TTM)</p>
                      <p class="text-2xl font-bold text-slate-800">$892M</p>
                      <p class="text-xs text-green-600 mt-1">+8.2% YoY growth</p>
                    </div>
                    <div class="space-y-2">
                      <p class="text-xs font-medium text-slate-600">Top Competitors by Spend</p>
                      <div class="flex items-center justify-between text-sm">
                        <span class="text-slate-700">Competitor A</span>
                        <span class="font-medium text-slate-800">$156M (17.5%)</span>
                      </div>
                      <div class="w-full h-2 bg-slate-100 rounded-full"><div class="h-2 bg-purple-600 rounded-full" style="width: 17.5%"></div></div>
                      <div class="flex items-center justify-between text-sm">
                        <span class="text-slate-700">Competitor B</span>
                        <span class="font-medium text-slate-800">$134M (15.0%)</span>
                      </div>
                      <div class="w-full h-2 bg-slate-100 rounded-full"><div class="h-2 bg-purple-500 rounded-full" style="width: 15%"></div></div>
                      <div class="flex items-center justify-between text-sm">
                        <span class="text-slate-700">Competitor C</span>
                        <span class="font-medium text-slate-800">$98M (11.0%)</span>
                      </div>
                      <div class="w-full h-2 bg-slate-100 rounded-full"><div class="h-2 bg-purple-400 rounded-full" style="width: 11%"></div></div>
                      <div class="flex items-center justify-between text-sm">
                        <span class="text-slate-700 font-medium">Our Brand</span>
                        <span class="font-bold text-purple-700">$78M (8.7%)</span>
                      </div>
                      <div class="w-full h-2 bg-slate-100 rounded-full"><div class="h-2 bg-green-500 rounded-full" style="width: 8.7%"></div></div>
                    </div>
                  </div>
                </div>

                <!-- Brand Analysis -->
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 rounded-xl bg-pink-100 flex items-center justify-center">
                      <svg class="w-5 h-5 text-pink-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                    </div>
                    <h4 class="font-semibold text-slate-800">Brand Analysis</h4>
                  </div>
                  <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-3">
                      <div class="bg-green-50 rounded-xl p-3 text-center">
                        <p class="text-xs text-green-600">Awareness</p>
                        <p class="text-xl font-bold text-green-700">72%</p>
                        <p class="text-xs text-green-500">+3pts vs LY</p>
                      </div>
                      <div class="bg-blue-50 rounded-xl p-3 text-center">
                        <p class="text-xs text-blue-600">Consideration</p>
                        <p class="text-xl font-bold text-blue-700">45%</p>
                        <p class="text-xs text-blue-500">+5pts vs LY</p>
                      </div>
                      <div class="bg-purple-50 rounded-xl p-3 text-center">
                        <p class="text-xs text-purple-600">Preference</p>
                        <p class="text-xl font-bold text-purple-700">28%</p>
                        <p class="text-xs text-purple-500">+2pts vs LY</p>
                      </div>
                      <div class="bg-amber-50 rounded-xl p-3 text-center">
                        <p class="text-xs text-amber-600">NPS Score</p>
                        <p class="text-xl font-bold text-amber-700">+42</p>
                        <p class="text-xs text-amber-500">Top quartile</p>
                      </div>
                    </div>
                    <div class="bg-slate-50 rounded-xl p-4">
                      <p class="text-xs font-medium text-slate-600 mb-2">Key Brand Associations</p>
                      <div class="flex flex-wrap gap-2">
                        <span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full">Quality</span>
                        <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full">Trusted</span>
                        <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">Value</span>
                        <span class="px-2 py-1 bg-pink-100 text-pink-700 text-xs rounded-full">Innovative</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Cultural Analysis -->
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center">
                      <svg class="w-5 h-5 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></svg>
                    </div>
                    <h4 class="font-semibold text-slate-800">Cultural Analysis</h4>
                  </div>
                  <div class="space-y-4">
                    <div class="bg-amber-50 rounded-xl p-4">
                      <p class="text-xs font-medium text-amber-700 mb-2">Trending Cultural Themes</p>
                      <div class="space-y-2">
                        <div class="flex items-center gap-2">
                          <div class="w-2 h-2 rounded-full bg-amber-500"></div>
                          <span class="text-sm text-slate-700">Sustainability & eco-conscious living</span>
                        </div>
                        <div class="flex items-center gap-2">
                          <div class="w-2 h-2 rounded-full bg-amber-400"></div>
                          <span class="text-sm text-slate-700">Health & wellness prioritization</span>
                        </div>
                        <div class="flex items-center gap-2">
                          <div class="w-2 h-2 rounded-full bg-amber-300"></div>
                          <span class="text-sm text-slate-700">Local & authentic experiences</span>
                        </div>
                      </div>
                    </div>
                    <div class="bg-slate-50 rounded-xl p-4">
                      <p class="text-xs font-medium text-slate-600 mb-2">Key Cultural Moments (Next 26 wks)</p>
                      <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                          <span class="text-slate-600">Easter Weekend</span>
                          <span class="text-purple-600 font-medium">Week 12</span>
                        </div>
                        <div class="flex justify-between text-sm">
                          <span class="text-slate-600">ANZAC Day</span>
                          <span class="text-purple-600 font-medium">Week 17</span>
                        </div>
                        <div class="flex justify-between text-sm">
                          <span class="text-slate-600">Mother's Day</span>
                          <span class="text-purple-600 font-medium">Week 19</span>
                        </div>
                        <div class="flex justify-between text-sm">
                          <span class="text-slate-600">EOFY</span>
                          <span class="text-purple-600 font-medium">Week 26</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Experience Audit Spider Graph -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h4 class="font-semibold text-slate-800">Experience Audit</h4>
                    <p class="text-sm text-slate-500">Brand performance vs category benchmark across key touchpoints</p>
                  </div>
                  <div class="flex items-center gap-4">
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-purple-600"></div>
                      <span class="text-sm text-slate-600">Our Brand</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-slate-300"></div>
                      <span class="text-sm text-slate-600">Category Avg</span>
                    </div>
                  </div>
                </div>
                <div class="flex items-center justify-center">
                  <svg viewBox="0 0 400 400" class="w-96 h-96">
                    <!-- Background circles -->
                    <circle cx="200" cy="200" r="150" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                    <circle cx="200" cy="200" r="120" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                    <circle cx="200" cy="200" r="90" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                    <circle cx="200" cy="200" r="60" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                    <circle cx="200" cy="200" r="30" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                    
                    <!-- Axis lines -->
                    <line x1="200" y1="50" x2="200" y2="350" stroke="#e2e8f0" stroke-width="1"/>
                    <line x1="50" y1="200" x2="350" y2="200" stroke="#e2e8f0" stroke-width="1"/>
                    <line x1="94" y1="94" x2="306" y2="306" stroke="#e2e8f0" stroke-width="1"/>
                    <line x1="306" y1="94" x2="94" y2="306" stroke="#e2e8f0" stroke-width="1"/>
                    
                    <!-- Category benchmark (gray) -->
                    <polygon points="200,80 290,140 290,260 200,320 110,260 110,140" fill="rgba(148,163,184,0.2)" stroke="#94a3b8" stroke-width="2"/>
                    
                    <!-- Our brand (purple) -->
                    <polygon points="200,65 310,130 280,280 200,300 120,250 130,120" fill="rgba(147,51,234,0.2)" stroke="#9333ea" stroke-width="2"/>
                    
                    <!-- Data points for our brand -->
                    <circle cx="200" cy="65" r="6" fill="#9333ea"/>
                    <circle cx="310" cy="130" r="6" fill="#9333ea"/>
                    <circle cx="280" cy="280" r="6" fill="#9333ea"/>
                    <circle cx="200" cy="300" r="6" fill="#9333ea"/>
                    <circle cx="120" cy="250" r="6" fill="#9333ea"/>
                    <circle cx="130" cy="120" r="6" fill="#9333ea"/>
                    
                    <!-- Labels -->
                    <text x="200" y="35" text-anchor="middle" class="text-xs fill-slate-600 font-medium">TV Awareness</text>
                    <text x="360" y="135" text-anchor="start" class="text-xs fill-slate-600 font-medium">Digital Engagement</text>
                    <text x="340" y="290" text-anchor="start" class="text-xs fill-slate-600 font-medium">Social Sentiment</text>
                    <text x="200" y="370" text-anchor="middle" class="text-xs fill-slate-600 font-medium">In-Store Experience</text>
                    <text x="40" y="260" text-anchor="start" class="text-xs fill-slate-600 font-medium">OOH Recall</text>
                    <text x="40" y="120" text-anchor="start" class="text-xs fill-slate-600 font-medium">Search Intent</text>
                  </svg>
                </div>
                <div class="grid grid-cols-6 gap-4 mt-4">
                  <div class="text-center">
                    <p class="text-xs text-slate-500">TV Awareness</p>
                    <p class="text-lg font-bold text-purple-600">92%</p>
                    <p class="text-xs text-green-500">+12 vs cat</p>
                  </div>
                  <div class="text-center">
                    <p class="text-xs text-slate-500">Digital Engagement</p>
                    <p class="text-lg font-bold text-purple-600">78%</p>
                    <p class="text-xs text-green-500">+8 vs cat</p>
                  </div>
                  <div class="text-center">
                    <p class="text-xs text-slate-500">Social Sentiment</p>
                    <p class="text-lg font-bold text-purple-600">65%</p>
                    <p class="text-xs text-amber-500">-2 vs cat</p>
                  </div>
                  <div class="text-center">
                    <p class="text-xs text-slate-500">In-Store</p>
                    <p class="text-lg font-bold text-purple-600">71%</p>
                    <p class="text-xs text-green-500">+5 vs cat</p>
                  </div>
                  <div class="text-center">
                    <p class="text-xs text-slate-500">OOH Recall</p>
                    <p class="text-lg font-bold text-purple-600">58%</p>
                    <p class="text-xs text-amber-500">-5 vs cat</p>
                  </div>
                  <div class="text-center">
                    <p class="text-xs text-slate-500">Search Intent</p>
                    <p class="text-lg font-bold text-purple-600">82%</p>
                    <p class="text-xs text-green-500">+10 vs cat</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== STRATEGY TAB ==================== -->
          <div class="plan-content hidden" data-plan-content="strategy">
            <div class="space-y-6">
              <!-- Audience Profiling Section -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Audience Profiling</h3>
                <div class="grid grid-cols-2 gap-6">
                  <!-- Primary Audience -->
                  <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 border border-purple-200">
                    <div class="flex items-center gap-3 mb-4">
                      <div class="w-12 h-12 rounded-full bg-purple-600 flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                      </div>
                      <div>
                        <p class="text-xs text-purple-600 font-medium">PRIMARY AUDIENCE</p>
                        <h4 class="font-bold text-slate-800 text-lg">Modern Family Shoppers</h4>
                      </div>
                    </div>
                    <div class="space-y-3">
                      <div class="bg-white/70 rounded-lg p-3">
                        <p class="text-xs text-slate-500 mb-1">Demographics</p>
                        <p class="text-sm text-slate-700">Adults 25-44, HHI $80K+, suburban metro</p>
                      </div>
                      <div class="bg-white/70 rounded-lg p-3">
                        <p class="text-xs text-slate-500 mb-1">Key Behaviors</p>
                        <p class="text-sm text-slate-700">Weekly grocery shoppers, brand switchers, digitally engaged, value quality over price</p>
                      </div>
                      <div class="bg-white/70 rounded-lg p-3">
                        <p class="text-xs text-slate-500 mb-1">Media Consumption</p>
                        <p class="text-sm text-slate-700">Heavy BVOD, social media scrollers, commuter OOH exposure, light live TV</p>
                      </div>
                      <div class="bg-white/70 rounded-lg p-3">
                        <p class="text-xs text-slate-500 mb-1">Audience Size</p>
                        <p class="text-lg font-bold text-purple-700">4.2M individuals</p>
                      </div>
                    </div>
                  </div>

                  <!-- Secondary Audience -->
                  <div class="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-5 border border-slate-200">
                    <div class="flex items-center gap-3 mb-4">
                      <div class="w-12 h-12 rounded-full bg-slate-500 flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>
                      </div>
                      <div>
                        <p class="text-xs text-slate-500 font-medium">SECONDARY AUDIENCE</p>
                        <h4 class="font-bold text-slate-800 text-lg">Young Professionals</h4>
                      </div>
                    </div>
                    <div class="space-y-3">
                      <div class="bg-white/70 rounded-lg p-3">
                        <p class="text-xs text-slate-500 mb-1">Demographics</p>
                        <p class="text-sm text-slate-700">Adults 18-29, single or DINK, inner city dwellers</p>
                      </div>
                      <div class="bg-white/70 rounded-lg p-3">
                        <p class="text-xs text-slate-500 mb-1">Key Behaviors</p>
                        <p class="text-sm text-slate-700">Convenience seekers, trend-conscious, social media influenced, premium willing</p>
                      </div>
                      <div class="bg-white/70 rounded-lg p-3">
                        <p class="text-xs text-slate-500 mb-1">Media Consumption</p>
                        <p class="text-sm text-slate-700">Social-first, podcast listeners, no linear TV, high mobile usage</p>
                      </div>
                      <div class="bg-white/70 rounded-lg p-3">
                        <p class="text-xs text-slate-500 mb-1">Audience Size</p>
                        <p class="text-lg font-bold text-slate-700">2.8M individuals</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Insight Discovery - 5C's -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Insight Discovery (5C Framework)</h3>
                <div class="grid grid-cols-5 gap-4">
                  <div class="bg-blue-50 rounded-xl p-4 border border-blue-100">
                    <div class="w-10 h-10 rounded-lg bg-blue-500 flex items-center justify-center mb-3">
                      <span class="text-white font-bold text-lg">C</span>
                    </div>
                    <h4 class="font-semibold text-blue-800 mb-2">Category</h4>
                    <p class="text-xs text-slate-600">FMCG category experiencing 8% growth driven by premium and health-focused products. Private label gaining share.</p>
                  </div>
                  <div class="bg-green-50 rounded-xl p-4 border border-green-100">
                    <div class="w-10 h-10 rounded-lg bg-green-500 flex items-center justify-center mb-3">
                      <span class="text-white font-bold text-lg">C</span>
                    </div>
                    <h4 class="font-semibold text-green-800 mb-2">Company</h4>
                    <p class="text-xs text-slate-600">Strong heritage brand with loyal customer base. Recent innovation pipeline strengthening portfolio. Distribution network advantage.</p>
                  </div>
                  <div class="bg-purple-50 rounded-xl p-4 border border-purple-100">
                    <div class="w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center mb-3">
                      <span class="text-white font-bold text-lg">C</span>
                    </div>
                    <h4 class="font-semibold text-purple-800 mb-2">Customer</h4>
                    <p class="text-xs text-slate-600">Seeking quality at value. Health-conscious but time-poor. Digital natives expecting seamless experiences across channels.</p>
                  </div>
                  <div class="bg-amber-50 rounded-xl p-4 border border-amber-100">
                    <div class="w-10 h-10 rounded-lg bg-amber-500 flex items-center justify-center mb-3">
                      <span class="text-white font-bold text-lg">C</span>
                    </div>
                    <h4 class="font-semibold text-amber-800 mb-2">Competitor</h4>
                    <p class="text-xs text-slate-600">Top 3 competitors outspending 2:1 in digital. New market entrants disrupting with DTC models. Price wars in core segments.</p>
                  </div>
                  <div class="bg-pink-50 rounded-xl p-4 border border-pink-100">
                    <div class="w-10 h-10 rounded-lg bg-pink-500 flex items-center justify-center mb-3">
                      <span class="text-white font-bold text-lg">C</span>
                    </div>
                    <h4 class="font-semibold text-pink-800 mb-2">Culture</h4>
                    <p class="text-xs text-slate-600">Rising sustainability consciousness. Local sourcing preference. Wellness and mindfulness trends influencing purchase decisions.</p>
                  </div>
                </div>
              </div>

              <!-- Comms Architecture Table -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Communications Architecture</h3>
                <div class="overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b border-slate-200">
                        <th class="pb-3 text-left font-medium text-slate-600">Stage</th>
                        <th class="pb-3 text-left font-medium text-slate-600">Role</th>
                        <th class="pb-3 text-left font-medium text-slate-600">Channels</th>
                        <th class="pb-3 text-left font-medium text-slate-600">Message Focus</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Budget %</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100">
                        <td class="py-4"><span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium">Awareness</span></td>
                        <td class="py-4 text-slate-700">Build mass reach and mental availability</td>
                        <td class="py-4 text-slate-700">FTA TV, BVOD, Large Format OOH</td>
                        <td class="py-4 text-slate-700">Brand story, emotional connection</td>
                        <td class="py-4 text-right font-medium text-purple-600">45%</td>
                      </tr>
                      <tr class="border-b border-slate-100">
                        <td class="py-4"><span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium">Consideration</span></td>
                        <td class="py-4 text-slate-700">Drive brand preference and differentiation</td>
                        <td class="py-4 text-slate-700">Social, YouTube, Digital Display</td>
                        <td class="py-4 text-slate-700">Product benefits, social proof</td>
                        <td class="py-4 text-right font-medium text-blue-600">30%</td>
                      </tr>
                      <tr class="border-b border-slate-100">
                        <td class="py-4"><span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium">Conversion</span></td>
                        <td class="py-4 text-slate-700">Trigger purchase and drive traffic</td>
                        <td class="py-4 text-slate-700">Programmatic, Retail Media, Search</td>
                        <td class="py-4 text-slate-700">Offers, availability, urgency</td>
                        <td class="py-4 text-right font-medium text-green-600">20%</td>
                      </tr>
                      <tr>
                        <td class="py-4"><span class="px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-xs font-medium">Loyalty</span></td>
                        <td class="py-4 text-slate-700">Retain and grow customer value</td>
                        <td class="py-4 text-slate-700">CRM, Social, In-Store</td>
                        <td class="py-4 text-slate-700">Rewards, community, advocacy</td>
                        <td class="py-4 text-right font-medium text-amber-600">5%</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Goal Setting & Measurement Framework -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Goal Setting & Measurement Framework</h3>
                <div class="grid grid-cols-4 gap-4">
                  <div class="bg-purple-50 rounded-xl p-4 border border-purple-100">
                    <p class="text-xs text-purple-600 font-medium mb-2">AWARENESS KPI</p>
                    <p class="text-2xl font-bold text-purple-800">+5pts</p>
                    <p class="text-sm text-slate-600 mt-1">Unaided awareness lift</p>
                    <div class="mt-3 pt-3 border-t border-purple-200">
                      <p class="text-xs text-slate-500">Current: 72%</p>
                      <p class="text-xs text-purple-600 font-medium">Target: 77%</p>
                    </div>
                  </div>
                  <div class="bg-blue-50 rounded-xl p-4 border border-blue-100">
                    <p class="text-xs text-blue-600 font-medium mb-2">CONSIDERATION KPI</p>
                    <p class="text-2xl font-bold text-blue-800">+8pts</p>
                    <p class="text-sm text-slate-600 mt-1">Brand consideration lift</p>
                    <div class="mt-3 pt-3 border-t border-blue-200">
                      <p class="text-xs text-slate-500">Current: 45%</p>
                      <p class="text-xs text-blue-600 font-medium">Target: 53%</p>
                    </div>
                  </div>
                  <div class="bg-green-50 rounded-xl p-4 border border-green-100">
                    <p class="text-xs text-green-600 font-medium mb-2">CONVERSION KPI</p>
                    <p class="text-2xl font-bold text-green-800">+12%</p>
                    <p class="text-sm text-slate-600 mt-1">Sales volume growth</p>
                    <div class="mt-3 pt-3 border-t border-green-200">
                      <p class="text-xs text-slate-500">Current: $45M</p>
                      <p class="text-xs text-green-600 font-medium">Target: $50.4M</p>
                    </div>
                  </div>
                  <div class="bg-amber-50 rounded-xl p-4 border border-amber-100">
                    <p class="text-xs text-amber-600 font-medium mb-2">EFFICIENCY KPI</p>
                    <p class="text-2xl font-bold text-amber-800">3.2x</p>
                    <p class="text-sm text-slate-600 mt-1">Target ROAS</p>
                    <div class="mt-3 pt-3 border-t border-amber-200">
                      <p class="text-xs text-slate-500">Current: 2.8x</p>
                      <p class="text-xs text-amber-600 font-medium">Target: 3.2x</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== CALENDAR TAB ==================== -->
          <div class="plan-content hidden" data-plan-content="calendar">
            <div class="space-y-6">
              <!-- Calendar Header -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h3 class="font-semibold text-slate-800">Cultural Calendar</h3>
                    <p class="text-sm text-slate-500">26-week campaign timeline with key cultural moments</p>
                  </div>
                  <div class="flex items-center gap-4">
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                      <span class="text-xs text-slate-600">Sports</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-pink-500"></div>
                      <span class="text-xs text-slate-600">Entertainment</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-green-500"></div>
                      <span class="text-xs text-slate-600">Retail</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <div class="w-3 h-3 rounded-full bg-amber-500"></div>
                      <span class="text-xs text-slate-600">Cultural</span>
                    </div>
                  </div>
                </div>

                <!-- Calendar Grid -->
                <div class="overflow-x-auto">
                  <div class="min-w-[1400px]">
                    <!-- Month Headers -->
                    <div class="flex border-b border-slate-200 mb-2">
                      <div class="w-24 shrink-0"></div>
                      <div class="flex-1 grid grid-cols-26 gap-px">
                        <div class="col-span-4 text-center text-xs font-medium text-slate-600 py-2 bg-slate-50 rounded-t">January</div>
                        <div class="col-span-4 text-center text-xs font-medium text-slate-600 py-2 bg-slate-50 rounded-t">February</div>
                        <div class="col-span-5 text-center text-xs font-medium text-slate-600 py-2 bg-slate-50 rounded-t">March</div>
                        <div class="col-span-4 text-center text-xs font-medium text-slate-600 py-2 bg-slate-50 rounded-t">April</div>
                        <div class="col-span-4 text-center text-xs font-medium text-slate-600 py-2 bg-slate-50 rounded-t">May</div>
                        <div class="col-span-5 text-center text-xs font-medium text-slate-600 py-2 bg-slate-50 rounded-t">June</div>
                      </div>
                    </div>

                    <!-- Week Numbers -->
                    <div class="flex mb-2">
                      <div class="w-24 shrink-0 text-xs text-slate-500 pr-2 text-right">Week</div>
                      <div class="flex-1 grid grid-cols-26 gap-px">
                        <div class="text-center text-xs text-slate-400">1</div>
                        <div class="text-center text-xs text-slate-400">2</div>
                        <div class="text-center text-xs text-slate-400">3</div>
                        <div class="text-center text-xs text-slate-400">4</div>
                        <div class="text-center text-xs text-slate-400">5</div>
                        <div class="text-center text-xs text-slate-400">6</div>
                        <div class="text-center text-xs text-slate-400">7</div>
                        <div class="text-center text-xs text-slate-400">8</div>
                        <div class="text-center text-xs text-slate-400">9</div>
                        <div class="text-center text-xs text-slate-400">10</div>
                        <div class="text-center text-xs text-slate-400">11</div>
                        <div class="text-center text-xs text-slate-400">12</div>
                        <div class="text-center text-xs text-slate-400">13</div>
                        <div class="text-center text-xs text-slate-400">14</div>
                        <div class="text-center text-xs text-slate-400">15</div>
                        <div class="text-center text-xs text-slate-400">16</div>
                        <div class="text-center text-xs text-slate-400">17</div>
                        <div class="text-center text-xs text-slate-400">18</div>
                        <div class="text-center text-xs text-slate-400">19</div>
                        <div class="text-center text-xs text-slate-400">20</div>
                        <div class="text-center text-xs text-slate-400">21</div>
                        <div class="text-center text-xs text-slate-400">22</div>
                        <div class="text-center text-xs text-slate-400">23</div>
                        <div class="text-center text-xs text-slate-400">24</div>
                        <div class="text-center text-xs text-slate-400">25</div>
                        <div class="text-center text-xs text-slate-400">26</div>
                      </div>
                    </div>

                    <!-- Cultural Events Row -->
                    <div class="flex mb-1">
                      <div class="w-24 shrink-0 text-xs text-slate-700 pr-2 text-right font-medium py-1">Events</div>
                      <div class="flex-1 grid grid-cols-26 gap-px relative h-8">
                        <!-- Australian Open - Sports -->
                        <div class="col-start-2 col-span-2 bg-blue-100 border border-blue-300 rounded text-xs text-blue-700 px-1 py-0.5 truncate" title="Australian Open">Aus Open</div>
                        <!-- Super Bowl - Sports -->
                        <div class="col-start-6 col-span-1 bg-blue-100 border border-blue-300 rounded text-xs text-blue-700 px-1 py-0.5 truncate" title="Super Bowl">NFL</div>
                        <!-- Mardi Gras - Cultural -->
                        <div class="col-start-9 col-span-1 bg-amber-100 border border-amber-300 rounded text-xs text-amber-700 px-1 py-0.5 truncate" title="Sydney Mardi Gras">Mardi</div>
                        <!-- Easter - Cultural -->
                        <div class="col-start-12 col-span-2 bg-amber-100 border border-amber-300 rounded text-xs text-amber-700 px-1 py-0.5 truncate" title="Easter Weekend">Easter</div>
                        <!-- ANZAC Day - Cultural -->
                        <div class="col-start-17 col-span-1 bg-amber-100 border border-amber-300 rounded text-xs text-amber-700 px-1 py-0.5 truncate" title="ANZAC Day">ANZAC</div>
                        <!-- Mother's Day - Retail -->
                        <div class="col-start-19 col-span-1 bg-green-100 border border-green-300 rounded text-xs text-green-700 px-1 py-0.5 truncate" title="Mother's Day">Mum</div>
                        <!-- State of Origin - Sports -->
                        <div class="col-start-22 col-span-2 bg-blue-100 border border-blue-300 rounded text-xs text-blue-700 px-1 py-0.5 truncate" title="State of Origin">Origin</div>
                        <!-- EOFY - Retail -->
                        <div class="col-start-25 col-span-2 bg-green-100 border border-green-300 rounded text-xs text-green-700 px-1 py-0.5 truncate" title="End of Financial Year">EOFY</div>
                      </div>
                    </div>

                    <!-- TV Flighting -->
                    <div class="flex mb-1">
                      <div class="w-24 shrink-0 text-xs text-slate-700 pr-2 text-right py-1">FTA TV</div>
                      <div class="flex-1 grid grid-cols-26 gap-px h-6">
                        <div class="bg-purple-600 rounded-sm"></div>
                        <div class="bg-purple-600 rounded-sm"></div>
                        <div class="bg-purple-600 rounded-sm"></div>
                        <div class="bg-purple-600 rounded-sm"></div>
                        <div class="bg-purple-500 rounded-sm"></div>
                        <div class="bg-purple-500 rounded-sm"></div>
                        <div class="bg-purple-400 rounded-sm"></div>
                        <div class="bg-purple-400 rounded-sm"></div>
                        <div class="bg-purple-300 rounded-sm"></div>
                        <div class="bg-purple-300 rounded-sm"></div>
                        <div class="bg-purple-400 rounded-sm"></div>
                        <div class="bg-purple-500 rounded-sm"></div>
                        <div class="bg-purple-300 rounded-sm"></div>
                        <div class="bg-purple-200 rounded-sm"></div>
                        <div class="bg-purple-200 rounded-sm"></div>
                        <div class="bg-purple-300 rounded-sm"></div>
                        <div class="bg-purple-400 rounded-sm"></div>
                        <div class="bg-purple-300 rounded-sm"></div>
                        <div class="bg-purple-400 rounded-sm"></div>
                        <div class="bg-purple-300 rounded-sm"></div>
                        <div class="bg-purple-200 rounded-sm"></div>
                        <div class="bg-purple-300 rounded-sm"></div>
                        <div class="bg-purple-400 rounded-sm"></div>
                        <div class="bg-purple-500 rounded-sm"></div>
                        <div class="bg-purple-600 rounded-sm"></div>
                        <div class="bg-purple-600 rounded-sm"></div>
                      </div>
                    </div>

                    <!-- VOD Flighting -->
                    <div class="flex mb-1">
                      <div class="w-24 shrink-0 text-xs text-slate-700 pr-2 text-right py-1">Premium VOD</div>
                      <div class="flex-1 grid grid-cols-26 gap-px h-6">
                        <div class="bg-pink-500 rounded-sm"></div>
                        <div class="bg-pink-500 rounded-sm"></div>
                        <div class="bg-pink-500 rounded-sm"></div>
                        <div class="bg-pink-500 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-300 rounded-sm"></div>
                        <div class="bg-pink-300 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-500 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-300 rounded-sm"></div>
                        <div class="bg-pink-300 rounded-sm"></div>
                        <div class="bg-pink-300 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-300 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-300 rounded-sm"></div>
                        <div class="bg-pink-300 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-400 rounded-sm"></div>
                        <div class="bg-pink-500 rounded-sm"></div>
                        <div class="bg-pink-500 rounded-sm"></div>
                        <div class="bg-pink-500 rounded-sm"></div>
                      </div>
                    </div>

                    <!-- OOH Flighting -->
                    <div class="flex mb-1">
                      <div class="w-24 shrink-0 text-xs text-slate-700 pr-2 text-right py-1">Out of Home</div>
                      <div class="flex-1 grid grid-cols-26 gap-px h-6">
                        <div class="bg-green-500 rounded-sm"></div>
                        <div class="bg-green-500 rounded-sm"></div>
                        <div class="bg-green-600 rounded-sm"></div>
                        <div class="bg-green-600 rounded-sm"></div>
                        <div class="bg-green-400 rounded-sm"></div>
                        <div class="bg-green-400 rounded-sm"></div>
                        <div class="bg-green-300 rounded-sm"></div>
                        <div class="bg-green-300 rounded-sm"></div>
                        <div class="bg-green-300 rounded-sm"></div>
                        <div class="bg-green-400 rounded-sm"></div>
                        <div class="bg-green-500 rounded-sm"></div>
                        <div class="bg-green-600 rounded-sm"></div>
                        <div class="bg-green-500 rounded-sm"></div>
                        <div class="bg-green-400 rounded-sm"></div>
                        <div class="bg-green-300 rounded-sm"></div>
                        <div class="bg-green-300 rounded-sm"></div>
                        <div class="bg-green-500 rounded-sm"></div>
                        <div class="bg-green-400 rounded-sm"></div>
                        <div class="bg-green-500 rounded-sm"></div>
                        <div class="bg-green-400 rounded-sm"></div>
                        <div class="bg-green-400 rounded-sm"></div>
                        <div class="bg-green-500 rounded-sm"></div>
                        <div class="bg-green-500 rounded-sm"></div>
                        <div class="bg-green-600 rounded-sm"></div>
                        <div class="bg-green-600 rounded-sm"></div>
                        <div class="bg-green-600 rounded-sm"></div>
                      </div>
                    </div>

                    <!-- Social Flighting -->
                    <div class="flex mb-1">
                      <div class="w-24 shrink-0 text-xs text-slate-700 pr-2 text-right py-1">Social</div>
                      <div class="flex-1 grid grid-cols-26 gap-px h-6">
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-400 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                        <div class="bg-cyan-500 rounded-sm"></div>
                      </div>
                    </div>

                    <!-- Display Flighting -->
                    <div class="flex mb-1">
                      <div class="w-24 shrink-0 text-xs text-slate-700 pr-2 text-right py-1">Display</div>
                      <div class="flex-1 grid grid-cols-26 gap-px h-6">
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-400 rounded-sm"></div>
                        <div class="bg-orange-400 rounded-sm"></div>
                        <div class="bg-orange-500 rounded-sm"></div>
                        <div class="bg-orange-500 rounded-sm"></div>
                        <div class="bg-orange-400 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-300 rounded-sm"></div>
                        <div class="bg-orange-400 rounded-sm"></div>
                        <div class="bg-orange-400 rounded-sm"></div>
                        <div class="bg-orange-500 rounded-sm"></div>
                        <div class="bg-orange-400 rounded-sm"></div>
                        <div class="bg-orange-400 rounded-sm"></div>
                        <div class="bg-orange-400 rounded-sm"></div>
                        <div class="bg-orange-500 rounded-sm"></div>
                        <div class="bg-orange-500 rounded-sm"></div>
                        <div class="bg-orange-600 rounded-sm"></div>
                        <div class="bg-orange-600 rounded-sm"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Key Moments Detail -->
              <div class="grid grid-cols-4 gap-4">
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center gap-2 mb-3">
                    <div class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center">
                      <svg class="w-4 h-4 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                    </div>
                    <div>
                      <p class="text-xs text-blue-600 font-medium">SPORTS</p>
                      <p class="text-sm font-semibold text-slate-800">Australian Open</p>
                    </div>
                  </div>
                  <p class="text-xs text-slate-500 mb-2">Weeks 2-3 | Jan 13-26</p>
                  <p class="text-xs text-slate-600">Peak TV viewership period. Recommend increased TV weight and sports-aligned creative.</p>
                  <div class="mt-3 pt-3 border-t border-slate-100">
                    <p class="text-xs text-slate-500">Est. Audience: 8.2M</p>
                  </div>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center gap-2 mb-3">
                    <div class="w-8 h-8 rounded-lg bg-amber-100 flex items-center justify-center">
                      <svg class="w-4 h-4 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                    </div>
                    <div>
                      <p class="text-xs text-amber-600 font-medium">CULTURAL</p>
                      <p class="text-sm font-semibold text-slate-800">Easter Weekend</p>
                    </div>
                  </div>
                  <p class="text-xs text-slate-500 mb-2">Weeks 12-13 | Apr 18-21</p>
                  <p class="text-xs text-slate-600">Family-focused messaging. Strong retail period for FMCG. Heavy OOH around shopping centres.</p>
                  <div class="mt-3 pt-3 border-t border-slate-100">
                    <p class="text-xs text-slate-500">Est. Audience: 12.4M</p>
                  </div>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center gap-2 mb-3">
                    <div class="w-8 h-8 rounded-lg bg-green-100 flex items-center justify-center">
                      <svg class="w-4 h-4 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                    </div>
                    <div>
                      <p class="text-xs text-green-600 font-medium">RETAIL</p>
                      <p class="text-sm font-semibold text-slate-800">Mother's Day</p>
                    </div>
                  </div>
                  <p class="text-xs text-slate-500 mb-2">Week 19 | May 11</p>
                  <p class="text-xs text-slate-600">Gift-giving occasion. Social and digital focus with emotional creative. In-store activation.</p>
                  <div class="mt-3 pt-3 border-t border-slate-100">
                    <p class="text-xs text-slate-500">Est. Audience: 9.1M</p>
                  </div>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200 shadow-sm">
                  <div class="flex items-center gap-2 mb-3">
                    <div class="w-8 h-8 rounded-lg bg-green-100 flex items-center justify-center">
                      <svg class="w-4 h-4 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                    </div>
                    <div>
                      <p class="text-xs text-green-600 font-medium">RETAIL</p>
                      <p class="text-sm font-semibold text-slate-800">EOFY Sales</p>
                    </div>
                  </div>
                  <p class="text-xs text-slate-500 mb-2">Weeks 25-26 | Jun 16-30</p>
                  <p class="text-xs text-slate-600">High-volume sales period. Promotional messaging, strong conversion focus. Max weight across channels.</p>
                  <div class="mt-3 pt-3 border-t border-slate-100">
                    <p class="text-xs text-slate-500">Est. Audience: 14.2M</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== PARTNERS TAB ==================== -->
          <div class="plan-content hidden" data-plan-content="partners">
            <div class="space-y-6">
              <!-- Recommended Publishers -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h3 class="font-semibold text-slate-800">Recommended Publishers</h3>
                    <p class="text-sm text-slate-500">AI-optimized partner selection based on audience and objectives</p>
                  </div>
                  <button class="px-4 py-2 text-sm text-purple-600 border border-purple-200 rounded-xl hover:bg-purple-50">Export List</button>
                </div>
                <div class="grid grid-cols-3 gap-4">
                  <!-- Publisher Cards -->
                  <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 border border-purple-200">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm">
                        <span class="text-lg font-bold text-purple-600">9</span>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Nine Entertainment</h4>
                        <p class="text-xs text-slate-500">TV, BVOD, Digital</p>
                      </div>
                    </div>
                    <div class="space-y-2 mb-3">
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Reach Index</span>
                        <span class="font-medium text-purple-700">142</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Brand Safety</span>
                        <span class="font-medium text-green-600">98%</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Audience Match</span>
                        <span class="font-medium text-purple-700">85%</span>
                      </div>
                    </div>
                    <p class="text-xs text-slate-600 bg-white/50 rounded-lg p-2">Strong prime-time reach with family audiences. Premium BVOD inventory on 9Now.</p>
                  </div>

                  <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm">
                        <span class="text-lg font-bold text-blue-600">7</span>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Seven West Media</h4>
                        <p class="text-xs text-slate-500">TV, BVOD, Digital</p>
                      </div>
                    </div>
                    <div class="space-y-2 mb-3">
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Reach Index</span>
                        <span class="font-medium">138</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Brand Safety</span>
                        <span class="font-medium text-green-600">97%</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Audience Match</span>
                        <span class="font-medium">82%</span>
                      </div>
                    </div>
                    <p class="text-xs text-slate-600 bg-white/50 rounded-lg p-2">Sports content leader. Strong news and reality programming reach.</p>
                  </div>

                  <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm">
                        <span class="text-lg font-bold text-red-600">10</span>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Paramount / 10</h4>
                        <p class="text-xs text-slate-500">TV, BVOD, Streaming</p>
                      </div>
                    </div>
                    <div class="space-y-2 mb-3">
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Reach Index</span>
                        <span class="font-medium">125</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Brand Safety</span>
                        <span class="font-medium text-green-600">96%</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Audience Match</span>
                        <span class="font-medium">78%</span>
                      </div>
                    </div>
                    <p class="text-xs text-slate-600 bg-white/50 rounded-lg p-2">Younger demo strength. Paramount+ SVOD opportunities.</p>
                  </div>

                  <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm">
                        <span class="text-sm font-bold text-blue-500">Meta</span>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">Meta Platforms</h4>
                        <p class="text-xs text-slate-500">Social, Video</p>
                      </div>
                    </div>
                    <div class="space-y-2 mb-3">
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Reach Index</span>
                        <span class="font-medium">168</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Brand Safety</span>
                        <span class="font-medium text-amber-600">89%</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Audience Match</span>
                        <span class="font-medium">91%</span>
                      </div>
                    </div>
                    <p class="text-xs text-slate-600 bg-white/50 rounded-lg p-2">Highest audience match. Excellent targeting and measurement.</p>
                  </div>

                  <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm">
                        <span class="text-sm font-bold text-red-500">YT</span>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">YouTube / Google</h4>
                        <p class="text-xs text-slate-500">Video, Display, Search</p>
                      </div>
                    </div>
                    <div class="space-y-2 mb-3">
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Reach Index</span>
                        <span class="font-medium">172</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Brand Safety</span>
                        <span class="font-medium text-amber-600">87%</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Audience Match</span>
                        <span class="font-medium">88%</span>
                      </div>
                    </div>
                    <p class="text-xs text-slate-600 bg-white/50 rounded-lg p-2">Massive reach and video scale. Connected TV growth opportunity.</p>
                  </div>

                  <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm">
                        <span class="text-sm font-bold text-green-600">JCD</span>
                      </div>
                      <div>
                        <h4 class="font-semibold text-slate-800">JCDecaux</h4>
                        <p class="text-xs text-slate-500">OOH, Digital OOH</p>
                      </div>
                    </div>
                    <div class="space-y-2 mb-3">
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Reach Index</span>
                        <span class="font-medium">145</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Brand Safety</span>
                        <span class="font-medium text-green-600">99%</span>
                      </div>
                      <div class="flex justify-between text-sm">
                        <span class="text-slate-600">Audience Match</span>
                        <span class="font-medium">76%</span>
                      </div>
                    </div>
                    <p class="text-xs text-slate-600 bg-white/50 rounded-lg p-2">Premium street furniture and airport inventory. High dwell locations.</p>
                  </div>
                </div>
              </div>

              <!-- Format Prioritisation Table -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Format Prioritisation</h3>
                <div class="overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b border-slate-200">
                        <th class="pb-3 text-left font-medium text-slate-600">Publisher</th>
                        <th class="pb-3 text-left font-medium text-slate-600">Format</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Est. Reach</th>
                        <th class="pb-3 text-right font-medium text-slate-600">CPM</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Brand Safety</th>
                        <th class="pb-3 text-center font-medium text-slate-600">Priority</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3">Nine Entertainment</td>
                        <td class="py-3">FTA TV 30s</td>
                        <td class="py-3 text-right">2.4M</td>
                        <td class="py-3 text-right">$32.50</td>
                        <td class="py-3 text-right text-green-600">98%</td>
                        <td class="py-3 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3">Nine Entertainment</td>
                        <td class="py-3">BVOD Pre-roll 15s</td>
                        <td class="py-3 text-right">1.8M</td>
                        <td class="py-3 text-right">$45.00</td>
                        <td class="py-3 text-right text-green-600">97%</td>
                        <td class="py-3 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3">Meta</td>
                        <td class="py-3">Facebook Video Feed</td>
                        <td class="py-3 text-right">3.2M</td>
                        <td class="py-3 text-right">$12.00</td>
                        <td class="py-3 text-right text-amber-600">89%</td>
                        <td class="py-3 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3">Meta</td>
                        <td class="py-3">Instagram Reels</td>
                        <td class="py-3 text-right">2.1M</td>
                        <td class="py-3 text-right">$15.00</td>
                        <td class="py-3 text-right text-amber-600">88%</td>
                        <td class="py-3 text-center"><span class="px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs">Medium</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3">YouTube</td>
                        <td class="py-3">TrueView In-Stream</td>
                        <td class="py-3 text-right">4.1M</td>
                        <td class="py-3 text-right">$18.00</td>
                        <td class="py-3 text-right text-amber-600">87%</td>
                        <td class="py-3 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3">JCDecaux</td>
                        <td class="py-3">Digital Street Furniture</td>
                        <td class="py-3 text-right">2.8M</td>
                        <td class="py-3 text-right">$8.50</td>
                        <td class="py-3 text-right text-green-600">99%</td>
                        <td class="py-3 text-center"><span class="px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3">oOh!media</td>
                        <td class="py-3">Large Format Billboard</td>
                        <td class="py-3 text-right">1.9M</td>
                        <td class="py-3 text-right">$6.20</td>
                        <td class="py-3 text-right text-green-600">99%</td>
                        <td class="py-3 text-center"><span class="px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs">Medium</span></td>
                      </tr>
                      <tr class="hover:bg-slate-50">
                        <td class="py-3">Seven West</td>
                        <td class="py-3">7plus BVOD</td>
                        <td class="py-3 text-right">1.5M</td>
                        <td class="py-3 text-right">$42.00</td>
                        <td class="py-3 text-right text-green-600">96%</td>
                        <td class="py-3 text-center"><span class="px-2 py-1 bg-amber-100 text-amber-700 rounded-full text-xs">Medium</span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Performance Summary -->
              <div class="grid grid-cols-4 gap-4">
                <div class="bg-white rounded-xl p-4 border border-slate-200">
                  <p class="text-xs text-slate-500 mb-1">Total Est. Reach</p>
                  <p class="text-2xl font-bold text-slate-800">19.8M</p>
                  <p class="text-xs text-green-600">78% of target audience</p>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200">
                  <p class="text-xs text-slate-500 mb-1">Avg. CPM</p>
                  <p class="text-2xl font-bold text-slate-800">$22.40</p>
                  <p class="text-xs text-green-600">-8% vs category avg</p>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200">
                  <p class="text-xs text-slate-500 mb-1">Avg. Brand Safety</p>
                  <p class="text-2xl font-bold text-green-600">94.1%</p>
                  <p class="text-xs text-green-600">Above threshold (90%)</p>
                </div>
                <div class="bg-white rounded-xl p-4 border border-slate-200">
                  <p class="text-xs text-slate-500 mb-1">Partners Selected</p>
                  <p class="text-2xl font-bold text-purple-600">8</p>
                  <p class="text-xs text-slate-500">Across 4 channels</p>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== FORECAST TAB ==================== -->
          <div class="plan-content hidden" data-plan-content="forecast">
            <div class="space-y-6">
              <!-- Outcomes Forecasting Header -->
              <div class="bg-gradient-to-r from-green-600 to-emerald-700 rounded-2xl p-6 text-white">
                <h3 class="text-xl font-bold mb-2">Outcomes Forecasting</h3>
                <p class="text-green-100">Projected campaign performance based on channel investment and historical benchmarks</p>
              </div>

              <!-- KPI Projections -->
              <div class="grid grid-cols-4 gap-4">
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-3">
                    <span class="text-slate-500 text-sm">Projected Reach</span>
                    <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                      <svg class="w-4 h-4 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    </div>
                  </div>
                  <p class="text-2xl font-bold text-slate-800">78%</p>
                  <p class="text-xs text-green-600 mt-1">+6pts vs benchmark</p>
                  <div class="mt-3 pt-3 border-t border-slate-100">
                    <p class="text-xs text-slate-500">Target: 75% | Confidence: High</p>
                  </div>
                </div>
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-3">
                    <span class="text-slate-500 text-sm">Awareness Lift</span>
                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                      <svg class="w-4 h-4 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                    </div>
                  </div>
                  <p class="text-2xl font-bold text-slate-800">+5.2pts</p>
                  <p class="text-xs text-green-600 mt-1">Above target (+5pts)</p>
                  <div class="mt-3 pt-3 border-t border-slate-100">
                    <p class="text-xs text-slate-500">72% to 77.2% | Confidence: Med</p>
                  </div>
                </div>
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-3">
                    <span class="text-slate-500 text-sm">Consideration Lift</span>
                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                      <svg class="w-4 h-4 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg>
                    </div>
                  </div>
                  <p class="text-2xl font-bold text-slate-800">+7.8pts</p>
                  <p class="text-xs text-amber-600 mt-1">Slightly below (+8pts)</p>
                  <div class="mt-3 pt-3 border-t border-slate-100">
                    <p class="text-xs text-slate-500">45% to 52.8% | Confidence: Med</p>
                  </div>
                </div>
                <div class="bg-white rounded-2xl p-5 border border-slate-200 shadow-sm">
                  <div class="flex items-center justify-between mb-3">
                    <span class="text-slate-500 text-sm">Sales Impact</span>
                    <div class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center">
                      <svg class="w-4 h-4 text-amber-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                    </div>
                  </div>
                  <p class="text-2xl font-bold text-slate-800">+$5.8M</p>
                  <p class="text-xs text-green-600 mt-1">+12.9% incremental</p>
                  <div class="mt-3 pt-3 border-t border-slate-100">
                    <p class="text-xs text-slate-500">$45M to $50.8M | Confidence: Med</p>
                  </div>
                </div>
              </div>

              <!-- Channel Investment to Outcomes -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Channel Investment to Projected Buying Targets</h3>
                <div class="overflow-x-auto">
                  <table class="w-full text-sm">
                    <thead>
                      <tr class="border-b border-slate-200">
                        <th class="pb-3 text-left font-medium text-slate-600">Channel</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Investment</th>
                        <th class="pb-3 text-right font-medium text-slate-600">% of Budget</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Proj. Impressions</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Proj. Reach</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Proj. Frequency</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Awareness Contribution</th>
                        <th class="pb-3 text-right font-medium text-slate-600">Consideration Contribution</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3 font-medium">FTA TV</td>
                        <td class="py-3 text-right">$2,760,000</td>
                        <td class="py-3 text-right">35%</td>
                        <td class="py-3 text-right">142.5M</td>
                        <td class="py-3 text-right">68%</td>
                        <td class="py-3 text-right">4.2x</td>
                        <td class="py-3 text-right text-purple-600 font-medium">+2.1pts</td>
                        <td class="py-3 text-right text-blue-600 font-medium">+1.8pts</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3 font-medium">Premium VOD</td>
                        <td class="py-3 text-right">$1,440,000</td>
                        <td class="py-3 text-right">18%</td>
                        <td class="py-3 text-right">58.2M</td>
                        <td class="py-3 text-right">42%</td>
                        <td class="py-3 text-right">3.8x</td>
                        <td class="py-3 text-right text-purple-600 font-medium">+1.2pts</td>
                        <td class="py-3 text-right text-blue-600 font-medium">+1.5pts</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3 font-medium">Out of Home</td>
                        <td class="py-3 text-right">$1,965,000</td>
                        <td class="py-3 text-right">25%</td>
                        <td class="py-3 text-right">196.5M</td>
                        <td class="py-3 text-right">55%</td>
                        <td class="py-3 text-right">8.5x</td>
                        <td class="py-3 text-right text-purple-600 font-medium">+1.0pts</td>
                        <td class="py-3 text-right text-blue-600 font-medium">+0.8pts</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3 font-medium">Social</td>
                        <td class="py-3 text-right">$707,400</td>
                        <td class="py-3 text-right">9%</td>
                        <td class="py-3 text-right">117.9M</td>
                        <td class="py-3 text-right">52%</td>
                        <td class="py-3 text-right">5.8x</td>
                        <td class="py-3 text-right text-purple-600 font-medium">+0.5pts</td>
                        <td class="py-3 text-right text-blue-600 font-medium">+2.2pts</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3 font-medium">Display</td>
                        <td class="py-3 text-right">$628,800</td>
                        <td class="py-3 text-right">8%</td>
                        <td class="py-3 text-right">89.8M</td>
                        <td class="py-3 text-right">38%</td>
                        <td class="py-3 text-right">6.2x</td>
                        <td class="py-3 text-right text-purple-600 font-medium">+0.2pts</td>
                        <td class="py-3 text-right text-blue-600 font-medium">+1.0pts</td>
                      </tr>
                      <tr class="border-b border-slate-100 hover:bg-slate-50">
                        <td class="py-3 font-medium">Programmatic</td>
                        <td class="py-3 text-right">$358,800</td>
                        <td class="py-3 text-right">5%</td>
                        <td class="py-3 text-right">71.8M</td>
                        <td class="py-3 text-right">35%</td>
                        <td class="py-3 text-right">4.5x</td>
                        <td class="py-3 text-right text-purple-600 font-medium">+0.2pts</td>
                        <td class="py-3 text-right text-blue-600 font-medium">+0.5pts</td>
                      </tr>
                      <tr class="bg-purple-50 font-semibold">
                        <td class="py-3 text-purple-800">Total</td>
                        <td class="py-3 text-right text-purple-800">$7,860,000</td>
                        <td class="py-3 text-right text-purple-800">100%</td>
                        <td class="py-3 text-right text-purple-800">676.7M</td>
                        <td class="py-3 text-right text-purple-800">78%</td>
                        <td class="py-3 text-right text-purple-800">2.8x avg</td>
                        <td class="py-3 text-right text-purple-800">+5.2pts</td>
                        <td class="py-3 text-right text-purple-800">+7.8pts</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- ROI / ROAS Projections -->
              <div class="grid grid-cols-2 gap-6">
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <h4 class="font-semibold text-slate-800 mb-4">ROI Projection</h4>
                  <div class="space-y-4">
                    <div class="flex items-center justify-between p-4 bg-green-50 rounded-xl border border-green-100">
                      <div>
                        <p class="text-sm text-green-700 font-medium">Projected ROAS</p>
                        <p class="text-3xl font-bold text-green-800">3.2x</p>
                      </div>
                      <div class="text-right">
                        <p class="text-xs text-slate-500">Target: 3.0x</p>
                        <p class="text-sm text-green-600 font-medium">+6.7% above target</p>
                      </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                      <div class="bg-slate-50 rounded-xl p-4">
                        <p class="text-xs text-slate-500 mb-1">Media Investment</p>
                        <p class="text-lg font-bold text-slate-800">$7,860,000</p>
                      </div>
                      <div class="bg-slate-50 rounded-xl p-4">
                        <p class="text-xs text-slate-500 mb-1">Projected Revenue</p>
                        <p class="text-lg font-bold text-green-600">$25,152,000</p>
                      </div>
                    </div>
                    <div class="bg-slate-50 rounded-xl p-4">
                      <p class="text-xs text-slate-500 mb-1">Incremental Sales Attributed to Media</p>
                      <p class="text-lg font-bold text-slate-800">$5,800,000</p>
                      <p class="text-xs text-slate-500 mt-1">Based on marketing mix model coefficients</p>
                    </div>
                  </div>
                </div>
                <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                  <h4 class="font-semibold text-slate-800 mb-4">Efficiency Metrics</h4>
                  <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                      <span class="text-sm text-slate-600">Cost per Reach Point</span>
                      <span class="font-semibold text-slate-800">$100,769</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                      <span class="text-sm text-slate-600">Cost per Awareness Point</span>
                      <span class="font-semibold text-slate-800">$1,511,538</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                      <span class="text-sm text-slate-600">Cost per Consideration Point</span>
                      <span class="font-semibold text-slate-800">$1,007,692</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                      <span class="text-sm text-slate-600">Effective CPM</span>
                      <span class="font-semibold text-slate-800">$11.62</span>
                    </div>
                    <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl">
                      <span class="text-sm text-slate-600">Cost per Incremental Sale</span>
                      <span class="font-semibold text-slate-800">$1.36</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Confidence Bands -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h4 class="font-semibold text-slate-800 mb-4">Forecast Confidence Ranges</h4>
                <div class="grid grid-cols-4 gap-4">
                  <div class="text-center">
                    <p class="text-xs text-slate-500 mb-2">Reach</p>
                    <div class="bg-slate-100 rounded-lg p-3">
                      <p class="text-xs text-slate-400">Low</p>
                      <p class="text-sm font-medium">72%</p>
                    </div>
                    <div class="bg-purple-100 rounded-lg p-3 my-1 border-2 border-purple-300">
                      <p class="text-xs text-purple-600">Expected</p>
                      <p class="text-lg font-bold text-purple-700">78%</p>
                    </div>
                    <div class="bg-slate-100 rounded-lg p-3">
                      <p class="text-xs text-slate-400">High</p>
                      <p class="text-sm font-medium">82%</p>
                    </div>
                  </div>
                  <div class="text-center">
                    <p class="text-xs text-slate-500 mb-2">Awareness Lift</p>
                    <div class="bg-slate-100 rounded-lg p-3">
                      <p class="text-xs text-slate-400">Low</p>
                      <p class="text-sm font-medium">+3.8pts</p>
                    </div>
                    <div class="bg-purple-100 rounded-lg p-3 my-1 border-2 border-purple-300">
                      <p class="text-xs text-purple-600">Expected</p>
                      <p class="text-lg font-bold text-purple-700">+5.2pts</p>
                    </div>
                    <div class="bg-slate-100 rounded-lg p-3">
                      <p class="text-xs text-slate-400">High</p>
                      <p class="text-sm font-medium">+6.8pts</p>
                    </div>
                  </div>
                  <div class="text-center">
                    <p class="text-xs text-slate-500 mb-2">Sales Impact</p>
                    <div class="bg-slate-100 rounded-lg p-3">
                      <p class="text-xs text-slate-400">Low</p>
                      <p class="text-sm font-medium">+$4.2M</p>
                    </div>
                    <div class="bg-purple-100 rounded-lg p-3 my-1 border-2 border-purple-300">
                      <p class="text-xs text-purple-600">Expected</p>
                      <p class="text-lg font-bold text-purple-700">+$5.8M</p>
                    </div>
                    <div class="bg-slate-100 rounded-lg p-3">
                      <p class="text-xs text-slate-400">High</p>
                      <p class="text-sm font-medium">+$7.4M</p>
                    </div>
                  </div>
                  <div class="text-center">
                    <p class="text-xs text-slate-500 mb-2">ROAS</p>
                    <div class="bg-slate-100 rounded-lg p-3">
                      <p class="text-xs text-slate-400">Low</p>
                      <p class="text-sm font-medium">2.6x</p>
                    </div>
                    <div class="bg-purple-100 rounded-lg p-3 my-1 border-2 border-purple-300">
                      <p class="text-xs text-purple-600">Expected</p>
                      <p class="text-lg font-bold text-purple-700">3.2x</p>
                    </div>
                    <div class="bg-slate-100 rounded-lg p-3">
                      <p class="text-xs text-slate-400">High</p>
                      <p class="text-sm font-medium">3.8x</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ==================== EXPORT TAB ==================== -->
          <div class="plan-content hidden" data-plan-content="export">
            <div class="space-y-6">
              <!-- Partner Brief Development -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                  <div>
                    <h3 class="font-semibold text-slate-800">Partner Brief Development</h3>
                    <p class="text-sm text-slate-500">Generate comprehensive briefs for media partners</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <button class="px-4 py-2 text-sm text-slate-600 border border-slate-200 rounded-xl hover:bg-slate-50">Preview All</button>
                    <button class="px-4 py-2 lumos-gradient text-white text-sm font-medium rounded-xl">Generate Briefs</button>
                  </div>
                </div>

                <!-- Brief Templates -->
                <div class="grid grid-cols-3 gap-4 mb-6">
                  <div class="border border-slate-200 rounded-xl p-4 hover:border-purple-300 cursor-pointer transition-colors">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center">
                        <svg class="w-5 h-5 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                      </div>
                      <div>
                        <h4 class="font-medium text-slate-800">TV Brief</h4>
                        <p class="text-xs text-slate-500">FTA & BVOD Partners</p>
                      </div>
                    </div>
                    <div class="flex items-center gap-2">
                      <input type="checkbox" checked class="w-4 h-4 text-purple-600 rounded"/>
                      <span class="text-sm text-slate-600">Include in export</span>
                    </div>
                  </div>
                  <div class="border border-slate-200 rounded-xl p-4 hover:border-purple-300 cursor-pointer transition-colors">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center">
                        <svg class="w-5 h-5 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
                      </div>
                      <div>
                        <h4 class="font-medium text-slate-800">OOH Brief</h4>
                        <p class="text-xs text-slate-500">Digital & Static</p>
                      </div>
                    </div>
                    <div class="flex items-center gap-2">
                      <input type="checkbox" checked class="w-4 h-4 text-purple-600 rounded"/>
                      <span class="text-sm text-slate-600">Include in export</span>
                    </div>
                  </div>
                  <div class="border border-slate-200 rounded-xl p-4 hover:border-purple-300 cursor-pointer transition-colors">
                    <div class="flex items-center gap-3 mb-3">
                      <div class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
                        <svg class="w-5 h-5 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>
                      </div>
                      <div>
                        <h4 class="font-medium text-slate-800">Social Brief</h4>
                        <p class="text-xs text-slate-500">Meta, YouTube, TikTok</p>
                      </div>
                    </div>
                    <div class="flex items-center gap-2">
                      <input type="checkbox" checked class="w-4 h-4 text-purple-600 rounded"/>
                      <span class="text-sm text-slate-600">Include in export</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Brief Preview -->
              <div class="bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden">
                <div class="px-6 py-4 bg-slate-50 border-b border-slate-200">
                  <div class="flex items-center justify-between">
                    <h4 class="font-semibold text-slate-800">Brief Preview: TV Partner Brief</h4>
                    <div class="flex items-center gap-2">
                      <button class="p-2 hover:bg-slate-200 rounded-lg text-slate-500">
                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                      </button>
                      <button class="p-2 hover:bg-slate-200 rounded-lg text-slate-500">
                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="p-6 max-h-96 overflow-y-auto">
                  <div class="prose prose-sm max-w-none">
                    <div class="mb-6">
                      <h5 class="text-lg font-bold text-purple-800 mb-2">FMCG Brand 1 - TV Partner Brief</h5>
                      <p class="text-xs text-slate-400">Generated: January 15, 2026 | Campaign Period: Jan 1 - Jun 30, 2026</p>
                    </div>
                    
                    <div class="mb-4">
                      <h6 class="font-semibold text-slate-800 mb-2">Strategic Role</h6>
                      <p class="text-sm text-slate-600">Television serves as the primary awareness driver for this campaign, delivering mass reach against our target audience of P18-54. TV will anchor our communications strategy, building mental availability and brand salience during key cultural moments throughout H1 2026.</p>
                    </div>

                    <div class="mb-4">
                      <h6 class="font-semibold text-slate-800 mb-2">Target Audience</h6>
                      <div class="bg-slate-50 rounded-lg p-3 text-sm">
                        <p class="text-slate-600"><strong>Primary:</strong> Adults 25-44, household shoppers, suburban metro areas</p>
                        <p class="text-slate-600"><strong>Secondary:</strong> Adults 18-29, young professionals, inner city</p>
                        <p class="text-slate-600 mt-2"><strong>Key Characteristics:</strong> Brand switchers, quality-seekers, digitally engaged, family-focused</p>
                      </div>
                    </div>

                    <div class="mb-4">
                      <h6 class="font-semibold text-slate-800 mb-2">Channel Allocation</h6>
                      <div class="bg-slate-50 rounded-lg p-3">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                          <div>
                            <p class="text-slate-500">FTA TV Budget</p>
                            <p class="font-semibold text-slate-800">$2,760,000</p>
                          </div>
                          <div>
                            <p class="text-slate-500">BVOD Budget</p>
                            <p class="font-semibold text-slate-800">$1,440,000</p>
                          </div>
                          <div>
                            <p class="text-slate-500">Target Reach</p>
                            <p class="font-semibold text-slate-800">68%</p>
                          </div>
                          <div>
                            <p class="text-slate-500">Target Frequency</p>
                            <p class="font-semibold text-slate-800">4.2x</p>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="mb-4">
                      <h6 class="font-semibold text-slate-800 mb-2">Flighting Requirements</h6>
                      <p class="text-sm text-slate-600">Heavy-up periods: Weeks 1-4 (Launch), Weeks 12-13 (Easter), Weeks 25-26 (EOFY). Maintain continuous presence throughout campaign with tactical upweights around key cultural moments including Australian Open, Mother's Day, and State of Origin.</p>
                    </div>

                    <div class="mb-4">
                      <h6 class="font-semibold text-slate-800 mb-2">Creative Requirements</h6>
                      <div class="bg-slate-50 rounded-lg p-3 text-sm">
                        <p class="text-slate-600"><strong>Formats:</strong> 30s TVC (hero), 15s TVC (reminder)</p>
                        <p class="text-slate-600"><strong>Tone:</strong> Warm, authentic, family-focused</p>
                        <p class="text-slate-600"><strong>Key Message:</strong> Quality you can trust, value every day</p>
                      </div>
                    </div>

                    <div>
                      <h6 class="font-semibold text-slate-800 mb-2">KPIs & Measurement</h6>
                      <div class="bg-slate-50 rounded-lg p-3 text-sm">
                        <p class="text-slate-600"><strong>Primary:</strong> +2.1pts awareness lift contribution</p>
                        <p class="text-slate-600"><strong>Secondary:</strong> +1.8pts consideration lift contribution</p>
                        <p class="text-slate-600"><strong>Measurement:</strong> Brand tracking, reach/frequency reporting, attribution modeling</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Export Options -->
              <div class="bg-white rounded-2xl p-6 border border-slate-200 shadow-sm">
                <h3 class="font-semibold text-slate-800 mb-6">Export Options</h3>
                <div class="grid grid-cols-4 gap-4">
                  <button class="flex flex-col items-center gap-3 p-6 border border-slate-200 rounded-xl hover:border-purple-300 hover:bg-purple-50 transition-colors">
                    <div class="w-14 h-14 rounded-xl bg-blue-100 flex items-center justify-center">
                      <svg class="w-7 h-7 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                    </div>
                    <div class="text-center">
                      <p class="font-medium text-slate-800">Word Document</p>
                      <p class="text-xs text-slate-500">.docx format</p>
                    </div>
                  </button>
                  <button class="flex flex-col items-center gap-3 p-6 border border-slate-200 rounded-xl hover:border-purple-300 hover:bg-purple-50 transition-colors">
                    <div class="w-14 h-14 rounded-xl bg-red-100 flex items-center justify-center">
                      <svg class="w-7 h-7 text-red-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                    </div>
                    <div class="text-center">
                      <p class="font-medium text-slate-800">PDF Document</p>
                      <p class="text-xs text-slate-500">.pdf format</p>
                    </div>
                  </button>
                  <button class="flex flex-col items-center gap-3 p-6 border border-slate-200 rounded-xl hover:border-purple-300 hover:bg-purple-50 transition-colors">
                    <div class="w-14 h-14 rounded-xl bg-green-100 flex items-center justify-center">
                      <svg class="w-7 h-7 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><rect x="8" y="13" width="8" height="6"/></svg>
                    </div>
                    <div class="text-center">
                      <p class="font-medium text-slate-800">Excel Export</p>
                      <p class="text-xs text-slate-500">.xlsx format</p>
                    </div>
                  </button>
                  <button class="flex flex-col items-center gap-3 p-6 border border-purple-200 rounded-xl bg-purple-50">
                    <div class="w-14 h-14 rounded-xl bg-purple-100 flex items-center justify-center">
                      <svg class="w-7 h-7 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                    </div>
                    <div class="text-center">
                      <p class="font-medium text-purple-800">DeltaX Integration</p>
                      <p class="text-xs text-purple-600">Direct upload</p>
                    </div>
                  </button>
                </div>
              </div>

              <!-- Export Summary -->
              <div class="grid grid-cols-3 gap-4">
                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                  <p class="text-xs text-slate-500 mb-1">Documents to Export</p>
                  <p class="text-2xl font-bold text-slate-800">3 Briefs</p>
                  <p class="text-xs text-slate-500 mt-1">TV, OOH, Social</p>
                </div>
                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                  <p class="text-xs text-slate-500 mb-1">Total Pages</p>
                  <p class="text-2xl font-bold text-slate-800">~24 pages</p>
                  <p class="text-xs text-slate-500 mt-1">Estimated</p>
                </div>
                <div class="bg-slate-50 rounded-xl p-4 border border-slate-200">
                  <p class="text-xs text-slate-500 mb-1">Last Exported</p>
                  <p class="text-2xl font-bold text-slate-800">Never</p>
                  <p class="text-xs text-slate-500 mt-1">New plan</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- AI Button - Lumos Eye Motif -->
  <button onclick="toggleAIModal()" id="aiButton" class="ai-button fixed bottom-6 right-6 w-14 h-14 lumos-gradient rounded-full shadow-lg flex items-center justify-center hover:scale-110 transition-transform z-40">
    <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="none">
      <!-- Lumos Eye - outer shape -->
      <ellipse cx="12" cy="12" rx="10" ry="6" stroke="currentColor" stroke-width="1.5" fill="none"/>
      <!-- Inner iris -->
      <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="1.5" fill="none"/>
      <!-- Pupil with gradient -->
      <circle cx="12" cy="12" r="2" fill="currentColor"/>
      <!-- Light reflection -->
      <circle cx="10.5" cy="10.5" r="0.8" fill="currentColor" opacity="0.5"/>
      <!-- Radiating lines suggesting AI/insight -->
      <path d="M12 3 L12 5" stroke="currentColor" stroke-width="1" stroke-linecap="round"/>
      <path d="M12 19 L12 21" stroke="currentColor" stroke-width="1" stroke-linecap="round"/>
      <path d="M3 12 L5 12" stroke="currentColor" stroke-width="1" stroke-linecap="round"/>
      <path d="M19 12 L21 12" stroke="currentColor" stroke-width="1" stroke-linecap="round"/>
    </svg>
  </button>

  <!-- AI Modal - Enhanced with Agent Workstream + Project Canvas -->
  <div id="aiModal" class="modal-overlay fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-6">
    <div class="modal-container bg-white rounded-2xl shadow-2xl w-[95vw] max-w-[1400px] h-[85vh] flex flex-col overflow-hidden">
      <!-- Header -->
      <div class="flex items-center justify-between px-6 py-4 border-b border-slate-200 bg-gradient-to-r from-purple-50 to-indigo-50">
        <div class="flex items-center gap-4">
          <div class="w-10 h-10 lumos-gradient rounded-full flex items-center justify-center">
            <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none">
              <ellipse cx="12" cy="12" rx="8" ry="5" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="1.5" fill="none"/>
              <circle cx="12" cy="12" r="1.5" fill="currentColor"/>
            </svg>
          </div>
          <div>
            <h3 class="font-semibold text-slate-800">Lumos AI Planning Assistant</h3>
            <p class="text-xs text-slate-500">Media Scenario Planning & Optimisation</p>
          </div>
        </div>
        <div class="flex items-center gap-3">
          <!-- View Toggle -->
          <div class="flex items-center bg-slate-100 rounded-lg p-1">
            <button onclick="setAIView('chat')" id="chatViewBtn" class="ai-view-btn px-3 py-1.5 text-xs font-medium rounded-md bg-white text-purple-700 shadow-sm">Chat</button>
            <button onclick="setAIView('canvas')" id="canvasViewBtn" class="ai-view-btn px-3 py-1.5 text-xs font-medium rounded-md text-slate-500 hover:text-slate-700">Canvas</button>
            <button onclick="setAIView('both')" id="bothViewBtn" class="ai-view-btn px-3 py-1.5 text-xs font-medium rounded-md text-slate-500 hover:text-slate-700">Both</button>
          </div>
          <button onclick="toggleAIModal()" class="p-2 hover:bg-slate-100 rounded-lg">
            <svg class="w-5 h-5 text-slate-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
          </button>
        </div>
      </div>

      <!-- Main Content Area -->
      <div class="flex-1 flex overflow-hidden">
        <!-- Agent Workstream (Chat Panel) -->
        <div id="chatPanel" class="w-1/2 border-r border-slate-200 flex flex-col">
          <div class="px-4 py-3 border-b border-slate-100 bg-slate-50">
            <div class="flex items-center gap-2">
              <svg class="w-4 h-4 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
              <span class="text-sm font-medium text-slate-700">Agent Workstream</span>
            </div>
          </div>
          <div id="modalChatMessages" class="flex-1 overflow-auto scrollbar-thin p-4 space-y-4 bg-slate-50">
            <!-- AI Welcome Message -->
            <div class="chat-bubble flex gap-3">
              <div class="w-8 h-8 lumos-gradient rounded-full flex items-center justify-center shrink-0">
                <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none">
                  <ellipse cx="12" cy="12" rx="6" ry="4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <circle cx="12" cy="12" r="1.5" fill="currentColor"/>
                </svg>
              </div>
              <div class="flex-1">
                <div class="bg-white rounded-2xl rounded-tl-sm p-3 shadow-sm border border-slate-100">
                  <p class="text-sm text-slate-700">Do you have a brief already we can ingest or would you like to start from scratch?</p>
                </div>
                <div class="flex gap-2 mt-2">
                  <button onclick="aiQuickAction('upload')" class="px-3 py-1.5 text-xs bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors">Yes, I have a brief to upload</button>
                  <button onclick="aiQuickAction('scratch')" class="px-3 py-1.5 text-xs bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition-colors">No brief, let's build our communications task.</button>
                </div>
              </div>
            </div>
            <!-- Sample User Response -->
            <div class="chat-bubble flex gap-3 justify-end">
              <div class="max-w-[320px]">
                <div class="lumos-gradient rounded-2xl rounded-tr-sm p-3 text-white text-sm">
                  <p>Yes, I have a brief to upload</p>
                </div>
              </div>
              <div class="w-8 h-8 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center text-xs font-medium text-white shrink-0">EF</div>
            </div>
            <!-- AI Response -->
            <div class="chat-bubble flex gap-3">
              <div class="w-8 h-8 lumos-gradient rounded-full flex items-center justify-center shrink-0">
                <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none">
                  <ellipse cx="12" cy="12" rx="6" ry="4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <circle cx="12" cy="12" r="1.5" fill="currentColor"/>
                </svg>
              </div>
              <div class="flex-1">
                <div class="bg-white rounded-2xl rounded-tl-sm p-3 shadow-sm border border-slate-100">
                  <p class="text-sm text-slate-700">Great! Please upload the file now, or select from a previous brief created within the platform.</p>
                </div>
                <!-- File Upload Area -->
                <div class="mt-2 border-2 border-dashed border-purple-200 rounded-xl p-3 bg-purple-50/50 text-center">
                  <svg class="w-6 h-6 mx-auto text-purple-400 mb-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                  <p class="text-xs text-purple-600">Drop brief here or click to upload</p>
                </div>
              </div>
            </div>
          </div>
          <!-- Chat Input -->
          <div class="border-t border-slate-200 bg-white p-3">
            <div class="flex items-center gap-2">
              <button class="p-2 hover:bg-slate-100 rounded-lg text-slate-400">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
              </button>
              <button class="p-2 hover:bg-slate-100 rounded-lg text-slate-400">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a3 3 0 0 0-3 3v4a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg>
              </button>
              <input type="text" id="modalChatInput" placeholder="Type your prompt here..." class="flex-1 px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-purple-300" onkeypress="handleModalKeyPress(event)"/>
              <button onclick="sendModalMessage()" class="p-2.5 lumos-gradient text-white rounded-xl hover:opacity-90 transition-opacity">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Project Canvas (Charts Panel) -->
        <div id="canvasPanel" class="w-1/2 flex flex-col bg-slate-50">
          <div class="px-4 py-3 border-b border-slate-100 bg-white">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <svg class="w-4 h-4 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
                <span class="text-sm font-medium text-slate-700">Project Canvas</span>
              </div>
              <div class="flex items-center gap-1">
                <button onclick="switchCanvasView('overview')" class="canvas-tab px-2 py-1 text-xs font-medium rounded bg-purple-100 text-purple-700">Overview</button>
                <button onclick="switchCanvasView('simulation')" class="canvas-tab px-2 py-1 text-xs font-medium rounded text-slate-500 hover:bg-slate-100">Simulation</button>
                <button onclick="switchCanvasView('geo')" class="canvas-tab px-2 py-1 text-xs font-medium rounded text-slate-500 hover:bg-slate-100">Geographic</button>
                <button onclick="switchCanvasView('activation')" class="canvas-tab px-2 py-1 text-xs font-medium rounded text-slate-500 hover:bg-slate-100">Activation</button>
              </div>
            </div>
          </div>

          <div class="flex-1 overflow-auto p-4 space-y-4">
            <!-- Canvas View: Overview (Default) -->
            <div id="canvasOverview" class="canvas-view space-y-4">
              <!-- Media Mix Heatmap Chart -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <div class="flex items-center justify-between mb-3">
                  <h4 class="text-sm font-medium text-slate-700">Media Mix by Week</h4>
                  <span class="text-xs text-slate-400">27 weeks</span>
                </div>
                <div class="space-y-1">
                  <div class="flex items-center gap-1">
                    <span class="text-xs text-slate-500 w-16">TV</span>
                    <div class="flex-1 flex gap-0.5">
                      <div class="flex-1 h-5 bg-purple-700 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-600 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-300 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-200 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-200 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-300 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-purple-300 rounded-sm"></div>
                    </div>
                  </div>
                  <div class="flex items-center gap-1">
                    <span class="text-xs text-slate-500 w-16">BVOD</span>
                    <div class="flex-1 flex gap-0.5">
                      <div class="flex-1 h-5 bg-indigo-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-indigo-400 rounded-sm"></div>
                    </div>
                  </div>
                  <div class="flex items-center gap-1">
                    <span class="text-xs text-slate-500 w-16">OOH</span>
                    <div class="flex-1 flex gap-0.5">
                      <div class="flex-1 h-5 bg-pink-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-300 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-300 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-200 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-300 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-pink-300 rounded-sm"></div>
                    </div>
                  </div>
                  <div class="flex items-center gap-1">
                    <span class="text-xs text-slate-500 w-16">Social</span>
                    <div class="flex-1 flex gap-0.5">
                      <div class="flex-1 h-5 bg-cyan-300 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-cyan-400 rounded-sm"></div>
                    </div>
                  </div>
                  <div class="flex items-center gap-1">
                    <span class="text-xs text-slate-500 w-16">Display</span>
                    <div class="flex-1 flex gap-0.5">
                      <div class="flex-1 h-5 bg-amber-200 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-300 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-500 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-400 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-300 rounded-sm"></div>
                      <div class="flex-1 h-5 bg-amber-300 rounded-sm"></div>
                    </div>
                  </div>
                </div>
                <div class="flex justify-between mt-2 text-[9px] text-slate-400">
                  <span>W1</span><span>W5</span><span>W10</span><span>W15</span><span>W20</span><span>W27</span>
                </div>
              </div>

              <!-- Key Metrics Dashboard -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">Campaign Performance</h4>
                <div class="grid grid-cols-4 gap-2">
                  <div class="text-center p-2 bg-purple-50 rounded-lg">
                    <p class="text-base font-bold text-purple-700">$7.86M</p>
                    <p class="text-[10px] text-slate-500">Total Budget</p>
                  </div>
                  <div class="text-center p-2 bg-blue-50 rounded-lg">
                    <p class="text-base font-bold text-blue-700">78%</p>
                    <p class="text-[10px] text-slate-500">Total Reach</p>
                  </div>
                  <div class="text-center p-2 bg-cyan-50 rounded-lg">
                    <p class="text-base font-bold text-cyan-700">4.2x</p>
                    <p class="text-[10px] text-slate-500">Avg Frequency</p>
                  </div>
                  <div class="text-center p-2 bg-green-50 rounded-lg">
                    <p class="text-base font-bold text-green-600">3.2x</p>
                    <p class="text-[10px] text-slate-500">ROAS</p>
                  </div>
                </div>
                <div class="grid grid-cols-3 gap-2 mt-2">
                  <div class="text-center p-2 bg-slate-50 rounded-lg">
                    <p class="text-sm font-bold text-slate-700">2,847</p>
                    <p class="text-[10px] text-slate-500">Total TARPs</p>
                  </div>
                  <div class="text-center p-2 bg-slate-50 rounded-lg">
                    <p class="text-sm font-bold text-slate-700">676.7M</p>
                    <p class="text-[10px] text-slate-500">Impressions</p>
                  </div>
                  <div class="text-center p-2 bg-slate-50 rounded-lg">
                    <p class="text-sm font-bold text-slate-700">$11.62</p>
                    <p class="text-[10px] text-slate-500">Effective CPM</p>
                  </div>
                </div>
              </div>

              <!-- Channel Distribution -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">Channel Investment Split</h4>
                <div class="space-y-2">
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-14">FTA TV</span>
                    <div class="flex-1 h-4 bg-slate-100 rounded-full overflow-hidden">
                      <div class="h-full bg-purple-600 rounded-full" style="width: 35%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-slate-700 w-10">35%</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-14">BVOD</span>
                    <div class="flex-1 h-4 bg-slate-100 rounded-full overflow-hidden">
                      <div class="h-full bg-indigo-500 rounded-full" style="width: 18%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-slate-700 w-10">18%</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-14">OOH</span>
                    <div class="flex-1 h-4 bg-slate-100 rounded-full overflow-hidden">
                      <div class="h-full bg-pink-500 rounded-full" style="width: 15%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-slate-700 w-10">15%</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-14">Social</span>
                    <div class="flex-1 h-4 bg-slate-100 rounded-full overflow-hidden">
                      <div class="h-full bg-cyan-500 rounded-full" style="width: 14%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-slate-700 w-10">14%</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-14">Display</span>
                    <div class="flex-1 h-4 bg-slate-100 rounded-full overflow-hidden">
                      <div class="h-full bg-amber-500 rounded-full" style="width: 10%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-slate-700 w-10">10%</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-14">Other</span>
                    <div class="flex-1 h-4 bg-slate-100 rounded-full overflow-hidden">
                      <div class="h-full bg-slate-400 rounded-full" style="width: 8%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-slate-700 w-10">8%</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Canvas View: Simulation -->
            <div id="canvasSimulation" class="canvas-view space-y-4 hidden">
              <!-- Alpha-Beta Reach Curve -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <div class="flex items-center justify-between mb-3">
                  <h4 class="text-sm font-medium text-slate-700">Alpha-Beta Reach Simulation</h4>
                  <span class="px-2 py-0.5 bg-green-100 text-green-700 text-[10px] rounded-full">Optimal Zone</span>
                </div>
                <div class="relative h-36">
                  <svg viewBox="0 0 300 120" class="w-full h-full">
                    <defs>
                      <linearGradient id="aiReachGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#7c3aed;stop-opacity:0.3"/>
                        <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:0.05"/>
                      </linearGradient>
                    </defs>
                    <rect x="100" y="20" width="120" height="80" fill="#dcfce7" opacity="0.5" rx="4"/>
                    <text x="160" y="35" text-anchor="middle" class="text-[8px]" fill="#166534">Optimal Zone</text>
                    <path d="M20,100 Q60,95 100,70 T180,35 T260,25" fill="none" stroke="#7c3aed" stroke-width="2.5"/>
                    <path d="M20,100 Q60,95 100,70 T180,35 T260,25 L260,100 L20,100 Z" fill="url(#aiReachGradient)"/>
                    <circle cx="180" cy="35" r="5" fill="#7c3aed" stroke="white" stroke-width="2"/>
                    <text x="180" y="50" text-anchor="middle" class="text-[8px]" fill="#7c3aed">Current: 78%</text>
                    <text x="20" y="112" class="text-[8px]" fill="#94a3b8">0</text>
                    <text x="140" y="112" class="text-[8px]" fill="#94a3b8">TRPs</text>
                    <text x="260" y="112" class="text-[8px]" fill="#94a3b8">3000</text>
                  </svg>
                </div>
                <div class="grid grid-cols-3 gap-2 mt-3 pt-3 border-t border-slate-100">
                  <div class="text-center">
                    <p class="text-[10px] text-slate-500">Alpha (α)</p>
                    <p class="text-xs font-mono font-medium text-purple-700">83,908,826</p>
                  </div>
                  <div class="text-center">
                    <p class="text-[10px] text-slate-500">Beta (β)</p>
                    <p class="text-xs font-mono font-medium text-purple-700">1,433,396</p>
                  </div>
                  <div class="text-center">
                    <p class="text-[10px] text-slate-500">Multi-Reach</p>
                    <p class="text-xs font-mono font-medium text-purple-700">0.152</p>
                  </div>
                </div>
              </div>

              <!-- Channel Performance Metrics -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">Channel Performance Simulation</h4>
                <div class="overflow-x-auto">
                  <table class="w-full text-[10px]">
                    <thead>
                      <tr class="text-slate-500 border-b border-slate-100">
                        <th class="text-left py-1.5 font-medium">Channel</th>
                        <th class="text-right py-1.5 font-medium">CPM</th>
                        <th class="text-right py-1.5 font-medium">TARPs</th>
                        <th class="text-right py-1.5 font-medium">R1+</th>
                        <th class="text-right py-1.5 font-medium">Status</th>
                      </tr>
                    </thead>
                    <tbody class="text-slate-700">
                      <tr class="border-b border-slate-50">
                        <td class="py-1.5 font-medium">FTA TV Metro</td>
                        <td class="text-right">$22.50</td>
                        <td class="text-right">1,200</td>
                        <td class="text-right">58%</td>
                        <td class="text-right"><span class="px-1.5 py-0.5 bg-green-100 text-green-700 rounded text-[9px]">Optimal</span></td>
                      </tr>
                      <tr class="border-b border-slate-50">
                        <td class="py-1.5 font-medium">BVOD/AVOD</td>
                        <td class="text-right">$27.00</td>
                        <td class="text-right">680</td>
                        <td class="text-right">42%</td>
                        <td class="text-right"><span class="px-1.5 py-0.5 bg-green-100 text-green-700 rounded text-[9px]">Optimal</span></td>
                      </tr>
                      <tr class="border-b border-slate-50">
                        <td class="py-1.5 font-medium">OOH Large</td>
                        <td class="text-right">$37.92</td>
                        <td class="text-right">520</td>
                        <td class="text-right">38%</td>
                        <td class="text-right"><span class="px-1.5 py-0.5 bg-amber-100 text-amber-700 rounded text-[9px]">High</span></td>
                      </tr>
                      <tr class="border-b border-slate-50">
                        <td class="py-1.5 font-medium">Social</td>
                        <td class="text-right">$15.40</td>
                        <td class="text-right">410</td>
                        <td class="text-right">52%</td>
                        <td class="text-right"><span class="px-1.5 py-0.5 bg-green-100 text-green-700 rounded text-[9px]">Optimal</span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Seasonality Factors -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">TV Seasonality Factors</h4>
                <div class="grid grid-cols-6 gap-1">
                  <div class="text-center p-1.5 bg-red-100 rounded">
                    <p class="text-[9px] text-slate-500">Jan</p>
                    <p class="text-xs font-bold text-red-600">1.50</p>
                  </div>
                  <div class="text-center p-1.5 bg-amber-50 rounded">
                    <p class="text-[9px] text-slate-500">Feb</p>
                    <p class="text-xs font-bold text-amber-600">1.10</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-50 rounded">
                    <p class="text-[9px] text-slate-500">Mar</p>
                    <p class="text-xs font-bold text-green-600">0.90</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-50 rounded">
                    <p class="text-[9px] text-slate-500">Apr</p>
                    <p class="text-xs font-bold text-green-600">0.85</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-100 rounded">
                    <p class="text-[9px] text-slate-500">May</p>
                    <p class="text-xs font-bold text-green-600">0.78</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-100 rounded">
                    <p class="text-[9px] text-slate-500">Jun</p>
                    <p class="text-xs font-bold text-green-600">0.75</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-100 rounded">
                    <p class="text-[9px] text-slate-500">Jul</p>
                    <p class="text-xs font-bold text-green-600">0.72</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-50 rounded">
                    <p class="text-[9px] text-slate-500">Aug</p>
                    <p class="text-xs font-bold text-green-600">0.80</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-50 rounded">
                    <p class="text-[9px] text-slate-500">Sep</p>
                    <p class="text-xs font-bold text-green-600">0.90</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-100 rounded">
                    <p class="text-[9px] text-slate-500">Oct</p>
                    <p class="text-xs font-bold text-green-600">0.70</p>
                  </div>
                  <div class="text-center p-1.5 bg-green-100 rounded">
                    <p class="text-[9px] text-slate-500">Nov</p>
                    <p class="text-xs font-bold text-green-600">0.69</p>
                  </div>
                  <div class="text-center p-1.5 bg-red-50 rounded">
                    <p class="text-[9px] text-slate-500">Dec</p>
                    <p class="text-xs font-bold text-red-600">1.40</p>
                  </div>
                </div>
                <p class="text-[9px] text-slate-400 mt-2 text-center">Higher values = higher TV costs | Lower values = better buying efficiency</p>
              </div>
            </div>

            <!-- Canvas View: Geographic -->
            <div id="canvasGeo" class="canvas-view space-y-4 hidden">
              <!-- Australia Market Map -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">Geographic Investment Allocation</h4>
                <div class="flex gap-4">
                  <div class="flex-1">
                    <svg viewBox="0 0 200 180" class="w-full h-32">
                      <path d="M80,20 L130,15 L160,30 L175,60 L180,100 L165,140 L130,160 L80,155 L40,130 L25,90 L30,50 L50,30 Z"
                            fill="#e9d5ff" stroke="#7c3aed" stroke-width="1.5"/>
                      <circle cx="160" cy="55" r="12" fill="#7c3aed" opacity="0.8"/>
                      <text x="160" y="58" text-anchor="middle" class="text-[8px] font-bold" fill="white">QLD</text>
                      <circle cx="155" cy="105" r="16" fill="#7c3aed" opacity="0.9"/>
                      <text x="155" y="108" text-anchor="middle" class="text-[8px] font-bold" fill="white">NSW</text>
                      <circle cx="130" cy="135" r="14" fill="#7c3aed" opacity="0.85"/>
                      <text x="130" y="138" text-anchor="middle" class="text-[8px] font-bold" fill="white">VIC</text>
                      <circle cx="60" cy="100" r="8" fill="#7c3aed" opacity="0.6"/>
                      <text x="60" y="103" text-anchor="middle" class="text-[6px] font-bold" fill="white">WA</text>
                      <circle cx="100" cy="115" r="6" fill="#7c3aed" opacity="0.5"/>
                      <text x="100" y="117" text-anchor="middle" class="text-[5px] font-bold" fill="white">SA</text>
                    </svg>
                  </div>
                  <div class="w-28 space-y-1.5">
                    <div class="flex items-center justify-between">
                      <span class="text-[10px] text-slate-600">NSW</span>
                      <span class="text-[10px] font-bold text-purple-700">34%</span>
                    </div>
                    <div class="flex items-center justify-between">
                      <span class="text-[10px] text-slate-600">VIC</span>
                      <span class="text-[10px] font-bold text-purple-700">27%</span>
                    </div>
                    <div class="flex items-center justify-between">
                      <span class="text-[10px] text-slate-600">QLD</span>
                      <span class="text-[10px] font-bold text-purple-700">22%</span>
                    </div>
                    <div class="flex items-center justify-between">
                      <span class="text-[10px] text-slate-600">WA</span>
                      <span class="text-[10px] font-bold text-purple-700">10%</span>
                    </div>
                    <div class="flex items-center justify-between">
                      <span class="text-[10px] text-slate-600">SA</span>
                      <span class="text-[10px] font-bold text-purple-700">6.7%</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Metro/Regional Split -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">Metro vs Regional Split</h4>
                <div class="flex items-center gap-4">
                  <div class="flex-1">
                    <div class="flex items-center gap-2 mb-2">
                      <div class="w-3 h-3 bg-purple-600 rounded"></div>
                      <span class="text-xs text-slate-600">Metro</span>
                      <span class="text-xs font-bold text-slate-800 ml-auto">65%</span>
                    </div>
                    <div class="h-3 bg-slate-100 rounded-full overflow-hidden">
                      <div class="h-full bg-purple-600 rounded-full" style="width: 65%"></div>
                    </div>
                  </div>
                  <div class="flex-1">
                    <div class="flex items-center gap-2 mb-2">
                      <div class="w-3 h-3 bg-pink-500 rounded"></div>
                      <span class="text-xs text-slate-600">Regional</span>
                      <span class="text-xs font-bold text-slate-800 ml-auto">35%</span>
                    </div>
                    <div class="h-3 bg-slate-100 rounded-full overflow-hidden">
                      <div class="h-full bg-pink-500 rounded-full" style="width: 35%"></div>
                    </div>
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-3 mt-4">
                  <div class="bg-purple-50 rounded-lg p-3 text-center">
                    <p class="text-lg font-bold text-purple-700">$5.11M</p>
                    <p class="text-[10px] text-slate-500">Metro Investment</p>
                  </div>
                  <div class="bg-pink-50 rounded-lg p-3 text-center">
                    <p class="text-lg font-bold text-pink-600">$2.75M</p>
                    <p class="text-[10px] text-slate-500">Regional Investment</p>
                  </div>
                </div>
              </div>

              <!-- BDI/CDI Analysis -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">Market Opportunity Index</h4>
                <div class="space-y-2">
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-10">NSW</span>
                    <div class="flex-1 flex gap-0.5">
                      <div class="h-4 bg-purple-500 rounded-l" style="width: 55%"></div>
                      <div class="h-4 bg-cyan-400 rounded-r" style="width: 50%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-green-600 w-14 text-right">High Opp</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-10">VIC</span>
                    <div class="flex-1 flex gap-0.5">
                      <div class="h-4 bg-purple-500 rounded-l" style="width: 48%"></div>
                      <div class="h-4 bg-cyan-400 rounded-r" style="width: 52%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-green-600 w-14 text-right">High Opp</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] text-slate-500 w-10">QLD</span>
                    <div class="flex-1 flex gap-0.5">
                      <div class="h-4 bg-purple-500 rounded-l" style="width: 42%"></div>
                      <div class="h-4 bg-cyan-400 rounded-r" style="width: 38%"></div>
                    </div>
                    <span class="text-[10px] font-medium text-amber-600 w-14 text-right">Moderate</span>
                  </div>
                </div>
                <div class="flex items-center gap-4 mt-3 pt-2 border-t border-slate-100">
                  <div class="flex items-center gap-1"><div class="w-2 h-2 bg-purple-500 rounded"></div><span class="text-[9px] text-slate-500">BDI</span></div>
                  <div class="flex items-center gap-1"><div class="w-2 h-2 bg-cyan-400 rounded"></div><span class="text-[9px] text-slate-500">CDI</span></div>
                </div>
              </div>
            </div>

            <!-- Canvas View: Activation -->
            <div id="canvasActivation" class="canvas-view space-y-4 hidden">
              <!-- DeltaX Integration -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <div class="flex items-center gap-3 mb-4">
                  <div class="w-10 h-10 bg-gradient-to-br from-orange-500 to-red-500 rounded-lg flex items-center justify-center">
                    <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                  </div>
                  <div>
                    <h4 class="text-sm font-medium text-slate-700">DeltaX Integration</h4>
                    <p class="text-[10px] text-slate-500">Media Activation & Trafficking</p>
                  </div>
                  <span class="ml-auto px-2 py-0.5 bg-green-100 text-green-700 text-[10px] rounded-full">Connected</span>
                </div>
                <div class="space-y-2">
                  <div class="flex items-center justify-between p-2 bg-slate-50 rounded-lg">
                    <span class="text-xs text-slate-600">Campaign Setup</span>
                    <span class="text-[10px] text-green-600 font-medium">Ready</span>
                  </div>
                  <div class="flex items-center justify-between p-2 bg-slate-50 rounded-lg">
                    <span class="text-xs text-slate-600">IO Generation</span>
                    <span class="text-[10px] text-green-600 font-medium">Ready</span>
                  </div>
                  <div class="flex items-center justify-between p-2 bg-slate-50 rounded-lg">
                    <span class="text-xs text-slate-600">Publisher Briefs</span>
                    <span class="text-[10px] text-amber-600 font-medium">3 Pending</span>
                  </div>
                </div>
                <button class="w-full mt-3 px-4 py-2 bg-gradient-to-r from-orange-500 to-red-500 text-white text-xs font-medium rounded-lg hover:opacity-90 transition-opacity">
                  Push to DeltaX
                </button>
              </div>

              <!-- Cultural Calendar Quick View -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">Upcoming Cultural Moments</h4>
                <div class="space-y-2">
                  <div class="flex items-center gap-2 p-2 bg-blue-50 rounded-lg">
                    <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                    <span class="text-xs text-slate-700 flex-1">Australian Open</span>
                    <span class="text-[10px] text-slate-500">Jan 12-26</span>
                  </div>
                  <div class="flex items-center gap-2 p-2 bg-pink-50 rounded-lg">
                    <div class="w-2 h-2 bg-pink-500 rounded-full"></div>
                    <span class="text-xs text-slate-700 flex-1">Valentine's Day</span>
                    <span class="text-[10px] text-slate-500">Feb 14</span>
                  </div>
                  <div class="flex items-center gap-2 p-2 bg-green-50 rounded-lg">
                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                    <span class="text-xs text-slate-700 flex-1">Easter</span>
                    <span class="text-[10px] text-slate-500">Apr 20-21</span>
                  </div>
                  <div class="flex items-center gap-2 p-2 bg-purple-50 rounded-lg">
                    <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                    <span class="text-xs text-slate-700 flex-1">State of Origin I</span>
                    <span class="text-[10px] text-slate-500">Jun 4</span>
                  </div>
                </div>
              </div>

              <!-- Export Options -->
              <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4">
                <h4 class="text-sm font-medium text-slate-700 mb-3">Quick Export</h4>
                <div class="grid grid-cols-2 gap-2">
                  <button class="flex items-center gap-2 p-2 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors">
                    <svg class="w-4 h-4 text-blue-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                    <span class="text-xs text-slate-600">Word Brief</span>
                  </button>
                  <button class="flex items-center gap-2 p-2 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors">
                    <svg class="w-4 h-4 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><rect x="8" y="13" width="8" height="6"/></svg>
                    <span class="text-xs text-slate-600">Excel Plan</span>
                  </button>
                  <button class="flex items-center gap-2 p-2 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors">
                    <svg class="w-4 h-4 text-red-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg>
                    <span class="text-xs text-slate-600">PDF Report</span>
                  </button>
                  <button class="flex items-center gap-2 p-2 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors">
                    <svg class="w-4 h-4 text-purple-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="9" y1="3" x2="9" y2="21"/></svg>
                    <span class="text-xs text-slate-600">Slides</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- AI Insight (always visible at bottom) -->
            <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl border border-purple-100 p-3">
              <div class="flex items-start gap-2">
                <div class="w-6 h-6 lumos-gradient rounded-full flex items-center justify-center shrink-0">
                  <svg class="w-3 h-3 text-white" viewBox="0 0 24 24" fill="none">
                    <ellipse cx="12" cy="12" rx="6" ry="4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                    <circle cx="12" cy="12" r="1.5" fill="currentColor"/>
                  </svg>
                </div>
                <div>
                  <p class="text-xs text-slate-700">Current plan is operating at <span class="font-semibold text-green-600">optimal efficiency</span>. Alpha-Beta model suggests 78% reach at current TRP levels with room for +5% incremental reach before diminishing returns.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentStep = 1;

    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.querySelector(`.screen[data-screen="${screenId}"]`).classList.add('active');
    }

    function startPlanCreation() {
      currentStep = 1;
      showScreen('plan-workflow');
      updateStepUI();
      showWorkflowStep(1);
    }

    function goToStep(step) {
      currentStep = step;
      updateStepUI();
      showWorkflowStep(step);
    }

    function updateStepUI() {
      for (let i = 1; i <= 5; i++) {
        const stepItem = document.querySelector(`.step-item[data-step="${i}"]`);
        const stepLine = document.querySelector(`.step-line[data-line="${i}"]`);
        stepItem.classList.remove('completed', 'active', 'pending');
        if (i < currentStep) { stepItem.classList.add('completed'); stepItem.querySelector('.step-circle').classList.add('text-white'); }
        else if (i === currentStep) { stepItem.classList.add('active'); stepItem.querySelector('.step-circle').classList.add('text-white'); }
        else { stepItem.classList.add('pending'); stepItem.querySelector('.step-circle').classList.remove('text-white'); }
        if (stepLine) {
          stepLine.classList.remove('completed', 'active', 'pending');
          if (i < currentStep) stepLine.classList.add('completed');
          else if (i === currentStep) stepLine.classList.add('active');
          else stepLine.classList.add('pending');
        }
      }
    }

    function showWorkflowStep(step) {
      document.querySelectorAll('.workflow-step').forEach(s => s.classList.add('hidden'));
      document.querySelector(`.workflow-step[data-workflow-step="${step}"]`).classList.remove('hidden');
    }

    function showInsightTab(tabName) {
      document.querySelectorAll('.insight-tab').forEach(tab => {
        tab.classList.remove('text-purple-600', 'border-purple-600');
        tab.classList.add('text-slate-400', 'border-transparent');
      });
      const activeTab = document.querySelector(`.insight-tab[data-insight-tab="${tabName}"]`);
      activeTab.classList.add('text-purple-600', 'border-purple-600');
      activeTab.classList.remove('text-slate-400', 'border-transparent');
      document.querySelectorAll('.insight-content').forEach(c => c.classList.add('hidden'));
      document.querySelector(`.insight-content[data-insight-content="${tabName}"]`).classList.remove('hidden');
    }

    function completePlanCreation() {
      showScreen('plan-detail');
      showPlanTab('brief');
    }

    function openPlanDetail(planId) {
      showScreen('plan-detail');
      showPlanTab('brief');
    }

    function showPlanTab(tabName) {
      document.querySelectorAll('.plan-tab').forEach(tab => {
        tab.classList.remove('active', 'text-purple-600', 'border-purple-600');
        tab.classList.add('text-slate-500', 'border-transparent');
      });
      const activeTab = document.querySelector(`.plan-tab[data-plan-tab="${tabName}"]`);
      activeTab.classList.add('active', 'text-purple-600', 'border-purple-600');
      activeTab.classList.remove('text-slate-500', 'border-transparent');
      document.querySelectorAll('.plan-content').forEach(c => c.classList.add('hidden'));
      document.querySelector(`.plan-content[data-plan-content="${tabName}"]`).classList.remove('hidden');
    }

    function showAudienceTab(tabName) {
      document.querySelectorAll('.audience-tab').forEach(tab => {
        tab.classList.remove('active', 'text-purple-600', 'border-purple-600');
        tab.classList.add('text-slate-400', 'border-transparent');
      });
      const activeTab = document.querySelector(`.audience-tab[data-audience-tab="${tabName}"]`);
      activeTab.classList.add('active', 'text-purple-600', 'border-purple-600');
      activeTab.classList.remove('text-slate-400', 'border-transparent');
      document.querySelectorAll('.audience-content').forEach(c => c.classList.add('hidden'));
      document.querySelector(`.audience-content[data-audience-content="${tabName}"]`).classList.remove('hidden');
    }

    function showFlightingOption(optionName) {
      document.querySelectorAll('.flighting-tab').forEach(tab => {
        tab.classList.remove('border-purple-600', 'text-purple-600');
        tab.classList.add('border-transparent', 'text-slate-500');
      });
      const activeTab = document.querySelector(`.flighting-tab[data-flighting-tab="${optionName}"]`);
      activeTab.classList.add('border-purple-600', 'text-purple-600');
      activeTab.classList.remove('border-transparent', 'text-slate-500');
      document.querySelectorAll('.flighting-content').forEach(c => c.classList.add('hidden'));
      document.querySelector(`.flighting-content[data-flighting-content="${optionName}"]`).classList.remove('hidden');
    }

    function recalculateMetrics() {
      // Show loading state
      const btn = event.target.closest('button');
      const originalText = btn.innerHTML;
      btn.innerHTML = `<svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/></svg>Calculating...`;
      btn.disabled = true;

      // Simulate calculation
      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.disabled = false;
        // Show success toast
        const toast = document.createElement('div');
        toast.className = 'fixed bottom-6 right-6 bg-green-600 text-white px-4 py-3 rounded-xl shadow-lg flex items-center gap-2 text-sm z-50';
        toast.innerHTML = `<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>Metrics recalculated successfully`;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      }, 1500);
    }

    function runOptimisation() {
      const btn = event.target.closest('button');
      const originalText = btn.innerHTML;
      btn.innerHTML = `<svg class="w-4 h-4 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/></svg>Optimising...`;
      btn.disabled = true;

      setTimeout(() => {
        btn.innerHTML = originalText;
        btn.disabled = false;
        const toast = document.createElement('div');
        toast.className = 'fixed bottom-6 right-6 bg-green-600 text-white px-4 py-3 rounded-xl shadow-lg flex items-center gap-2 text-sm z-50';
        toast.innerHTML = `<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>Optimisation complete - 3 scenarios generated`;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      }, 2000);
    }

    function selectScenario(scenario) {
      document.querySelectorAll('.scenario-card').forEach(card => {
        card.classList.remove('bg-purple-50', 'border-2', 'border-purple-400');
        card.classList.add('bg-white', 'border', 'border-slate-200');
        const checkmark = card.querySelector('.absolute');
        if (checkmark) checkmark.remove();
      });

      const selectedCard = event.target.closest('.scenario-card');
      selectedCard.classList.remove('bg-white', 'border', 'border-slate-200');
      selectedCard.classList.add('bg-purple-50', 'border-2', 'border-purple-400');

      const checkmark = document.createElement('div');
      checkmark.className = 'absolute top-3 right-3';
      checkmark.innerHTML = `<div class="w-5 h-5 bg-purple-600 rounded-full flex items-center justify-center"><svg class="w-3 h-3 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg></div>`;
      selectedCard.appendChild(checkmark);

      const scenarioNames = { a: 'Scenario A', b: 'Scenario B', c: 'Scenario C' };
      const toast = document.createElement('div');
      toast.className = 'fixed bottom-6 right-6 bg-purple-600 text-white px-4 py-3 rounded-xl shadow-lg flex items-center gap-2 text-sm z-50';
      toast.innerHTML = `<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>${scenarioNames[scenario]} selected`;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2000);
    }

    function toggleAIModal() {
      const modal = document.getElementById('aiModal');
      const button = document.getElementById('aiButton');
      modal.classList.toggle('active');
      button.style.display = modal.classList.contains('active') ? 'none' : 'flex';
    }

    function handleModalKeyPress(event) { if (event.key === 'Enter') sendModalMessage(); }

    function sendModalMessage() {
      const input = document.getElementById('modalChatInput');
      const message = input.value.trim();
      if (!message) return;
      const chat = document.getElementById('modalChatMessages');
      chat.insertAdjacentHTML('beforeend', `<div class="chat-bubble flex gap-3 justify-end"><div class="max-w-[280px]"><div class="lumos-gradient rounded-2xl rounded-tr-sm p-3 text-white text-sm"><p>${message}</p></div></div><div class="w-8 h-8 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center text-xs font-medium text-white shrink-0">EF</div></div>`);
      input.value = '';
      chat.scrollTop = chat.scrollHeight;
      setTimeout(() => {
        chat.insertAdjacentHTML('beforeend', `<div class="chat-bubble flex gap-3"><div class="w-8 h-8 lumos-gradient rounded-full flex items-center justify-center shrink-0"><svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a3 3 0 0 0-3 3v4a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/></svg></div><div class="flex-1"><div class="bg-white rounded-2xl rounded-tl-sm p-3 shadow-sm border border-slate-100"><p class="text-sm text-slate-700">I can help with that! Based on your plan data, I'd recommend optimizing your channel mix for better reach.</p></div></div></div>`);
        chat.scrollTop = chat.scrollHeight;
      }, 1000);
    }

    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && document.getElementById('aiModal').classList.contains('active')) toggleAIModal(); });
    document.getElementById('aiModal').addEventListener('click', (e) => { if (e.target.id === 'aiModal') toggleAIModal(); });
    updateStepUI();

    // Canvas View Switching in AI Modal
    function switchCanvasView(viewName) {
      // Update tab buttons
      document.querySelectorAll('.canvas-tab').forEach(tab => {
        tab.classList.remove('bg-purple-100', 'text-purple-700');
        tab.classList.add('text-slate-500');
      });
      event.target.classList.remove('text-slate-500');
      event.target.classList.add('bg-purple-100', 'text-purple-700');

      // Show/hide canvas views
      document.querySelectorAll('.canvas-view').forEach(v => v.classList.add('hidden'));
      const viewId = 'canvas' + viewName.charAt(0).toUpperCase() + viewName.slice(1);
      const targetView = document.getElementById(viewId);
      if (targetView) targetView.classList.remove('hidden');
    }

    // Simulation Animation Functions
    let simulationRunning = false;
    function restartSimulation() {
      if (simulationRunning) return;
      simulationRunning = true;

      // Reset all elements
      document.querySelectorAll('.lumos-race-bar, .trad-race-bar, .comp-race-bar').forEach(el => el.style.width = '0%');
      document.querySelectorAll('.lumos-marker, .trad-marker, .comp-marker').forEach(el => el.style.left = '8%');
      document.querySelectorAll('.lumos-reach-label, .trad-reach-label, .comp-reach-label').forEach(el => {
        el.style.left = '8%';
        el.textContent = '0%';
      });
      document.getElementById('winnerBadge').style.opacity = '0';

      // Animation keyframes - Lumos reaches 78% at week 16, Traditional reaches 65% at week 24, Competitor reaches 58% at week 26
      const frames = [
        { week: 0, lumos: 0, trad: 0, comp: 0 },
        { week: 2, lumos: 15, trad: 8, comp: 6 },
        { week: 4, lumos: 28, trad: 15, comp: 12 },
        { week: 6, lumos: 40, trad: 22, comp: 18 },
        { week: 8, lumos: 52, trad: 28, comp: 24 },
        { week: 10, lumos: 62, trad: 34, comp: 30 },
        { week: 12, lumos: 70, trad: 40, comp: 36 },
        { week: 14, lumos: 75, trad: 46, comp: 42 },
        { week: 16, lumos: 78, trad: 52, comp: 48 },
        { week: 18, lumos: 78, trad: 56, comp: 52 },
        { week: 20, lumos: 78, trad: 60, comp: 54 },
        { week: 22, lumos: 78, trad: 63, comp: 56 },
        { week: 24, lumos: 78, trad: 65, comp: 57 },
        { week: 26, lumos: 78, trad: 65, comp: 58 }
      ];

      let frameIndex = 0;
      const interval = setInterval(() => {
        if (frameIndex >= frames.length) {
          clearInterval(interval);
          document.getElementById('winnerBadge').style.opacity = '1';
          simulationRunning = false;
          return;
        }

        const f = frames[frameIndex];
        const maxWeek = 26;
        const lumosPos = 8 + (f.lumos / 78 * 75); // Scale to 75% of track
        const tradPos = 8 + (f.trad / 78 * 75);
        const compPos = 8 + (f.comp / 78 * 75);

        document.querySelector('.lumos-race-bar').style.width = (f.lumos / 78 * 83) + '%';
        document.querySelector('.lumos-marker').style.left = lumosPos + '%';
        document.querySelector('.lumos-reach-label').style.left = lumosPos + '%';
        document.querySelector('.lumos-reach-label').textContent = f.lumos + '%';

        document.querySelector('.trad-race-bar').style.width = (f.trad / 78 * 83) + '%';
        document.querySelector('.trad-marker').style.left = tradPos + '%';
        document.querySelector('.trad-reach-label').style.left = tradPos + '%';
        document.querySelector('.trad-reach-label').textContent = f.trad + '%';

        document.querySelector('.comp-race-bar').style.width = (f.comp / 78 * 83) + '%';
        document.querySelector('.comp-marker').style.left = compPos + '%';
        document.querySelector('.comp-reach-label').style.left = compPos + '%';
        document.querySelector('.comp-reach-label').textContent = f.comp + '%';

        frameIndex++;
      }, 400);
    }

    // Auto-start simulation when Performance tab is shown
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => restartSimulation(), 1000);
    });

    // Regional Map Tooltip Functions
    function showRegionTooltip(event, region, spend, share, population) {
      const tooltip = document.getElementById('regionTooltip');
      document.getElementById('tooltipRegion').textContent = getRegionFullName(region);
      document.getElementById('tooltipSpend').textContent = spend;
      document.getElementById('tooltipShare').textContent = share;
      document.getElementById('tooltipPop').textContent = population;

      const rect = event.target.getBoundingClientRect();
      const containerRect = event.target.closest('.relative').getBoundingClientRect();

      tooltip.style.left = (rect.left - containerRect.left + rect.width / 2 - 90) + 'px';
      tooltip.style.top = (rect.top - containerRect.top - 100) + 'px';
      tooltip.classList.remove('hidden');
    }

    function hideRegionTooltip() {
      document.getElementById('regionTooltip').classList.add('hidden');
    }

    function getRegionFullName(abbr) {
      const names = {
        'NSW': 'New South Wales',
        'VIC': 'Victoria',
        'QLD': 'Queensland',
        'WA': 'Western Australia',
        'SA': 'South Australia',
        'TAS': 'Tasmania',
        'ACT': 'Australian Capital Territory',
        'NT': 'Northern Territory'
      };
      return names[abbr] || abbr;
    }

    // AI View Toggle Functions
    function setAIView(view) {
      const chatPanel = document.getElementById('chatPanel');
      const canvasPanel = document.getElementById('canvasPanel');
      const chatBtn = document.getElementById('chatViewBtn');
      const canvasBtn = document.getElementById('canvasViewBtn');
      const bothBtn = document.getElementById('bothViewBtn');

      // Reset all buttons
      [chatBtn, canvasBtn, bothBtn].forEach(btn => {
        btn.classList.remove('bg-white', 'text-purple-700', 'shadow-sm');
        btn.classList.add('text-slate-500');
      });

      if (view === 'chat') {
        chatPanel.classList.remove('hidden');
        chatPanel.classList.add('w-full');
        chatPanel.classList.remove('w-1/2');
        canvasPanel.classList.add('hidden');
        chatBtn.classList.add('bg-white', 'text-purple-700', 'shadow-sm');
        chatBtn.classList.remove('text-slate-500');
      } else if (view === 'canvas') {
        chatPanel.classList.add('hidden');
        canvasPanel.classList.remove('hidden');
        canvasPanel.classList.add('w-full');
        canvasPanel.classList.remove('w-1/2');
        canvasBtn.classList.add('bg-white', 'text-purple-700', 'shadow-sm');
        canvasBtn.classList.remove('text-slate-500');
      } else { // both
        chatPanel.classList.remove('hidden');
        chatPanel.classList.remove('w-full');
        chatPanel.classList.add('w-1/2');
        canvasPanel.classList.remove('hidden');
        canvasPanel.classList.remove('w-full');
        canvasPanel.classList.add('w-1/2');
        bothBtn.classList.add('bg-white', 'text-purple-700', 'shadow-sm');
        bothBtn.classList.remove('text-slate-500');
      }
    }

    // AI Quick Action Handler
    function aiQuickAction(action) {
      const chat = document.getElementById('modalChatMessages');
      if (action === 'upload') {
        chat.insertAdjacentHTML('beforeend', `
          <div class="chat-bubble flex gap-3 justify-end">
            <div class="max-w-[320px]">
              <div class="lumos-gradient rounded-2xl rounded-tr-sm p-3 text-white text-sm">
                <p>Yes, I have a brief to upload</p>
              </div>
            </div>
            <div class="w-8 h-8 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center text-xs font-medium text-white shrink-0">EF</div>
          </div>
        `);
      } else {
        chat.insertAdjacentHTML('beforeend', `
          <div class="chat-bubble flex gap-3 justify-end">
            <div class="max-w-[320px]">
              <div class="lumos-gradient rounded-2xl rounded-tr-sm p-3 text-white text-sm">
                <p>No brief, let's build our communications task.</p>
              </div>
            </div>
            <div class="w-8 h-8 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center text-xs font-medium text-white shrink-0">EF</div>
          </div>
        `);
      }
      chat.scrollTop = chat.scrollHeight;

      // AI response after selection
      setTimeout(() => {
        if (action === 'upload') {
          chat.insertAdjacentHTML('beforeend', `
            <div class="chat-bubble flex gap-3">
              <div class="w-8 h-8 lumos-gradient rounded-full flex items-center justify-center shrink-0">
                <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none">
                  <ellipse cx="12" cy="12" rx="6" ry="4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <circle cx="12" cy="12" r="1.5" fill="currentColor"/>
                </svg>
              </div>
              <div class="flex-1">
                <div class="bg-white rounded-2xl rounded-tl-sm p-3 shadow-sm border border-slate-100">
                  <p class="text-sm text-slate-700">Great! Please upload the file now, or select from a previous brief created within the platform.</p>
                </div>
                <div class="mt-2 border-2 border-dashed border-purple-200 rounded-xl p-4 bg-purple-50/50 text-center cursor-pointer hover:bg-purple-100/50 transition-colors">
                  <svg class="w-8 h-8 mx-auto text-purple-400 mb-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                  <p class="text-sm text-purple-600 font-medium">Drop brief here or click to upload</p>
                  <p class="text-xs text-purple-400 mt-1">Supports PDF, DOCX, TXT</p>
                </div>
              </div>
            </div>
          `);
        } else {
          chat.insertAdjacentHTML('beforeend', `
            <div class="chat-bubble flex gap-3">
              <div class="w-8 h-8 lumos-gradient rounded-full flex items-center justify-center shrink-0">
                <svg class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none">
                  <ellipse cx="12" cy="12" rx="6" ry="4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                  <circle cx="12" cy="12" r="1.5" fill="currentColor"/>
                </svg>
              </div>
              <div class="flex-1">
                <div class="bg-white rounded-2xl rounded-tl-sm p-3 shadow-sm border border-slate-100">
                  <p class="text-sm text-slate-700">Let's build your communications task from scratch. First, tell me about your campaign objectives:</p>
                  <ul class="mt-2 space-y-1 text-xs text-slate-600">
                    <li class="flex items-center gap-2"><span class="w-1.5 h-1.5 bg-purple-500 rounded-full"></span>What's the primary goal? (Awareness, Consideration, Purchase)</li>
                    <li class="flex items-center gap-2"><span class="w-1.5 h-1.5 bg-purple-500 rounded-full"></span>Who is your target audience?</li>
                    <li class="flex items-center gap-2"><span class="w-1.5 h-1.5 bg-purple-500 rounded-full"></span>What's your budget range?</li>
                  </ul>
                </div>
              </div>
            </div>
          `);
        }
        chat.scrollTop = chat.scrollHeight;
      }, 800);
    }

    // Initialize AI modal with both view by default
    document.addEventListener('DOMContentLoaded', () => {
      setAIView('both');
    });

    // ==================== BUDGET ALLOCATION CALCULATOR ====================
    // CPM Data from Excel PlanBuilder Worksheet (CPMs & CPTs sheet)
    const cpmData = {
      // Channel: { demographic: CPM }
      'TV 30s (Metro + Regional)': { 'P18-54': 35.50, 'P25-54': 38.20, 'P18-39': 32.80, 'All People': 28.90 },
      'TV 30s (Metro Only)': { 'P18-54': 42.30, 'P25-54': 45.60, 'P18-39': 39.10, 'All People': 34.50 },
      'TV 30s (Regional Only)': { 'P18-54': 18.90, 'P25-54': 20.40, 'P18-39': 17.50, 'All People': 15.40 },
      'STV (Only) 30s': { 'P18-54': 22.50, 'P25-54': 24.30, 'P18-39': 20.80, 'All People': 18.30 },
      'TV 15s (Metro + Regional)': { 'P18-54': 24.85, 'P25-54': 26.74, 'P18-39': 22.96, 'All People': 20.23 },
      'TV 15s (Metro Only)': { 'P18-54': 29.61, 'P25-54': 31.92, 'P18-39': 27.37, 'All People': 24.15 },
      'TV 15s (Regional Only)': { 'P18-54': 13.23, 'P25-54': 14.28, 'P18-39': 12.25, 'All People': 10.78 },
      'STV (Only) 15s': { 'P18-54': 15.75, 'P25-54': 17.01, 'P18-39': 14.56, 'All People': 12.81 },
      'Premium Reservation VOD': { 'P18-54': 45.00, 'P25-54': 48.60, 'P18-39': 41.60, 'All People': 36.60 },
      'BVOD': { 'P18-54': 38.00, 'P25-54': 41.00, 'P18-39': 35.10, 'All People': 30.90 },
      'Programmatic Video': { 'P18-54': 28.50, 'P25-54': 30.80, 'P18-39': 26.30, 'All People': 23.20 },
      'Social Video': { 'P18-54': 18.00, 'P25-54': 19.40, 'P18-39': 16.60, 'All People': 14.60 },
      'Digital Branded Content': { 'P18-54': 27.00, 'P25-54': 29.16, 'P18-39': 24.95, 'All People': 21.96 },
      'Tactical OOH': { 'P18-54': 37.92, 'P25-54': 40.95, 'P18-39': 35.04, 'All People': 30.84 },
      'Small OOH': { 'P18-54': 19.86, 'P25-54': 21.45, 'P18-39': 18.35, 'All People': 16.15 },
      'Large Format OOH': { 'P18-54': 37.92, 'P25-54': 40.95, 'P18-39': 35.04, 'All People': 30.84 },
      'Social': { 'P18-54': 12.50, 'P25-54': 13.50, 'P18-39': 11.55, 'All People': 10.16 },
      'Audio Streaming': { 'P18-54': 31.88, 'P25-54': 34.43, 'P18-39': 29.46, 'All People': 25.93 },
      'Podcasts': { 'P18-54': 53.08, 'P25-54': 57.33, 'P18-39': 49.05, 'All People': 43.17 },
      'Radio': { 'P18-54': 15.80, 'P25-54': 17.06, 'P18-39': 14.60, 'All People': 12.85 },
      'Display (Programmatic)': { 'P18-54': 8.50, 'P25-54': 9.18, 'P18-39': 7.85, 'All People': 6.91 },
      'Display (Premium)': { 'P18-54': 15.20, 'P25-54': 16.42, 'P18-39': 14.04, 'All People': 12.36 },
      'Search': { 'P18-54': 2.50, 'P25-54': 2.70, 'P18-39': 2.31, 'All People': 2.03 },
      'Magazine': { 'P18-54': 45.00, 'P25-54': 48.60, 'P18-39': 41.58, 'All People': 36.60 }
    };

    // Reach curve coefficients (simplified from Excel REACH sheet)
    // Format: { maxReach, k (steepness), midpoint }
    const reachCurves = {
      'TV 30s (Metro + Regional)': { maxReach: 85, k: 0.000012, midpoint: 400000 },
      'TV 30s (Metro Only)': { maxReach: 75, k: 0.000015, midpoint: 350000 },
      'TV 30s (Regional Only)': { maxReach: 45, k: 0.000025, midpoint: 200000 },
      'STV (Only) 30s': { maxReach: 55, k: 0.000018, midpoint: 280000 },
      'Premium Reservation VOD': { maxReach: 40, k: 0.000020, midpoint: 250000 },
      'BVOD': { maxReach: 50, k: 0.000016, midpoint: 300000 },
      'Programmatic Video': { maxReach: 45, k: 0.000022, midpoint: 220000 },
      'Social Video': { maxReach: 60, k: 0.000014, midpoint: 350000 },
      'Digital Branded Content': { maxReach: 35, k: 0.000025, midpoint: 180000 },
      'Tactical OOH': { maxReach: 50, k: 0.000018, midpoint: 280000 },
      'Small OOH': { maxReach: 40, k: 0.000022, midpoint: 220000 },
      'Large Format OOH': { maxReach: 55, k: 0.000015, midpoint: 320000 },
      'Social': { maxReach: 65, k: 0.000012, midpoint: 400000 },
      'Audio Streaming': { maxReach: 35, k: 0.000028, midpoint: 160000 },
      'Podcasts': { maxReach: 25, k: 0.000035, midpoint: 120000 },
      'Radio': { maxReach: 45, k: 0.000020, midpoint: 250000 },
      'Display (Programmatic)': { maxReach: 50, k: 0.000016, midpoint: 300000 },
      'Display (Premium)': { maxReach: 40, k: 0.000022, midpoint: 220000 },
      'Search': { maxReach: 30, k: 0.000030, midpoint: 150000 },
      'Magazine': { maxReach: 20, k: 0.000040, midpoint: 100000 }
    };

    // WOA (Weeks On Air) factors from Excel
    const woaFactors = {
      'TV 30s (Metro + Regional)': { low: 2, medium: 3, high: 4 },
      'TV 30s (Metro Only)': { low: 2, medium: 3, high: 4 },
      'TV 30s (Regional Only)': { low: 2, medium: 3, high: 4 },
      'STV (Only) 30s': { low: 3, medium: 4, high: 4 },
      'Premium Reservation VOD': { low: 4, medium: 4, high: 4 },
      'BVOD': { low: 4, medium: 4, high: 4 },
      'Programmatic Video': { low: 4, medium: 4, high: 4 },
      'Social Video': { low: 4, medium: 4, high: 4 },
      'Digital Branded Content': { low: 4, medium: 4, high: 4 },
      'Tactical OOH': { low: 4, medium: 4, high: 4 },
      'Small OOH': { low: 4, medium: 4, high: 4 },
      'Large Format OOH': { low: 4, medium: 4, high: 4 },
      'Social': { low: 4, medium: 4, high: 4 },
      'Audio Streaming': { low: 4, medium: 4, high: 4 },
      'Podcasts': { low: 4, medium: 4, high: 4 },
      'Radio': { low: 3, medium: 4, high: 4 },
      'Display (Programmatic)': { low: 4, medium: 4, high: 4 },
      'Display (Premium)': { low: 4, medium: 4, high: 4 },
      'Search': { low: 4, medium: 4, high: 4 },
      'Magazine': { low: 1, medium: 2, high: 2 }
    };

    // TV Seasonality factors by month
    const seasonalityFactors = {
      'Jan': 1.15, 'Feb': 1.10, 'Mar': 1.05, 'Apr': 1.00,
      'May': 0.95, 'Jun': 0.92, 'Jul': 0.90, 'Aug': 0.92,
      'Sep': 0.98, 'Oct': 1.02, 'Nov': 1.08, 'Dec': 1.12
    };

    // Budget allocation state
    let budgetAllocation = {
      totalBudget: 5000000,
      selectedDemo: 'P18-54',
      selectedMonth: 'Jan',
      channels: {}
    };

    // Calculate reach using sigmoid curve (matches Excel REACH formula)
    function calculateReach(channel, spend) {
      const curve = reachCurves[channel];
      if (!curve || spend <= 0) return 0;
      // Sigmoid function: maxReach / (1 + e^(-k * (spend - midpoint)))
      const reach = curve.maxReach / (1 + Math.exp(-curve.k * (spend - curve.midpoint)));
      return Math.min(Math.max(reach, 0), curve.maxReach);
    }

    // Calculate impressions from spend and CPM
    function calculateImpressions(spend, cpm) {
      if (!cpm || cpm <= 0) return 0;
      return (spend / cpm) * 1000;
    }

    // Calculate GRPs (Gross Rating Points)
    function calculateGRPs(reach, frequency) {
      return reach * frequency;
    }

    // Calculate frequency from GRPs and reach (Excel formula: =IFERROR(AX37/(G37*100),0))
    function calculateFrequency(grps, reach) {
      if (!reach || reach <= 0) return 0;
      return grps / (reach * 100);
    }

    // Calculate weekly GRPs (Excel formula: =IFERROR(((G37*100)*H37)/K37,""))
    function calculateWeeklyGRPs(reach, frequency, woa) {
      if (!woa || woa <= 0) return 0;
      return ((reach * 100) * frequency) / woa;
    }

    // Get WOA based on spend level
    function getWOA(channel, spend) {
      const factors = woaFactors[channel] || { low: 4, medium: 4, high: 4 };
      if (spend < 100000) return factors.low;
      if (spend < 300000) return factors.medium;
      return factors.high;
    }

    // Get CPM for channel and demographic
    function getCPM(channel, demo) {
      const channelData = cpmData[channel];
      if (!channelData) return 0;
      return channelData[demo] || channelData['P18-54'] || 0;
    }

    // Calculate all metrics for a channel
    function calculateChannelMetrics(channel, spend, demo, month) {
      const cpm = getCPM(channel, demo);
      const seasonality = seasonalityFactors[month] || 1.0;
      const adjustedCPM = channel.includes('TV') ? cpm * seasonality : cpm;

      const impressions = calculateImpressions(spend, adjustedCPM);
      const reach = calculateReach(channel, spend);
      const woa = getWOA(channel, spend);

      // Calculate frequency based on impressions and reach
      // Simplified: frequency ≈ impressions / (reach% * universe)
      // Using rough estimate: frequency = impressions / (reach * 100000)
      const frequency = reach > 0 ? Math.min(impressions / (reach * 80000), 15) : 0;

      const grps = calculateGRPs(reach, frequency);
      const weeklyGRPs = calculateWeeklyGRPs(reach, frequency, woa);

      return {
        spend,
        cpm: adjustedCPM,
        impressions,
        reach: Math.round(reach * 10) / 10,
        frequency: Math.round(frequency * 10) / 10,
        grps: Math.round(grps),
        weeklyGRPs: Math.round(weeklyGRPs),
        woa
      };
    }

    // Calculate total reach with multi-reach adjustment (simplified)
    function calculateTotalReach(channelMetrics) {
      const reaches = Object.values(channelMetrics).map(m => m.reach / 100);
      if (reaches.length === 0) return 0;

      // Multi-reach formula: Combined reach = 1 - (1-R1)(1-R2)...(1-Rn) with diminishing factor
      let combinedReach = 1;
      reaches.forEach(r => {
        combinedReach *= (1 - r);
      });
      combinedReach = (1 - combinedReach) * 100;

      // Apply diminishing returns factor for multiple channels
      const diminishingFactor = Math.max(0.7, 1 - (reaches.length * 0.03));
      return Math.min(combinedReach * diminishingFactor, 95);
    }

    // Update budget allocation display
    function updateBudgetAllocation() {
      const container = document.getElementById('budgetAllocationTable');
      if (!container) return;

      const demo = budgetAllocation.selectedDemo;
      const month = budgetAllocation.selectedMonth;
      let totalSpend = 0;
      const channelMetrics = {};

      // Calculate metrics for each active channel
      Object.keys(budgetAllocation.channels).forEach(channel => {
        const spend = budgetAllocation.channels[channel] || 0;
        if (spend > 0) {
          channelMetrics[channel] = calculateChannelMetrics(channel, spend, demo, month);
          totalSpend += spend;
        }
      });

      // Calculate totals
      const totalReach = calculateTotalReach(channelMetrics);
      const avgFrequency = Object.values(channelMetrics).length > 0
        ? Object.values(channelMetrics).reduce((sum, m) => sum + m.frequency, 0) / Object.values(channelMetrics).length
        : 0;

      // Generate table HTML
      let tableHTML = `
        <table class="w-full text-sm">
          <thead>
            <tr class="bg-slate-50 text-slate-600 text-xs uppercase">
              <th class="px-3 py-2 text-left font-medium">Channel</th>
              <th class="px-3 py-2 text-right font-medium">%</th>
              <th class="px-3 py-2 text-right font-medium">Spend</th>
              <th class="px-3 py-2 text-right font-medium">CPM</th>
              <th class="px-3 py-2 text-right font-medium">Reach %</th>
              <th class="px-3 py-2 text-right font-medium">Freq</th>
              <th class="px-3 py-2 text-right font-medium">GRPs</th>
              <th class="px-3 py-2 text-right font-medium">Wkly GRPs</th>
              <th class="px-3 py-2 text-right font-medium">WOA</th>
            </tr>
          </thead>
          <tbody>
      `;

      Object.keys(channelMetrics).forEach(channel => {
        const m = channelMetrics[channel];
        const pct = totalSpend > 0 ? ((m.spend / totalSpend) * 100).toFixed(1) : '0.0';
        tableHTML += `
          <tr class="border-b border-slate-100 hover:bg-slate-50">
            <td class="px-3 py-2 font-medium text-slate-700">${channel}</td>
            <td class="px-3 py-2 text-right text-slate-600">${pct}%</td>
            <td class="px-3 py-2 text-right text-slate-800 font-medium">$${m.spend.toLocaleString()}</td>
            <td class="px-3 py-2 text-right text-slate-600">$${m.cpm.toFixed(2)}</td>
            <td class="px-3 py-2 text-right text-purple-600 font-medium">${m.reach.toFixed(1)}%</td>
            <td class="px-3 py-2 text-right text-slate-600">${m.frequency.toFixed(1)}x</td>
            <td class="px-3 py-2 text-right text-slate-600">${m.grps}</td>
            <td class="px-3 py-2 text-right text-slate-600">${m.weeklyGRPs}</td>
            <td class="px-3 py-2 text-right text-slate-600">${m.woa}</td>
          </tr>
        `;
      });

      // Total row
      tableHTML += `
          </tbody>
          <tfoot>
            <tr class="bg-purple-50 font-semibold text-slate-800">
              <td class="px-3 py-3">TOTAL</td>
              <td class="px-3 py-3 text-right">100%</td>
              <td class="px-3 py-3 text-right">$${totalSpend.toLocaleString()}</td>
              <td class="px-3 py-3 text-right">-</td>
              <td class="px-3 py-3 text-right text-purple-700">${totalReach.toFixed(1)}%</td>
              <td class="px-3 py-3 text-right">${avgFrequency.toFixed(1)}x</td>
              <td class="px-3 py-3 text-right" colspan="3">-</td>
            </tr>
          </tfoot>
        </table>
      `;

      container.innerHTML = tableHTML;

      // Update summary cards
      const reachCard = document.getElementById('totalReachValue');
      const spendCard = document.getElementById('totalSpendValue');
      const freqCard = document.getElementById('avgFrequencyValue');
      if (reachCard) reachCard.textContent = totalReach.toFixed(1) + '%';
      if (spendCard) spendCard.textContent = '$' + (totalSpend / 1000000).toFixed(2) + 'M';
      if (freqCard) freqCard.textContent = avgFrequency.toFixed(1) + 'x';
    }

    // Update channel spend
    function updateChannelSpend(channel, value) {
      const spend = parseFloat(value.replace(/[^0-9.]/g, '')) || 0;
      budgetAllocation.channels[channel] = spend;
      updateBudgetAllocation();
    }

    // Set demographic for calculations
    function setDemographic(demo) {
      budgetAllocation.selectedDemo = demo;
      updateBudgetAllocation();
    }

    // Set month for seasonality
    function setMonth(month) {
      budgetAllocation.selectedMonth = month;
      updateBudgetAllocation();
    }

    // Add channel to budget
    function addChannelToBudget(channel, initialSpend = 0) {
      if (!budgetAllocation.channels[channel]) {
        budgetAllocation.channels[channel] = initialSpend;
        updateBudgetAllocation();
        updateChannelInputs();
      }
    }

    // Remove channel from budget
    function removeChannelFromBudget(channel) {
      delete budgetAllocation.channels[channel];
      updateBudgetAllocation();
      updateChannelInputs();
    }

    // Update channel input fields
    function updateChannelInputs() {
      const container = document.getElementById('channelInputsContainer');
      if (!container) return;

      let html = '';
      Object.keys(budgetAllocation.channels).forEach(channel => {
        const spend = budgetAllocation.channels[channel] || 0;
        html += `
          <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-200">
            <div class="flex-1">
              <p class="text-sm font-medium text-slate-700">${channel}</p>
              <p class="text-xs text-slate-400">CPM: $${getCPM(channel, budgetAllocation.selectedDemo).toFixed(2)}</p>
            </div>
            <div class="w-32">
              <input type="text"
                     value="$${spend.toLocaleString()}"
                     onchange="updateChannelSpend('${channel}', this.value)"
                     class="w-full px-3 py-1.5 text-sm text-right border border-slate-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:outline-none"/>
            </div>
            <button onclick="removeChannelFromBudget('${channel}')" class="p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded">
              <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
          </div>
        `;
      });
      container.innerHTML = html;
    }

    // Quick allocation presets
    function applyBudgetPreset(preset) {
      const presets = {
        'balanced': {
          'TV 30s (Metro + Regional)': 1500000,
          'BVOD': 800000,
          'Social Video': 600000,
          'Large Format OOH': 500000,
          'Social': 400000,
          'Display (Programmatic)': 300000
        },
        'tv-heavy': {
          'TV 30s (Metro + Regional)': 2500000,
          'TV 30s (Metro Only)': 800000,
          'STV (Only) 30s': 600000,
          'BVOD': 500000,
          'Premium Reservation VOD': 400000
        },
        'digital-first': {
          'Social Video': 1200000,
          'Programmatic Video': 1000000,
          'Social': 800000,
          'Display (Programmatic)': 600000,
          'BVOD': 500000,
          'Search': 400000
        }
      };

      if (presets[preset]) {
        budgetAllocation.channels = { ...presets[preset] };
        updateBudgetAllocation();
        updateChannelInputs();
      }
    }

    // Initialize budget allocation on page load
    document.addEventListener('DOMContentLoaded', () => {
      // Set default channels and update UI
      applyBudgetPreset('balanced');

      // Delay to ensure DOM is ready
      setTimeout(() => {
        updateChannelInputs();
        updateBudgetAllocation();
      }, 100);
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', (e) => {
      const dropdown = document.getElementById('channelDropdown');
      const addBtn = e.target.closest('button');
      if (dropdown && !dropdown.contains(e.target) && (!addBtn || !addBtn.textContent.includes('Add Channel'))) {
        dropdown.classList.add('hidden');
      }
      // Also close the calc channel dropdown
      const calcDropdown = document.getElementById('calcChannelDropdown');
      if (calcDropdown && !calcDropdown.contains(e.target) && (!addBtn || !addBtn.textContent.includes('Add'))) {
        calcDropdown.classList.add('hidden');
      }
    });

    // ==================== NEW STEP 7 CALCULATOR FUNCTIONS ====================
    // State for the new budget calculator in Step 7
    let calcState = {
      channels: {},
      demographic: 'P18-54',
      month: 'Apr',
      totalBudget: 12000000
    };

    const channelColors = ['#8b5cf6', '#3b82f6', '#22c55e', '#f59e0b', '#ec4899', '#06b6d4', '#f97316', '#6366f1', '#14b8a6', '#ef4444'];

    // TV Seasonality factors with TARP multipliers from Excel
    const tvSeasonality = {
      'Jan': { tarp: 1.4574, reach: 1.1452 },
      'Feb': { tarp: 1.3039, reach: 1.0392 },
      'Mar': { tarp: 1.1160, reach: 0.9893 },
      'Apr': { tarp: 0.9808, reach: 0.9536 },
      'May': { tarp: 0.8762, reach: 0.9121 },
      'Jun': { tarp: 0.9465, reach: 0.9361 },
      'Jul': { tarp: 1.1301, reach: 0.9966 },
      'Aug': { tarp: 0.9757, reach: 0.9514 },
      'Sep': { tarp: 0.9918, reach: 0.9584 },
      'Oct': { tarp: 0.7165, reach: 0.8577 },
      'Nov': { tarp: 0.7316, reach: 0.8612 },
      'Dec': { tarp: 1.3284, reach: 1.0535 }
    };

    function toggleCalcChannelDropdown() {
      const dropdown = document.getElementById('calcChannelDropdown');
      dropdown.classList.toggle('hidden');
    }

    function addCalcChannel(channel) {
      if (calcState.channels[channel]) return;
      calcState.channels[channel] = 500000;
      document.getElementById('calcChannelDropdown').classList.add('hidden');
      renderCalcChannelInputs();
      updateCalcMetrics();
    }

    function removeCalcChannel(channel) {
      delete calcState.channels[channel];
      renderCalcChannelInputs();
      updateCalcMetrics();
    }

    function updateCalcChannelSpend(channel, value) {
      const spend = parseFloat(value.replace(/[^0-9.]/g, '')) * 1000 || 0;
      calcState.channels[channel] = spend;
      updateCalcMetrics();
    }

    function setCalcDemographic(demo) {
      calcState.demographic = demo;
      updateCalcMetrics();
    }

    // Budget tab switching
    function showBudgetTab(tabName) {
      document.querySelectorAll('.budget-tab').forEach(tab => {
        tab.classList.remove('text-purple-700', 'bg-purple-50', 'border-purple-600');
        tab.classList.add('text-slate-500', 'border-transparent');
      });
      const activeTab = document.querySelector(`.budget-tab[data-budget-tab="${tabName}"]`);
      if (activeTab) {
        activeTab.classList.add('text-purple-700', 'bg-purple-50', 'border-purple-600');
        activeTab.classList.remove('text-slate-500', 'border-transparent');
      }
      document.querySelectorAll('.budget-content').forEach(c => c.classList.add('hidden'));
      const activeContent = document.querySelector(`.budget-content[data-budget-content="${tabName}"]`);
      if (activeContent) activeContent.classList.remove('hidden');
    }

    function setCalcMonth(month) {
      calcState.month = month;
      const seasonality = tvSeasonality[month] || { tarp: 1.0, reach: 1.0 };
      document.getElementById('calcSeasonality').textContent = seasonality.tarp.toFixed(2) + 'x';
      updateCalcMetrics();
    }

    function clearCalcChannels() {
      calcState.channels = {};
      renderCalcChannelInputs();
      updateCalcMetrics();
    }

    function applyCalcPreset(preset) {
      calcState.channels = {};
      if (preset === 'balanced') {
        calcState.channels = {
          'TV 30s (Metro + Regional)': 3000000,
          'BVOD': 1500000,
          'Social Video': 1200000,
          'Large Format OOH': 1000000,
          'Display (Programmatic)': 800000
        };
      } else if (preset === 'tv-heavy') {
        calcState.channels = {
          'TV 30s (Metro + Regional)': 4500000,
          'TV 30s (Metro Only)': 1500000,
          'BVOD': 1000000,
          'Premium Reservation VOD': 800000
        };
      } else if (preset === 'digital-first') {
        calcState.channels = {
          'Social Video': 2500000,
          'Social': 2000000,
          'BVOD': 1500000,
          'Programmatic Video': 1200000,
          'Display (Programmatic)': 1000000
        };
      }
      renderCalcChannelInputs();
      updateCalcMetrics();
    }

    function renderCalcChannelInputs() {
      const container = document.getElementById('calcChannelInputs');
      if (!container) return;

      const channels = Object.keys(calcState.channels);
      if (channels.length === 0) {
        container.innerHTML = `
          <div class="text-center py-6 text-slate-400">
            <svg class="w-10 h-10 mx-auto mb-2 opacity-50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            <p class="text-xs">No channels added</p>
            <p class="text-xs mt-1">Click "Add" or use a preset</p>
          </div>`;
        return;
      }

      container.innerHTML = channels.map((channel, i) => {
        const spend = calcState.channels[channel];
        const spendK = (spend / 1000).toFixed(0);
        const color = channelColors[i % channelColors.length];
        return `
          <div class="flex items-center gap-2 p-2 bg-slate-50 rounded-lg border border-slate-200">
            <div class="w-2 h-2 rounded-full flex-shrink-0" style="background: ${color}"></div>
            <div class="flex-1 min-w-0">
              <p class="text-xs font-medium text-slate-700 truncate">${channel}</p>
              <div class="flex items-center gap-1 mt-1">
                <span class="text-xs text-slate-400">$</span>
                <input type="text" value="${spendK}"
                  onchange="updateCalcChannelSpend('${channel}', this.value)"
                  class="w-14 text-xs border border-slate-200 rounded px-1 py-0.5 focus:ring-1 focus:ring-purple-500 focus:outline-none"/>
                <span class="text-xs text-slate-400">K</span>
              </div>
            </div>
            <button onclick="removeCalcChannel('${channel}')" class="p-1 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded">
              <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
          </div>`;
      }).join('');
    }

    function getCalcCPM(channel, demo) {
      const data = cpmData[channel];
      if (!data) return 25;
      return data[demo] || data['P18-54'] || 25;
    }

    function getCalcReach(channel, spend) {
      const curve = reachCurves[channel];
      if (!curve || spend <= 0) return 0;
      const reach = curve.maxReach / (1 + Math.exp(-curve.k * (spend - curve.midpoint)));
      return Math.min(Math.max(reach, 0), curve.maxReach);
    }

    function updateCalcMetrics() {
      const channels = Object.keys(calcState.channels);
      const demo = calcState.demographic;
      const month = calcState.month;
      const seasonality = tvSeasonality[month] || { tarp: 1.0, reach: 1.0 };

      let totalSpend = 0;
      let totalImpressions = 0;
      let totalGRPs = 0;
      const reaches = [];
      const results = [];

      channels.forEach((channel, i) => {
        const spend = calcState.channels[channel];
        totalSpend += spend;

        const baseCPM = getCalcCPM(channel, demo);
        const cpm = channel.includes('TV') ? baseCPM * seasonality.tarp : baseCPM;
        const impressions = (spend / cpm) * 1000;
        totalImpressions += impressions;

        const baseReach = getCalcReach(channel, spend);
        const reach = channel.includes('TV') ? baseReach * seasonality.reach : baseReach;
        reaches.push(reach / 100);

        const frequency = reach > 0 ? Math.min(impressions / (reach * 80000), 15) : 0;
        const grps = reach * frequency;
        totalGRPs += grps;

        results.push({ channel, spend, cpm, impressions, reach, frequency, grps, color: channelColors[i % channelColors.length] });
      });

      // Combined reach with multi-reach adjustment
      let combinedReach = 0;
      if (reaches.length > 0) {
        let product = 1;
        reaches.forEach(r => product *= (1 - r));
        combinedReach = (1 - product) * 100;
        const diminishing = Math.max(0.7, 1 - (reaches.length * 0.03));
        combinedReach = Math.min(combinedReach * diminishing, 95);
      }

      const avgFreq = combinedReach > 0 ? totalGRPs / combinedReach : 0;
      const effectiveReach = combinedReach * Math.min(avgFreq / 3, 1) * 0.85;

      // Update summary metrics
      document.getElementById('calcTotalSpend').textContent = '$' + (totalSpend / 1000000).toFixed(2) + 'M';
      document.getElementById('calcBudgetRemaining').textContent = '$' + ((calcState.totalBudget - totalSpend) / 1000000).toFixed(2) + 'M remaining';
      document.getElementById('calcTotalReach').textContent = combinedReach.toFixed(1) + '%';
      document.getElementById('calcEffectiveReach').textContent = effectiveReach.toFixed(1) + '%';
      document.getElementById('calcAvgFrequency').textContent = avgFreq.toFixed(1) + 'x';
      document.getElementById('calcTotalGRPs').textContent = Math.round(totalGRPs).toLocaleString();
      document.getElementById('calcTotalImpressions').textContent = (totalImpressions / 1000000).toFixed(1) + 'M';

      // Render table
      renderCalcTable(results, totalSpend);
      renderCalcReachCurves(results);
      renderCalcFrequencyChart(avgFreq);
      renderCalcFlightingTable(results);
    }

    function renderCalcTable(results, totalSpend) {
      const tbody = document.getElementById('calcTableBody');
      if (!tbody) return;

      if (results.length === 0) {
        tbody.innerHTML = '<tr><td colspan="8" class="text-center py-8 text-slate-400">Add channels to see performance metrics</td></tr>';
        return;
      }

      tbody.innerHTML = results.map(r => {
        const pct = totalSpend > 0 ? ((r.spend / totalSpend) * 100).toFixed(1) : '0';
        return `
          <tr class="border-b border-slate-100 hover:bg-slate-50">
            <td class="px-2 py-2"><div class="flex items-center gap-1"><div class="w-2 h-2 rounded-full" style="background:${r.color}"></div><span class="truncate">${r.channel}</span></div></td>
            <td class="px-2 py-2 text-right">${pct}%</td>
            <td class="px-2 py-2 text-right font-medium">$${(r.spend/1000).toFixed(0)}K</td>
            <td class="px-2 py-2 text-right">$${r.cpm.toFixed(2)}</td>
            <td class="px-2 py-2 text-right">${(r.impressions/1000000).toFixed(1)}M</td>
            <td class="px-2 py-2 text-right text-purple-600 font-medium">${r.reach.toFixed(1)}%</td>
            <td class="px-2 py-2 text-right">${r.frequency.toFixed(1)}x</td>
            <td class="px-2 py-2 text-right">${Math.round(r.grps)}</td>
          </tr>`;
      }).join('');
    }

    function renderCalcReachCurves(results) {
      const container = document.getElementById('calcReachCurves');
      const legend = document.getElementById('calcReachLegend');
      if (!container) return;

      container.innerHTML = '';
      legend.innerHTML = '';

      results.forEach(r => {
        const curve = reachCurves[r.channel];
        if (!curve) return;

        let path = 'M';
        for (let spend = 0; spend <= 4000000; spend += 100000) {
          const reach = curve.maxReach / (1 + Math.exp(-curve.k * (spend - curve.midpoint)));
          const x = 35 + (spend / 4000000) * 355;
          const y = 110 - (reach / 100) * 100;
          path += (spend === 0 ? '' : 'L') + x + ',' + y;
        }

        container.innerHTML += `<path d="${path}" stroke="${r.color}" stroke-width="2" fill="none" opacity="0.8"/>`;

        const markerX = 35 + (r.spend / 4000000) * 355;
        const markerY = 110 - (r.reach / 100) * 100;
        container.innerHTML += `<circle cx="${markerX}" cy="${markerY}" r="4" fill="${r.color}" stroke="white" stroke-width="1.5"/>`;

        legend.innerHTML += `<div class="flex items-center gap-1"><div class="w-2 h-2 rounded-full" style="background:${r.color}"></div><span class="text-[10px] text-slate-600">${r.channel.split(' ')[0]}</span></div>`;
      });
    }

    function renderCalcFrequencyChart(avgFreq) {
      const container = document.getElementById('calcFrequencyChart');
      if (!container) return;

      const bars = container.querySelectorAll('div');
      const freqDist = [1, 0.85, 0.72, 0.58, 0.45, 0.32, 0.22, 0.12];
      const scale = Math.min(avgFreq / 5, 1.5);

      bars.forEach((bar, i) => {
        const height = Math.min(freqDist[i] * scale * 100, 100);
        bar.style.height = height + '%';
      });
    }

    function renderCalcFlightingTable(results) {
      const container = document.getElementById('calcFlightingTable');
      if (!container || results.length === 0) {
        if (container) container.innerHTML = '<p class="text-center text-slate-400 text-xs py-4">Add channels to see flighting</p>';
        return;
      }

      const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      let html = `<table class="w-full text-xs"><thead><tr class="bg-slate-50"><th class="px-2 py-2 text-left">Channel</th>`;
      months.forEach(m => html += `<th class="px-2 py-1.5 text-center">${m}</th>`);
      html += `<th class="px-2 py-2 text-right font-semibold bg-purple-50">Total</th></tr></thead><tbody>`;

      results.forEach(r => {
        const monthlySpend = r.spend / 12;
        html += `<tr class="border-b border-slate-100"><td class="px-2 py-1.5"><div class="flex items-center gap-1"><div class="w-2 h-2 rounded-full" style="background:${r.color}"></div><span class="truncate">${r.channel}</span></div></td>`;
        months.forEach(() => html += `<td class="px-1 py-1"><input type="text" value="$${(monthlySpend/1000).toFixed(0)}K" class="w-full text-center bg-slate-50 border border-slate-200 rounded px-1 py-0.5 text-[10px]"/></td>`);
        html += `<td class="px-2 py-1.5 text-right font-medium bg-purple-50">$${(r.spend/1000).toFixed(0)}K</td></tr>`;
      });

      const total = results.reduce((s, r) => s + r.spend, 0);
      html += `<tr class="bg-purple-50 font-semibold"><td class="px-2 py-2">Total</td>`;
      months.forEach(() => html += `<td class="px-2 py-1.5 text-center">$${(total/12/1000).toFixed(0)}K</td>`);
      html += `<td class="px-2 py-2 text-right text-purple-700">$${(total/1000).toFixed(0)}K</td></tr></tbody></table>`;

      container.innerHTML = html;
    }

    function calcEvenFlighting() {
      renderCalcFlightingTable(Object.keys(calcState.channels).map((ch, i) => ({
        channel: ch, spend: calcState.channels[ch], color: channelColors[i % channelColors.length]
      })));
    }

    function calcFrontLoad() {
      renderCalcFlightingTable(Object.keys(calcState.channels).map((ch, i) => ({
        channel: ch, spend: calcState.channels[ch], color: channelColors[i % channelColors.length]
      })));
    }

    function calcPulse() {
      renderCalcFlightingTable(Object.keys(calcState.channels).map((ch, i) => ({
        channel: ch, spend: calcState.channels[ch], color: channelColors[i % channelColors.length]
      })));
    }

    // Initialize Step 7 calculator when it becomes visible
    document.addEventListener('DOMContentLoaded', () => {
      setCalcMonth('Apr');
    });

    // ==================== AI BRIEF PARSER ====================
    let uploadedBriefFile = null;
    let extractedBriefData = null;

    function handleBriefUpload(event) {
      const file = event.target.files[0];
      if (!file) return;

      uploadedBriefFile = file;
      document.getElementById('uploadedFileName').textContent = file.name;
      document.getElementById('briefUploadZone').classList.add('hidden');
      document.getElementById('uploadedBriefInfo').classList.remove('hidden');
      document.getElementById('parseBriefBtn').classList.remove('hidden');
    }

    function clearBriefUpload() {
      uploadedBriefFile = null;
      extractedBriefData = null;
      document.getElementById('briefFileInput').value = '';
      document.getElementById('briefUploadZone').classList.remove('hidden');
      document.getElementById('uploadedBriefInfo').classList.add('hidden');
      document.getElementById('parseBriefBtn').classList.add('hidden');
      document.getElementById('aiExtractionResults').classList.add('hidden');
    }

    async function parseBriefWithAI() {
      if (!uploadedBriefFile) return;

      // Show processing state
      document.getElementById('parseBriefBtn').classList.add('hidden');
      document.getElementById('briefParsingState').classList.remove('hidden');

      const progressBar = document.getElementById('parsingProgressBar');
      const statusText = document.getElementById('parsingStatusText');

      // Read file content
      let fileContent = '';
      try {
        if (uploadedBriefFile.type === 'text/plain' || uploadedBriefFile.name.endsWith('.txt')) {
          fileContent = await uploadedBriefFile.text();
        } else if (uploadedBriefFile.type === 'application/pdf' || uploadedBriefFile.name.endsWith('.pdf')) {
          // For PDF, we'd need a PDF parser - for now extract what we can
          fileContent = await extractTextFromFile(uploadedBriefFile);
        } else {
          // For DOCX and other formats
          fileContent = await extractTextFromFile(uploadedBriefFile);
        }
      } catch (e) {
        fileContent = 'Unable to parse file directly. Using filename for context: ' + uploadedBriefFile.name;
      }

      // Simulate AI parsing with progress
      statusText.textContent = 'Reading document...';
      progressBar.style.width = '20%';

      await new Promise(r => setTimeout(r, 500));
      statusText.textContent = 'Extracting campaign details...';
      progressBar.style.width = '40%';

      await new Promise(r => setTimeout(r, 500));
      statusText.textContent = 'Identifying objectives...';
      progressBar.style.width = '60%';

      await new Promise(r => setTimeout(r, 500));
      statusText.textContent = 'Analyzing target audience...';
      progressBar.style.width = '80%';

      // Call AI to extract data (using pattern matching for demo, but this could call a real API)
      extractedBriefData = await extractCampaignDataFromText(fileContent, uploadedBriefFile.name);

      await new Promise(r => setTimeout(r, 300));
      statusText.textContent = 'Complete!';
      progressBar.style.width = '100%';

      await new Promise(r => setTimeout(r, 500));

      // Hide processing, show results
      document.getElementById('briefParsingState').classList.add('hidden');
      displayAIExtractionResults(extractedBriefData);
    }

    async function extractTextFromFile(file) {
      return new Promise((resolve) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          // Try to extract text content
          let content = e.target.result;
          if (typeof content === 'string') {
            resolve(content);
          } else {
            // For binary files, try to decode as text
            const decoder = new TextDecoder('utf-8');
            const text = decoder.decode(new Uint8Array(content));
            resolve(text);
          }
        };
        reader.onerror = () => resolve('');
        if (file.type === 'text/plain' || file.name.endsWith('.txt')) {
          reader.readAsText(file);
        } else {
          reader.readAsArrayBuffer(file);
        }
      });
    }

    async function extractCampaignDataFromText(text, filename) {
      // AI-powered extraction using pattern matching and NLP
      const lowerText = text.toLowerCase();
      const lowerFilename = filename.toLowerCase();

      // Extract campaign name from filename or content
      let campaignName = '';
      const namePatterns = [
        /campaign\s*(?:name)?[:\s]+([^\n,]+)/i,
        /project\s*(?:name)?[:\s]+([^\n,]+)/i,
        /brief[:\s]+([^\n,]+)/i
      ];
      for (const pattern of namePatterns) {
        const match = text.match(pattern);
        if (match) {
          campaignName = match[1].trim();
          break;
        }
      }
      if (!campaignName) {
        campaignName = filename.replace(/\.[^.]+$/, '').replace(/[_-]/g, ' ').replace(/brief|campaign|plan/gi, '').trim();
        campaignName = campaignName.charAt(0).toUpperCase() + campaignName.slice(1);
      }

      // Extract brand/client
      let clientBrand = '';
      const brandPatterns = [
        /(?:client|brand|advertiser)[:\s]+([^\n,]+)/i,
        /for\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)/
      ];
      for (const pattern of brandPatterns) {
        const match = text.match(pattern);
        if (match) {
          clientBrand = match[1].trim();
          break;
        }
      }

      // Detect industry
      let industry = 'other';
      const industryKeywords = {
        'fmcg': ['fmcg', 'consumer goods', 'grocery', 'supermarket', 'food', 'beverage', 'packaged goods'],
        'retail': ['retail', 'store', 'shopping', 'e-commerce', 'ecommerce', 'shop'],
        'auto': ['automotive', 'car', 'vehicle', 'automobile', 'motor', 'driving'],
        'finance': ['finance', 'bank', 'insurance', 'investment', 'loan', 'credit', 'financial'],
        'tech': ['technology', 'tech', 'software', 'app', 'digital', 'saas', 'platform'],
        'health': ['health', 'pharma', 'medical', 'healthcare', 'wellness', 'medicine'],
        'travel': ['travel', 'tourism', 'hotel', 'airline', 'hospitality', 'vacation']
      };
      for (const [ind, keywords] of Object.entries(industryKeywords)) {
        if (keywords.some(k => lowerText.includes(k) || lowerFilename.includes(k))) {
          industry = ind;
          break;
        }
      }

      // Detect objective
      let objective = '';
      const objectiveKeywords = {
        'awareness': ['awareness', 'brand awareness', 'reach', 'visibility', 'top of mind'],
        'consideration': ['consideration', 'engagement', 'interest', 'educate'],
        'conversion': ['conversion', 'sales', 'purchase', 'buy', 'revenue', 'roi'],
        'launch': ['launch', 'new product', 'introduction', 'debut'],
        'retention': ['retention', 'loyalty', 'repeat', 'customer lifetime']
      };
      for (const [obj, keywords] of Object.entries(objectiveKeywords)) {
        if (keywords.some(k => lowerText.includes(k))) {
          objective = obj;
          break;
        }
      }

      // Extract budget
      let budget = '';
      const budgetPatterns = [
        /budget[:\s]*\$?([\d,]+(?:\.\d+)?)\s*(?:m|million)?/i,
        /\$\s*([\d,]+(?:\.\d+)?)\s*(?:m|million)?/i,
        /([\d,]+(?:\.\d+)?)\s*(?:m|million)\s*(?:budget|media)?/i
      ];
      for (const pattern of budgetPatterns) {
        const match = text.match(pattern);
        if (match) {
          let num = parseFloat(match[1].replace(/,/g, ''));
          if (text.toLowerCase().includes('million') || match[0].toLowerCase().includes('m')) {
            num *= 1000000;
          }
          budget = num.toString();
          break;
        }
      }

      // Extract dates
      let startDate = '';
      let endDate = '';
      const datePatterns = [
        /(?:start|begin|launch|from)[:\s]*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/i,
        /(?:start|begin|launch|from)[:\s]*(\w+\s+\d{1,2},?\s*\d{4})/i
      ];
      for (const pattern of datePatterns) {
        const match = text.match(pattern);
        if (match) {
          try {
            const parsed = new Date(match[1]);
            if (!isNaN(parsed)) {
              startDate = parsed.toISOString().split('T')[0];
            }
          } catch (e) {}
          break;
        }
      }

      // Extract duration
      let duration = '';
      const durationPatterns = [
        /(\d+)\s*weeks?/i,
        /(\d+)\s*months?/i,
        /duration[:\s]*(\d+)/i
      ];
      for (const pattern of durationPatterns) {
        const match = text.match(pattern);
        if (match) {
          let weeks = parseInt(match[1]);
          if (match[0].toLowerCase().includes('month')) {
            weeks *= 4;
          }
          duration = weeks.toString();
          break;
        }
      }

      // Suggest audience segments based on content
      const suggestedSegments = [];
      const segmentKeywords = {
        'Family Travellers': ['family', 'families', 'kids', 'children', 'parents'],
        'Tech Enthusiasts': ['tech', 'technology', 'digital', 'innovation', 'gadget'],
        'Business Professionals': ['business', 'professional', 'corporate', 'b2b'],
        'Health Conscious': ['health', 'fitness', 'wellness', 'active'],
        'Luxury Shoppers': ['luxury', 'premium', 'high-end', 'affluent'],
        'Young Adults': ['young', 'millennial', 'gen z', '18-34', '18-24', '25-34'],
        'In-Market Automotive': ['car', 'automotive', 'vehicle', 'buying a car'],
        'Frequent Diners': ['restaurant', 'dining', 'food', 'eating out']
      };
      for (const [segment, keywords] of Object.entries(segmentKeywords)) {
        if (keywords.some(k => lowerText.includes(k))) {
          suggestedSegments.push(segment);
        }
      }

      return {
        campaignName,
        clientBrand,
        industry,
        objective,
        budget,
        startDate,
        endDate,
        duration,
        suggestedSegments,
        rawText: text.substring(0, 500)
      };
    }

    function displayAIExtractionResults(data) {
      // Update the new summary card format
      const summaryContainer = document.getElementById('aiExtractionSummary');
      const industryNames = {
        'fmcg': 'FMCG', 'retail': 'Retail', 'auto': 'Automotive',
        'finance': 'Finance', 'tech': 'Technology', 'health': 'Healthcare',
        'travel': 'Travel', 'other': 'Other'
      };
      const objectiveNames = {
        'awareness': 'Awareness', 'consideration': 'Consideration',
        'conversion': 'Conversion', 'retention': 'Retention', 'launch': 'Launch'
      };

      let cardsHtml = '';

      // Campaign Name Card
      if (data.campaignName) {
        cardsHtml += `<div class="bg-white/20 rounded-xl p-3">
          <p class="text-[10px] text-purple-200 uppercase tracking-wide">Campaign</p>
          <p class="text-sm font-semibold truncate mt-0.5">${data.campaignName}</p>
        </div>`;
      }

      // Client/Brand Card
      if (data.clientBrand) {
        cardsHtml += `<div class="bg-white/20 rounded-xl p-3">
          <p class="text-[10px] text-purple-200 uppercase tracking-wide">Brand</p>
          <p class="text-sm font-semibold truncate mt-0.5">${data.clientBrand}</p>
        </div>`;
      }

      // Industry Card
      if (data.industry && data.industry !== 'other') {
        cardsHtml += `<div class="bg-white/20 rounded-xl p-3">
          <p class="text-[10px] text-purple-200 uppercase tracking-wide">Industry</p>
          <p class="text-sm font-semibold mt-0.5">${industryNames[data.industry] || data.industry}</p>
        </div>`;
      }

      // Objective Card
      if (data.objective) {
        cardsHtml += `<div class="bg-white/20 rounded-xl p-3">
          <p class="text-[10px] text-purple-200 uppercase tracking-wide">Objective</p>
          <p class="text-sm font-semibold mt-0.5">${objectiveNames[data.objective] || data.objective}</p>
        </div>`;
      }

      // Budget Card
      if (data.budget) {
        const budgetNum = parseFloat(data.budget);
        const formattedBudget = budgetNum >= 1000000 ? `$${(budgetNum/1000000).toFixed(1)}M` : `$${budgetNum.toLocaleString()}`;
        cardsHtml += `<div class="bg-white/20 rounded-xl p-3">
          <p class="text-[10px] text-purple-200 uppercase tracking-wide">Budget</p>
          <p class="text-sm font-semibold mt-0.5">${formattedBudget}</p>
        </div>`;
      }

      // Duration Card
      if (data.duration) {
        cardsHtml += `<div class="bg-white/20 rounded-xl p-3">
          <p class="text-[10px] text-purple-200 uppercase tracking-wide">Duration</p>
          <p class="text-sm font-semibold mt-0.5">${data.duration} weeks</p>
        </div>`;
      }

      // Start Date Card
      if (data.startDate) {
        cardsHtml += `<div class="bg-white/20 rounded-xl p-3">
          <p class="text-[10px] text-purple-200 uppercase tracking-wide">Start</p>
          <p class="text-sm font-semibold mt-0.5">${data.startDate}</p>
        </div>`;
      }

      // Fields Extracted Card
      const fieldsExtracted = [data.campaignName, data.clientBrand, data.industry !== 'other' ? data.industry : null, data.objective, data.budget, data.duration].filter(Boolean).length;
      cardsHtml += `<div class="bg-green-500/30 rounded-xl p-3">
        <p class="text-[10px] text-green-200 uppercase tracking-wide">Extracted</p>
        <p class="text-sm font-semibold mt-0.5">${fieldsExtracted} fields</p>
      </div>`;

      if (cardsHtml) {
        summaryContainer.innerHTML = cardsHtml;
        document.getElementById('applyAllBtn').classList.remove('hidden');
      } else {
        summaryContainer.innerHTML = `<div class="col-span-4 text-center py-4 text-purple-200">
          <p class="text-sm">No data could be extracted. Please fill in manually.</p>
        </div>`;
      }

      // Show suggested segments
      if (data.suggestedSegments && data.suggestedSegments.length > 0) {
        const segmentsSection = document.getElementById('aiSuggestedSegmentsSection');
        const segmentsTags = document.getElementById('aiSuggestedSegmentsTags');
        segmentsTags.innerHTML = data.suggestedSegments.map(s =>
          `<span class="px-2 py-1 bg-white/20 text-white text-xs rounded-lg">${s}</span>`
        ).join('');
        segmentsSection.classList.remove('hidden');
      }
    }

    function applyAIExtraction() {
      if (!extractedBriefData) return;

      if (extractedBriefData.campaignName) {
        document.getElementById('campaignName').value = extractedBriefData.campaignName;
        updatePlanState('campaignName', extractedBriefData.campaignName);
      }
      if (extractedBriefData.clientBrand) {
        document.getElementById('clientBrand').value = extractedBriefData.clientBrand;
        updatePlanState('clientBrand', extractedBriefData.clientBrand);
      }
      if (extractedBriefData.industry && extractedBriefData.industry !== 'other') {
        selectIndustry(extractedBriefData.industry);
      }
      if (extractedBriefData.objective) {
        document.getElementById('campaignObjective').value = extractedBriefData.objective;
        updatePlanState('objective', extractedBriefData.objective);
      }
      if (extractedBriefData.budget) {
        document.getElementById('totalBudget').value = parseFloat(extractedBriefData.budget).toLocaleString();
        updatePlanState('budget', extractedBriefData.budget);
      }
      if (extractedBriefData.duration) {
        document.getElementById('campaignDuration').value = extractedBriefData.duration;
        updatePlanState('duration', extractedBriefData.duration);
      }
      if (extractedBriefData.startDate) {
        document.getElementById('startDate').value = extractedBriefData.startDate;
        updatePlanState('startDate', extractedBriefData.startDate);
        calculateEndDate();
      }

      // Store suggested segments for Step 2
      if (extractedBriefData.suggestedSegments) {
        planState.aiSuggestedSegments = extractedBriefData.suggestedSegments;
      }

      showToast('AI extracted data applied!', 'success');
    }

    function calculateEndDate() {
      const startDate = document.getElementById('startDate').value;
      const duration = document.getElementById('campaignDuration').value;

      if (startDate && duration) {
        const start = new Date(startDate);
        const weeks = parseInt(duration);
        const end = new Date(start.getTime() + weeks * 7 * 24 * 60 * 60 * 1000);
        document.getElementById('endDate').value = end.toISOString().split('T')[0];
        updatePlanState('endDate', end.toISOString().split('T')[0]);
      }
    }

    // ==================== ASSET SELECTION & MAP ====================
    function setAssetView(view) {
      document.querySelectorAll('.asset-view-btn').forEach(btn => {
        btn.classList.remove('bg-purple-100', 'text-purple-700');
        btn.classList.add('bg-slate-100', 'text-slate-600');
      });
      const activeBtn = document.querySelector(`.asset-view-btn[data-view="${view}"]`);
      if (activeBtn) {
        activeBtn.classList.add('bg-purple-100', 'text-purple-700');
        activeBtn.classList.remove('bg-slate-100', 'text-slate-600');
      }
    }

    function toggleAssetSelection(element) {
      const checkbox = element.querySelector('input[type="checkbox"]');
      const isSelected = checkbox.checked;
      checkbox.checked = !isSelected;

      if (!isSelected) {
        element.classList.add('bg-purple-50');
        element.dataset.selected = 'true';
      } else {
        element.classList.remove('bg-purple-50');
        element.dataset.selected = 'false';
      }
      updateSelectedAssetsCount();
    }

    function updateSelectedAssetsCount() {
      const selectedCount = document.querySelectorAll('.asset-item[data-selected="true"]').length;
      document.getElementById('selectedAssetsCount').textContent = selectedCount;
      document.getElementById('thingsToSubmitCount').textContent = selectedCount + 1;
    }

    function clearAssetSelection() {
      document.querySelectorAll('.asset-item').forEach(item => {
        item.classList.remove('bg-purple-50');
        item.dataset.selected = 'false';
        item.querySelector('input[type="checkbox"]').checked = false;
      });
      updateSelectedAssetsCount();
    }

    function selectAllAssets() {
      document.querySelectorAll('.asset-item').forEach(item => {
        item.classList.add('bg-purple-50');
        item.dataset.selected = 'true';
        item.querySelector('input[type="checkbox"]').checked = true;
      });
      updateSelectedAssetsCount();
    }

    function showAssetTab(tab) {
      document.querySelectorAll('.asset-tab').forEach(t => {
        t.classList.remove('text-purple-600', 'border-purple-600');
        t.classList.add('text-slate-400', 'border-transparent');
      });
      const activeTab = document.querySelector(`.asset-tab[data-tab="${tab}"]`);
      if (activeTab) {
        activeTab.classList.add('text-purple-600', 'border-purple-600');
        activeTab.classList.remove('text-slate-400', 'border-transparent');
      }
    }

    function toggleAssetFilter() {
      showToast('Filter options coming soon');
    }

    function toggleAssetSort() {
      showToast('Sort options coming soon');
    }

    function toggleHeatmapDisplay() {
      const checkbox = document.getElementById('displayHeatmap');
      const regions = document.querySelectorAll('.state-region');
      regions.forEach(region => {
        region.style.opacity = checkbox.checked ? '1' : '0.3';
      });
    }

    function selectMapRegion(region) {
      const regionEl = document.getElementById(`${region}-region`);
      if (regionEl) {
        const currentFill = regionEl.getAttribute('fill');
        const isSelected = regionEl.classList.contains('region-selected');

        if (isSelected) {
          regionEl.classList.remove('region-selected');
          regionEl.style.strokeWidth = '1';
          regionEl.style.stroke = '#c9a050';
        } else {
          regionEl.classList.add('region-selected');
          regionEl.style.strokeWidth = '3';
          regionEl.style.stroke = '#591C63';
        }
      }
      showToast(`${region.toUpperCase()} region ${regionEl.classList.contains('region-selected') ? 'selected' : 'deselected'}`);
    }

    function focusOnCity(city) {
      showToast(`Zooming to ${city.charAt(0).toUpperCase() + city.slice(1)}`);
    }

    function zoomMap(direction) {
      const mapContainer = document.getElementById('australiaMapContainer');
      const svg = document.getElementById('australiaSvgMap');
      const currentViewBox = svg.getAttribute('viewBox').split(' ').map(Number);

      if (direction === 'in') {
        const newViewBox = [
          currentViewBox[0] + 50,
          currentViewBox[1] + 50,
          currentViewBox[2] - 100,
          currentViewBox[3] - 100
        ];
        if (newViewBox[2] > 200) {
          svg.setAttribute('viewBox', newViewBox.join(' '));
        }
      } else {
        const newViewBox = [
          Math.max(0, currentViewBox[0] - 50),
          Math.max(0, currentViewBox[1] - 50),
          currentViewBox[2] + 100,
          currentViewBox[3] + 100
        ];
        svg.setAttribute('viewBox', newViewBox.join(' '));
      }
    }

    function toggleMapMode(mode) {
      showToast(`Map mode: ${mode}`);
    }

    function toggleMapDraw() {
      showToast('Draw mode activated');
    }

    function toggleMapSettings() {
      showToast('Map settings');
    }

    // ==================== ADVANCED AUDIENCE BUILDER ====================
    function showAudienceTab(tabName) {
      document.querySelectorAll('.audience-cat-tab').forEach(tab => {
        tab.classList.remove('text-purple-600', 'border-purple-600');
        tab.classList.add('text-slate-400', 'border-transparent');
      });
      const activeTab = document.querySelector(`.audience-cat-tab[data-audience-cat="${tabName}"]`);
      if (activeTab) {
        activeTab.classList.add('text-purple-600', 'border-purple-600');
        activeTab.classList.remove('text-slate-400', 'border-transparent');
      }
      document.querySelectorAll('.audience-cat-content').forEach(c => c.classList.add('hidden'));
      const activeContent = document.querySelector(`.audience-cat-content[data-audience-cat-content="${tabName}"]`);
      if (activeContent) activeContent.classList.remove('hidden');
    }

    function setAudienceBaseline(baseline) {
      document.querySelectorAll('.audience-baseline-btn').forEach(btn => {
        btn.classList.remove('bg-purple-100', 'border-purple-400', 'text-purple-700');
      });
      event.target.closest('.audience-baseline-btn').classList.add('bg-purple-100', 'border-purple-400', 'text-purple-700');
      planState.audienceBaseline = baseline;
    }

    function searchAudienceSegments(query) {
      // Filter segments based on search query
      if (!query || query.length < 2) return;
      // This would filter the visible segments in a real implementation
    }

    function selectAudienceCategory(category) {
      document.querySelectorAll('.audience-main-cat').forEach(btn => {
        btn.classList.remove('border-purple-400', 'bg-purple-50', 'text-purple-700');
        btn.classList.add('border-transparent');
      });
      const selectedBtn = document.querySelector(`.audience-main-cat[data-cat="${category}"]`);
      if (selectedBtn) {
        selectedBtn.classList.add('border-purple-400', 'bg-purple-50', 'text-purple-700');
        selectedBtn.classList.remove('border-transparent');
      }
      // Update sub-category title
      const titles = {
        'demographics': 'Advanced Demographics',
        'purchase': 'Purchase Behaviour (Mastercard)',
        'lifestyle': 'Lifestyle',
        'interests': 'Online Interests',
        'placevisitors': 'Place Visitors',
        'brandvisitor': 'Brand Visitor',
        'household': 'Household Consumption'
      };
      document.getElementById('subCategoryTitle').textContent = titles[category] || category;
    }

    function selectSubCategory(subCategory) {
      document.querySelectorAll('.audience-sub-cat').forEach(btn => {
        btn.classList.remove('border-purple-400', 'bg-purple-50', 'text-purple-700');
        btn.classList.add('border-transparent');
      });
      const selectedBtn = document.querySelector(`.audience-sub-cat[data-subcat="${subCategory}"]`);
      if (selectedBtn) {
        selectedBtn.classList.add('border-purple-400', 'bg-purple-50', 'text-purple-700');
        selectedBtn.classList.remove('border-transparent');
      }
      document.getElementById('segmentTitle').textContent = subCategory.charAt(0).toUpperCase() + subCategory.slice(1);
    }

    function toggleAudienceSegment(checkbox) {
      const segmentItem = checkbox.closest('.segment-item');
      if (checkbox.checked) {
        segmentItem.classList.add('border-purple-400', 'bg-purple-50');
        segmentItem.classList.remove('border-slate-200');
      } else {
        segmentItem.classList.remove('border-purple-400', 'bg-purple-50');
        segmentItem.classList.add('border-slate-200');
      }
      updateAudienceSize();
    }

    function removeSegmentTag(tagId) {
      // Remove the tag and update calculations
      const tagElement = event.target.closest('span');
      if (tagElement) tagElement.remove();
      updateAudienceSize();
    }

    function saveAndContinueAudience() {
      // Save audience selections and continue to step 3
      showToast('Audience saved successfully!', 'success');
      goToStep(3);
    }

    // ==================== PLAN STATE MANAGEMENT ====================
    // Plan state to carry data between steps
    let planState = {
      campaignName: '',
      clientBrand: '',
      industry: '',
      objective: '',
      budget: 0,
      duration: 0,
      startDate: '',
      notes: '',
      primaryDemo: 'P18-54',
      secondaryDemo: '',
      segments: [],
      audienceSize: 0,
      dataSource: 'uploaded',
      selectedDataset: 'q4-2025',
      markets: [],
      channels: [],
      totalMarketAudience: 0
    };

    // Update plan state from form inputs
    function updatePlanState(field, value) {
      if (field === 'budget') {
        planState.budget = parseFloat(value.replace(/[^0-9.]/g, '')) || 0;
        calcState.totalBudget = planState.budget;
      } else if (field === 'duration') {
        planState.duration = parseInt(value) || 0;
      } else {
        planState[field] = value;
      }
      updatePlanSummary();
    }

    // Update plan summary in Step 5
    function updatePlanSummary() {
      const campaignEl = document.getElementById('planSummaryCampaign');
      const audienceEl = document.getElementById('planSummaryAudience');
      const marketsEl = document.getElementById('planSummaryMarkets');

      if (campaignEl) campaignEl.textContent = planState.campaignName || '-';
      if (audienceEl) audienceEl.textContent = planState.primaryDemo || '-';
      if (marketsEl) {
        const marketCount = planState.markets.length;
        marketsEl.textContent = marketCount === 8 ? 'National' : marketCount > 0 ? `${marketCount} states` : '-';
      }
    }

    // ==================== STEP 1: INDUSTRY SELECTION ====================
    function selectIndustry(industry) {
      // Remove previous selection
      document.querySelectorAll('.industry-btn').forEach(btn => {
        btn.classList.remove('border-purple-600', 'bg-purple-100');
        btn.classList.add('border-slate-200');
      });

      // Add selection to clicked button
      const selectedBtn = document.querySelector(`.industry-btn[data-industry="${industry}"]`);
      if (selectedBtn) {
        selectedBtn.classList.remove('border-slate-200');
        selectedBtn.classList.add('border-purple-600', 'bg-purple-100');
      }

      planState.industry = industry;

      // Show toast
      const industryNames = {
        'fmcg': 'FMCG', 'retail': 'Retail', 'auto': 'Automotive',
        'finance': 'Finance', 'tech': 'Technology', 'health': 'Healthcare',
        'travel': 'Travel', 'other': 'Other'
      };
      showToast(`Industry set to ${industryNames[industry] || industry}`);
    }

    // ==================== STEP 2: AUDIENCE SIZE CALCULATION ====================
    // Base population data for Australia demographics
    const demographicPopulation = {
      'P18-54': 12400000,
      'P25-54': 10200000,
      'P18-39': 8800000,
      'P18+': 20100000,
      'W18-54': 6200000,
      'W25-54': 5100000,
      'M18-54': 6200000,
      'M25-54': 5100000
    };

    // Segment multipliers (affinity indices)
    const segmentMultipliers = {
      'mainstream': 1.0,
      'aspirers': 0.85,
      'explorers': 0.78,
      'succeders': 0.72,
      'reformers': 0.68,
      'strugglers': 0.82,
      'resigned': 0.75,
      'custom': 0.90
    };

    function updateAudienceSize() {
      const primaryDemo = document.getElementById('primaryDemo').value;
      const secondaryDemo = document.getElementById('secondaryDemo').value;

      // Get selected segments
      const segments = [];
      document.querySelectorAll('.segment-checkbox:checked').forEach(cb => {
        segments.push(cb.value);
      });

      planState.primaryDemo = primaryDemo;
      planState.secondaryDemo = secondaryDemo;
      planState.segments = segments;

      // Calculate base universe from primary demo
      let universe = demographicPopulation[primaryDemo] || 12400000;

      // Apply secondary demo filter (reduces universe)
      if (secondaryDemo && secondaryDemo !== '') {
        universe *= 0.65; // Overlap factor
      }

      // Apply segment filters
      let segmentFactor = 1.0;
      if (segments.length > 0) {
        segmentFactor = segments.reduce((acc, seg) => acc * segmentMultipliers[seg], 1.0);
        segmentFactor = Math.max(segmentFactor, 0.3); // Minimum 30%
      }

      const reachableAudience = Math.round(universe * segmentFactor * 0.82);
      const affinity = 1 + (segments.length * 0.15);
      const targetIndex = Math.round(100 + (segments.length * 12));

      // Update display
      document.getElementById('estAudienceSize').textContent = formatNumber(reachableAudience);
      document.getElementById('audienceUniverse').textContent = formatNumberShort(universe);
      document.getElementById('audienceReachable').textContent = formatNumberShort(reachableAudience);
      document.getElementById('audienceAffinity').textContent = affinity.toFixed(1) + 'x';
      document.getElementById('audienceIndex').textContent = targetIndex;

      planState.audienceSize = reachableAudience;
    }

    function formatNumber(num) {
      if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
      if (num >= 1000) return (num / 1000).toFixed(0) + 'K';
      return num.toString();
    }

    function formatNumberShort(num) {
      if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
      if (num >= 1000) return (num / 1000).toFixed(0) + 'K';
      return num.toString();
    }

    // ==================== STEP 3: DATA SOURCE SELECTION ====================
    function selectDataSource(source) {
      planState.dataSource = source;

      // Update UI
      document.querySelectorAll('.data-source-card').forEach(card => {
        card.classList.remove('border-purple-400', 'bg-purple-50');
        card.classList.add('border-slate-200');
        // Remove checkmark if exists
        const checkmark = card.querySelector('.data-source-check');
        if (checkmark) checkmark.remove();
      });

      // Find and style the selected card
      const cards = document.querySelectorAll('.data-source-card');
      const selectedCard = source === 'uploaded' ? cards[0] : cards[1];
      if (selectedCard) {
        selectedCard.classList.remove('border-slate-200');
        selectedCard.classList.add('border-purple-400', 'bg-purple-50');

        // Add checkmark
        const checkDiv = document.createElement('div');
        checkDiv.className = 'data-source-check w-5 h-5 bg-purple-600 rounded-full flex items-center justify-center absolute top-4 right-4';
        checkDiv.innerHTML = '<svg class="w-3 h-3 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>';
        selectedCard.style.position = 'relative';
        selectedCard.appendChild(checkDiv);
      }

      // Toggle visibility of sections
      const uploadedSection = document.getElementById('uploadedDatasets');
      const datalabSection = document.getElementById('datalabRequest');

      if (source === 'uploaded') {
        uploadedSection.classList.remove('hidden');
        datalabSection.classList.add('hidden');
      } else {
        uploadedSection.classList.add('hidden');
        datalabSection.classList.remove('hidden');
      }
    }

    // ==================== STEP 4: MARKET & REGION SELECTION ====================
    // Australian state population data
    const statePopulations = {
      'nsw': 8200000,
      'vic': 6700000,
      'qld': 5300000,
      'wa': 2800000,
      'sa': 1800000,
      'tas': 600000,
      'act': 500000,
      'nt': 250000
    };

    function updateMarketSelection() {
      const selectedRegions = [];
      let totalPopulation = 0;

      document.querySelectorAll('.region-checkbox:checked').forEach(cb => {
        const region = cb.value;
        selectedRegions.push(region);
        totalPopulation += statePopulations[region] || 0;
      });

      planState.markets = selectedRegions;
      planState.totalMarketAudience = totalPopulation;

      // Update display
      document.getElementById('selectedMarketsCount').textContent = selectedRegions.length;
      document.getElementById('marketAudienceSize').textContent = formatNumberShort(totalPopulation);

      // Update region button styles
      document.querySelectorAll('.region-btn').forEach(btn => {
        const checkbox = btn.querySelector('.region-checkbox');
        if (checkbox && checkbox.checked) {
          btn.classList.add('border-purple-400', 'bg-purple-50');
          btn.classList.remove('border-slate-200');
        } else {
          btn.classList.remove('border-purple-400', 'bg-purple-50');
          btn.classList.add('border-slate-200');
        }
      });

      // Update channel audience estimates based on market selection
      updateChannelAudienceEstimates(totalPopulation);
    }

    function selectAllRegions() {
      const allSelected = document.querySelectorAll('.region-checkbox:checked').length === 8;

      document.querySelectorAll('.region-checkbox').forEach(cb => {
        cb.checked = !allSelected;
      });

      updateMarketSelection();
      showToast(allSelected ? 'All regions deselected' : 'National coverage selected');
    }

    function searchPostcode(query) {
      if (query.length < 3) return;

      // Simple postcode to state mapping for demo
      const postcodeStates = {
        '2': 'nsw', '3': 'vic', '4': 'qld', '5': 'sa',
        '6': 'wa', '7': 'tas', '0': 'nt', '26': 'act', '29': 'act'
      };

      const firstDigit = query.charAt(0);
      const firstTwo = query.substring(0, 2);

      let state = postcodeStates[firstTwo] || postcodeStates[firstDigit];

      if (state) {
        const checkbox = document.querySelector(`.region-checkbox[value="${state}"]`);
        if (checkbox && !checkbox.checked) {
          checkbox.checked = true;
          updateMarketSelection();
          showToast(`${state.toUpperCase()} added from postcode ${query}`);
        }
      }
    }

    function clearMapSelection() {
      document.querySelectorAll('.region-checkbox').forEach(cb => {
        cb.checked = false;
      });
      document.getElementById('postcodeSearch').value = '';
      updateMarketSelection();
      showToast('Map selection cleared');
    }

    // ==================== STEP 4: CHANNEL SELECTION ====================
    const channelBaseAudience = {
      'tv': 0.92,      // 92% of population has TV access
      'bvod': 0.68,    // 68% use BVOD services
      'ooh': 0.85,     // 85% pass OOH panels
      'radio': 0.62,   // 62% listen to radio
      'digital': 0.88, // 88% use internet
      'social': 0.78,  // 78% use social media
      'audio': 0.45    // 45% use audio streaming
    };

    function updateChannelSelection() {
      const selectedChannels = [];

      document.querySelectorAll('.channel-checkbox:checked').forEach(cb => {
        selectedChannels.push(cb.value);
      });

      planState.channels = selectedChannels;

      // Update channel item styles
      document.querySelectorAll('.channel-item').forEach(item => {
        const checkbox = item.querySelector('.channel-checkbox');
        if (checkbox && checkbox.checked) {
          item.classList.add('border-purple-400', 'bg-purple-50');
          item.classList.remove('border-slate-200');
        } else {
          item.classList.remove('border-purple-400', 'bg-purple-50');
          item.classList.add('border-slate-200');
        }
      });
    }

    function updateChannelAudienceEstimates(totalPopulation) {
      // Update audience estimates for each channel based on selected markets
      Object.keys(channelBaseAudience).forEach(channel => {
        const audienceEl = document.getElementById(`${channel}Audience`);
        if (audienceEl && totalPopulation > 0) {
          const channelAudience = Math.round(totalPopulation * channelBaseAudience[channel]);
          audienceEl.textContent = formatNumberShort(channelAudience);
        }
      });
    }

    // ==================== COMPLETE PLAN & DASHBOARD UPDATE ====================
    function completePlanCreation() {
      // Sync plan state to calculator
      calcState.totalBudget = planState.budget || 12000000;
      calcState.demographic = planState.primaryDemo;

      // Update Step 5 summary with plan data
      updatePlanSummary();

      // Store plan for dashboard
      savePlanToDashboard();

      // Navigate to plan detail view
      showScreen('plan-detail');
      showPlanTab('dashboard');

      // Show success toast
      showToast('Plan created successfully!', 'success');
    }

    function savePlanToDashboard() {
      // Update dashboard cards with plan data
      const dashboardCards = document.querySelectorAll('.plan-content[data-plan-content="dashboard"]');

      // This would typically save to a backend, for now update the UI
      console.log('Plan saved:', planState);
    }

    // ==================== UTILITY FUNCTIONS ====================
    function showToast(message, type = 'info') {
      const colors = {
        'success': 'bg-green-600',
        'info': 'bg-purple-600',
        'warning': 'bg-amber-600',
        'error': 'bg-red-600'
      };

      const toast = document.createElement('div');
      toast.className = `fixed bottom-6 right-6 ${colors[type]} text-white px-4 py-3 rounded-xl shadow-lg flex items-center gap-2 text-sm z-50`;
      toast.innerHTML = `<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>${message}`;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    // Initialize Google Maps placeholder (would need actual API key)
    function initMap() {
      const mapContainer = document.getElementById('marketMap');
      if (!mapContainer) return;

      // For now, show an Australia map SVG placeholder
      mapContainer.innerHTML = `
        <div class="absolute inset-0 flex items-center justify-center bg-gradient-to-br from-blue-50 to-cyan-50">
          <svg viewBox="0 0 500 400" class="w-full h-full p-4" style="max-width: 400px;">
            <!-- Simplified Australia map outline -->
            <g fill="none" stroke="#94a3b8" stroke-width="2">
              <!-- WA -->
              <path id="map-wa" d="M50,120 L120,80 L140,180 L120,280 L50,320 L30,220 Z"
                    class="cursor-pointer hover:fill-purple-200 transition-colors"
                    onclick="toggleRegionFromMap('wa')"/>
              <!-- NT -->
              <path id="map-nt" d="M140,80 L200,60 L220,150 L140,180 Z"
                    class="cursor-pointer hover:fill-purple-200 transition-colors"
                    onclick="toggleRegionFromMap('nt')"/>
              <!-- SA -->
              <path id="map-sa" d="M140,180 L220,150 L240,220 L220,300 L140,280 Z"
                    class="cursor-pointer hover:fill-purple-200 transition-colors"
                    onclick="toggleRegionFromMap('sa')"/>
              <!-- QLD -->
              <path id="map-qld" d="M220,60 L320,50 L340,180 L240,220 L220,150 Z"
                    class="cursor-pointer hover:fill-purple-200 transition-colors"
                    onclick="toggleRegionFromMap('qld')"/>
              <!-- NSW -->
              <path id="map-nsw" d="M240,220 L340,180 L360,260 L320,300 L240,280 Z"
                    class="cursor-pointer hover:fill-purple-200 transition-colors"
                    onclick="toggleRegionFromMap('nsw')"/>
              <!-- VIC -->
              <path id="map-vic" d="M220,300 L320,300 L340,340 L260,360 L220,340 Z"
                    class="cursor-pointer hover:fill-purple-200 transition-colors"
                    onclick="toggleRegionFromMap('vic')"/>
              <!-- TAS -->
              <path id="map-tas" d="M280,370 L320,365 L330,395 L290,400 Z"
                    class="cursor-pointer hover:fill-purple-200 transition-colors"
                    onclick="toggleRegionFromMap('tas')"/>
              <!-- ACT (small dot) -->
              <circle id="map-act" cx="310" cy="275" r="8"
                    class="cursor-pointer hover:fill-purple-200 transition-colors"
                    onclick="toggleRegionFromMap('act')"/>
            </g>
            <!-- State labels -->
            <text x="75" y="200" class="text-[10px] fill-slate-500 pointer-events-none">WA</text>
            <text x="165" y="130" class="text-[10px] fill-slate-500 pointer-events-none">NT</text>
            <text x="175" y="240" class="text-[10px] fill-slate-500 pointer-events-none">SA</text>
            <text x="270" y="130" class="text-[10px] fill-slate-500 pointer-events-none">QLD</text>
            <text x="290" y="250" class="text-[10px] fill-slate-500 pointer-events-none">NSW</text>
            <text x="270" y="330" class="text-[10px] fill-slate-500 pointer-events-none">VIC</text>
            <text x="295" y="390" class="text-[8px] fill-slate-500 pointer-events-none">TAS</text>
          </svg>
        </div>
      `;
    }

    function toggleRegionFromMap(region) {
      const checkbox = document.querySelector(`.region-checkbox[value="${region}"]`);
      if (checkbox) {
        checkbox.checked = !checkbox.checked;
        updateMarketSelection();

        // Update map SVG fill
        updateMapHighlights();
      }
    }

    function updateMapHighlights() {
      document.querySelectorAll('.region-checkbox').forEach(cb => {
        const region = cb.value;
        const mapPath = document.getElementById(`map-${region}`);
        if (mapPath) {
          if (cb.checked) {
            mapPath.setAttribute('fill', '#c4b5fd'); // purple-300
            mapPath.setAttribute('stroke', '#7c3aed'); // purple-600
          } else {
            mapPath.setAttribute('fill', 'none');
            mapPath.setAttribute('stroke', '#94a3b8');
          }
        }
      });
    }

    // Initialize map when Step 4 becomes visible
    const originalGoToStep = goToStep;
    goToStep = function(step) {
      originalGoToStep(step);
      if (step === 4) {
        setTimeout(initMap, 100);
      }
      if (step === 5) {
        updatePlanSummary();
        // Pre-populate calculator if budget is set
        if (planState.budget > 0) {
          calcState.totalBudget = planState.budget;
        }
      }
    };

    // Initialize audience on page load
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        updateAudienceSize();
        updateChannelSelection();
      }, 200);
    });
  </script>
</body>
</html>
